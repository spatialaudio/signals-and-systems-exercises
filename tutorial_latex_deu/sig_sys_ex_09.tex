\clearpage
\section{UE 9: z-Transformation}
%
Die $z$-Transformation bildet zeitdiskrete Signale, also Folgen, $x[k]$
($x\in\mathbb{C}$, $k\in\mathbb{Z}$)
auf Funktionen $X(z)$ ($X\in\mathbb{C}$, $z\in\mathbb{C}$)
ab.
%
Wir arbeiten im sogenannten Bildbereich also in der komplexwertigen $z$-Ebene mit
komplexwertigen Funktionen $X(z)$.
%
In speziellen, aber in SigSys oft benutzen, Fällen ist $x\in\mathbb{R}$, besteht
also aus reellen Folgengliedern bzw. Samples.
%
Wie mittlerweile etabliert, versuchen wir hier auch so viel wie möglich mit
vergleichsweise einfachen Rechnungen und viel Anschauung zugänglich zu machen,
um das Wesen zu erfassen.
%


\subsection*{Transformationspaar}
Die Hintransformation lautet
\begin{align}
X(z) = \sum_{k=-\infty}^{\infty} x[k] \, z^{-k},
\end{align}
die Rücktransformation lautet
\begin{align}
x[k] = \frac{1}{2\pi \im} \oint\limits_{C \subset \text{KB}} X(z) \, z^{k-1} \, \fsd z.
\end{align}
%
Die Rücktransformation ist im Grunde die Anwendung des Cauchy
Integralsatzes, wie sich mit untenstehender Rechnung zeigen lässt, vgl.
\cite[S.\,152]{Wunsch1972}, \cite[S.\,180ff]{Wunsch2006a}
\begin{align}
\text{Ansatz mit Hilfsvariable k':   } X(z) =& \sum_{k'=-\infty}^{\infty} x[k'] \, z^{-k'}\\
\text{Erweitern:   } z^{k-1} X(z) =& z^{k-1} \sum_{k'=-\infty}^{\infty} x[k'] \, z^{-k'}\\
\text{Term kann in die Summe:   } X(z) z^{k-1} =& \sum_{k'=-\infty}^{\infty} \frac{x[k']}{z^{k'}} z^{k-1}\\
\text{Exponenten zusammen (Achtung k vs k'):    } X(z) z^{k-1} =& \sum_{k'=-\infty}^{\infty} \frac{x[k']}{z^{k'-k+1}}\\
\text{Ringintegral im KB:   } \oint\limits_{C \subset \text{KB}} X(z) z^{k-1} \fsd z =&
\oint\limits_{C \subset \text{KB}}
\sum_{k'=-\infty}^{\infty} \frac{x[k']}{z^{k'-k+1}} \fsd z\\
\text{Summe / Integral tauschen:   }
\oint\limits_{C \subset \text{KB}} \frac{X(z)}{z^{-k+1}} \fsd z =&
\sum_{k'=-\infty}^{\infty}
\oint\limits_{C \subset \text{KB}}
\frac{x[k']}{z^{k'-k+1}} \fsd z
\end{align}
Gemäß Cauchy Integraltheorie, vgl.~\cite[Kap.\,5]{Strang2007,Strang2010}, \cite[Kap.\,2]{Burg2013b},
ergibt sich für das Ringintegral auf der rechten Seite in der letzten Formel
\begin{itemize}
  \item für $k' \neq k$ das Ergebnis Null
  \item für $k' = k$ das Ergebnis $2\pi \im \cdot x[k]$
\end{itemize}
Die Summe über alle $k'$ liefert also die oben schon eingeführte Rücktransformationsformel
\begin{align}
\frac{1}{2\pi \im} \oint\limits_{C \subset \text{KB}} \frac{X(z)}{z^{-k+1}} \, \fsd z
= x[k].
\end{align}
%
Die $z$-Transformation ist daher keine Erfindung der SigSys, sondern in der
Mathematik, speziell komplexer Funktionsanalysis, wohlbekannt als spezielle
Form der Laurent Reihe~\cite[S.\,56ff]{Wunsch1972}
\begin{align}
f(z) = \sum_{k=-\infty}^{\infty} c_k (z - z_0)^k
\end{align}
mit $f\in\mathbb{C}$, $c\in\mathbb{C}$, $z\in\mathbb{C}$, $z_0\in\mathbb{C}$, $k\in\mathbb{Z}$
und der analytischen Darstellung der komplexen Reihenkoeffizienten $c_k$
\begin{align}
c_k = \frac{1}{2\pi\im}\oint\limits_{C \subset \text{KB}}
\frac{f(z)}{(z-z_0)^{k+1}}\fsd z.
\end{align}
%
In SigSys benutzen wir $z_0=0$, also die Entwicklung der Reihe um den
Koordinatenursprung.
%
Weiterhin schreiben wir statt $f(z)$ die z-Transformierten mit Großbuchstaben,
z.B. $X(z), H(z), Y(z)$ und Reihenkoeffizienten $c_k$ sind bei uns die typischen
zeitdiskreten Signale $x[k], h[k], y[k]$.
%
Schreiben wir es also für die Übersichtlichkeit nochmal untereinander
\begin{align}
\text{z-Trafo in SigSys:   } X(z) = \sum_{k=-\infty}^{\infty} x[k] \, z^{-k}\qquad
&x[k] = \frac{1}{2\pi \im} \oint\limits_{C \subset \text{KB}} X(z) \, z^{k-1} \, \fsd z\\
\text{Laurent Reihe in Mathe:   } f(z) = \sum_{k=-\infty}^{\infty} c_k (z - z_0)^k\qquad
&c_k = \frac{1}{2\pi\im}\oint\limits_{C \subset \text{KB}}
f(z) (z-z_0)^{-k-1}\fsd z.
\end{align}
Wir beachten, dass die Vorzeichen für $k$ im Exponenten zwischen Mathe und SigSys
unterschiedlich sind.
%
Beides ist korrekt, weil 'Hin/Rück'-Transformationspaar jeweils in sich
konsistent sind.
%
Die SigSys Schreibweise ist für SigSys pragmatischer, weil Ergebnisse
bezüglich Zeitverschiebung einfacher interpretierbar sind.
%
Die z-Rücktransformation kann mit dem Residuensatz
\begin{align}
x[k] = \frac{1}{2\pi \im} \oint\limits_{C \subset \text{KB}} X(z) \, z^{k-1} \, \fsd z
= \text{Res}\{X(z) \, z^{k-1}\}
\end{align}
erfolgen.
%
Wir werden das im Rahmen dieser Übung leider
aus Zeitmangel nicht benutzen, sondern uns wieder mit bekannten Korrespondenzen,
Partialbruchzerlegung und Polynomdivision behelfen.
%
Für das Selbststudium sind ein paar inverse Transformationen mittels Residuensatz
im Abschnitt 1.3 in der Aufgabe \texttt{inverse\_ztransform\_474386F843}
gerechnet.


Als verkürzte Operatorschreibweise können wir entweder
\begin{align}
x[k] \quad\ztransf\quad X(z)\\
X(z) \quad\Ztransf\quad x[k]
\end{align}
oder
\begin{align}
X(z) = \mathcal{Z}\{x[k]\} \\
x[k] = \mathcal{Z}^{-1}\{X(z)\}
\end{align}
schreiben.
Wenn es im Kontext eindeutig klar ist, ginge auch $x[k] \quad\laplace\quad X(z)$,
also mit dem Operator der Laplace Transformation.
%
So wie $s$ als komplexe Frequenzvariable bei der Laplace-Transformation die
$s$-Ebene aufspannt, haben wir es bei $z$ mit der zeitdiskreten, komplexwertigen
Frequenzvariable
\begin{align}
z = \e^{\Sigma + \im \Omega} = \e^{\Sigma} \cdot \e^{\im \Omega}
\end{align}
zu tun mit $\Sigma,\Omega\in\mathbb{R}$ und spannen die komplexe $z$-Ebene auf.
%
\subsection*{Arbeiten im Bildbereich}
Ziel der Transformation, also das Arbeiten im Bildbereich, ist
entweder Rechnungen stark zu vereinfachen bzw. überhaupt erst zu ermöglichen und
Sachverhalte schöner interpretieren zu können.
%
Nachdem wir mittlerweile wissen, dass die Impuls- und Sprungantwort ein LTI-System
vollständig repräsentieren, und somit spezielle
Signale sind, können wir also im $z$-Bildbereich sowohl Signale als auch Systeme
analysieren \textbf{und} synthetisieren.
%
Dazu benötigen wir, ganz ähnlich zur zeitkontinuierlichen Betrachtungsweise, auch
wieder Pole und Nullstellen, Übertragungsfunktion und Frequenzgang aufgetrennt
in Betrag, Phase und Grupppenlaufzeit.
%
All das steckt sehr elegant in der $z$-Transformation an Information drin.
%
\subsection*{Differenzengleichung vs. gebrochen rationale Funktion}
Wir haben gelernt, dass die Laplace Transformation einen starken Bezug zu
Differentialgleichungen mit konstanten Koeffizienten hat.
%
Die $z$-Transformation ist nun für den SigSys-Kontext verknüpfbar
(sie kann viel mehr) zu
\textbf{Differenzengleichungen mit konstanten Koeffizienten} (DGL) der Form
\begin{align}
\sum_{n=0}^N a_n y[k-n] = \sum_{m=0}^M b_m x[k-m]
\end{align}
mit Eingang (Anregung, Störglied) $x[k]$ und Ausgang $y[k]$.
%
Wir können den Ausgang separieren
\begin{align}
a_0 y[k] = \sum_{m=0}^M b_m x[k-m] - \sum_{n=1}^N a_n y[k-n]
\end{align}
%
Eine sehr häufige Konvention ist, dass $y[k]$ mit Eins gewichtet sein soll, was wir erreichen mit
Normierung
\begin{align}
1 \cdot y[k] = \sum_{m=0}^M \left(\frac{b_m}{a_0}\right) x[k-m] - \sum_{n=1}^N \left(\frac{a_n}{a_0}\right) y[k-n].
\end{align}
%
Der Verschiebungssatz, also Zeitverschiebung führt zu
Phasenverschiebung im Spektrum, lautet
\begin{align}
x[k-\kappa] \quad\ztransf\quad z^{-\kappa} \cdot X(z),
\end{align}
speziell also: die Verzögerung des Dirac Impulses um \textbf{einen} Folgenindex (Abtastwert)
führt zu
\begin{align}
\delta[k-1] \quad\ztransf\quad z^{-1} \cdot 1,
\end{align}
können wir anwenden auf die DGL und bekommen die Darstellung im Bildbereich
\begin{equation}
H(z) = \frac{Y(z)}{X(z)} =
\frac{\sum\limits_{m=0}^{M} b_m z^{-m}}{\sum\limits_{n=0}^{N} a_n z^{-n}}=
\frac{b_0 + b_1 z^{-1} + b_2 z^{-2} + \dots + b_M z^{-M}}{a_0 + a_1 z^{-1} + a_2 z^{-2} + \dots + a_N z^{-N}},
\end{equation}
also das Verhältnis von Ausgangs-$z$- zu Eingangs-$z$-Transformierter.
Diese Darstellung---meist wieder normiert, so dass $a_0=1$---wird in
den üblichen SigSys-nahen Programmiersprachen (Matlab,
\texttt{scipy.signal} Paket für Python) einheitlich verwendet.
\textbf{Nichtrekursives System}: falls alle! $a_{n>0} = 0$, also nur
\begin{equation}
H(z) = \frac{Y(z)}{X(z)} =
\frac{\sum\limits_{m=0}^{M} b_m z^{-m}}{a_0}=
\frac{b_0 + b_1 z^{-1} + b_2 z^{-2} + \dots + b_M z^{-M}}{a_0},
\end{equation}
haben wir es mit einem rein-nichtrekursiven System zu tun. Das schauen wir uns
vertiefter in der nächsten Übung~\ref{sec:ue10_dtft} (10) an.
%
\textbf{Rekursives System}: Falls irgendwelche
$a_{n>0} \neq 0$ haben wir es mit Rückkopplung des Ausgangs zurück in das System zu tun,
Stichwort nicht ganz zufällig: Rekursion. Das bezeichnen wir als rekursives System.

\subsection*{Konvergenz}
Betrachten wir das rechtsseitige, und sogar kausale Signal
\begin{align}
x[k] = a^k \epsilon[k]
\end{align}
für $a\in\mathbb{C}$.
%
Wie lautet die $z$-Transformierte dieses Signals. Gemäß Transformationsvorschrift
\begin{align}
X(z) = \sum_{k=0}^{\infty} a^k \, z^{-k} = \sum_{k=0}^{\infty} (a \, z^{-1})^k.
\end{align}
Damit diese Summe konvergiert, also bzgl. des gewählten $z$, ein endlicher Wert
für $X(z)$ rauskommt, also damit
\begin{align}
X(z) = \sum_{k=0}^{\infty} |a \, z^{-1}|^k < \infty
\end{align}
gilt, müssen wir! explizit sicherstellen (nämlich durch die Angabe des
Konvergenzbereichs), dass wir uns nur solche $z$ anschauen, wo diese Konvergenz
sichergestellt ist. In unserem Fall muss
\begin{align}
|a z^{-1}| < 1
\end{align}
gelten, also
\begin{align}
|z| > |a|.
\end{align}
%
Wenn uns das an den Konvergenzradius aus der Funktionentheorie erinnert,
haben wir genau die richtige Schublade.
%
Wenn wir den Betrag $|z|=|a|$
der komplexen Zahl $z = |a| \e^{\im\phi}$ über alle möglichen Winkel $\phi$,
skizzieren, bekommen wir einen Kreis mit Radius $|a|$.
\textbf{Außerhalb dieses Kreises}
ist also Konvergenz sichergestellt, das ist der Konvergenzbereich (KB).
Dieser gilt für \textbf{rechtsseitige Signale}. Wir vertiefen die Betrachtung
hier nicht für linksseitige Signale, dazu sein ein SigSys Buch empfohlen.
%
Aus der Vorlesung ist aber bekannt, dass für \textbf{linksseitige Signale}
der KB im inneren eines Kreises zu finden ist, und für \textbf{beidseitige Signale}
eine Kreisscheibe/Kreisring als KB gilt.

Es ist nun nicht zufällig, dass unsere gesuchte
Korrespondenz mittels der unendlichen geometrischen Reihe
\begin{align}
\sum_{k=0}^\infty q^k = \frac{1}{1-q}\text{ für }|q|<1
\end{align}
gefunden werden kann, nämlich
\begin{align}
\sum_{k=0}^\infty (a z^{-1})^k = \frac{1}{1-a z^{-1}}\text{ für }|a z^{-1}|<1
\end{align}
Wenn wir das noch umschreiben
\begin{align}
X(z) = \sum_{k=0}^\infty (a z^{-1})^k = \frac{z}{z-a}\text{ für } |z|>|a|
\end{align}
landen wir bei der Darstellung in unserer Formelsammlung.
%

Wir machen uns in SigSys nun im Grunde 'nur' zu Nutze, dass $a\in\mathbb{C}$
sein darf, und spezielle Folgen der Form $a^k=(\e^{\Sigma_0 +\im\Omega_0})^k$
\textbf{Eigenfolgen von zeitdiskreten Systemen sind}, welche uns für SigSys speziell
interessiert.
%
Der einfachste Fall ist $a=1$ ($\Sigma_0=0$, $\Omega_0=0$),
dann bekommen wir den Einheitssprung und dessen Korrespondenz.
%
Andere einfache Fälle wären $\Sigma_0 \neq 0$ aber $\Omega_0=0$,
dann haben wir es mit exponentiell ansteigenden oder abklingenden Folgen zu tun.
Ähnlicher Blick auf die Dinge, wie damals in Aufgabe~\ref{sec:A0F7C530F3} (3.1) und \ref{sec:0B03A693AD} (3.2) als wir
mit der Laplace Transformation angefangen haben.

In \fig{fig:single_pole_rightsided_tikz} und
\fig{fig:single_pole_rightsided_alter_tikz}
sind für genau diese Fälle, die Pol-Nullstellen der z-Transformierten
und die resultierenden Zeit-Folgen skizziert.
%
Für $a<0$ haben die Folgen eine zusätzliche Eigenschaft: sie sind alternierend.
Für $a>1$ sind die Folgen nicht beschränkt, sie wachsen also an. Das sollten wir
bei praktischer SigSys unbedingt vermeiden, ist aber im Kontext der
Konvergenzbetrachtung durchaus erlaubt.

Wenn wir diese Abbildungen verstehen und die Analogien zu den Beispielen
der Laplace Transformation \fig{fig:0B03A693AD_rightsided} (3.2)
einordnen können, sind wir bereit für
die kommenden Rechenaufgaben.

\input{../z_transform/single_pole_rightsided_tikz.tex}
\input{../z_transform/single_pole_rightsided_alter_tikz.tex}





\newpage
\subsection{Addition von komplexen Ein-Pol Signalen}
\label{sec:542FA69517}
\begin{Ziel}
Die $z$-Transformation ist ein sehr mächtiges Werkzeug zur Analyse und Synthese
von zeitdiskreten Signalen und Systemen. Sie lebt in der komplexen $z$-Ebene.
Nachdem wir einleitend für ein paar Standardsignale Korrespondenzen
kennengelernt hatten, wollen wir mit einem einfachen Beispiel ein paar
typische Rechnungen durchgehen, die in ähnlicher Form immer wiederkehren.
Dabei wollen wir vor allem verinnerlichen, welchen Einfluss Pole haben
und wie Zeit- und Bildbereich miteinander verknüpft sind. Wenn wir anhand
eines Zeitsignals eine Erwartungshaltung entwickeln können, wie die $z$-Transformierte
dazu ausschaut und anders herum, haben wir einen guten Zugang zu dem Werkzeug.
Wenn wir es dann noch rechnerisch korrekt und sicher anwenden können, sind wir
bestens aufgehoben in der SigSys-Community.
\end{Ziel}
\textbf{Aufgabe} {\tiny 542FA69517}:
Gegeben sind die kausalen Signale (hier zeitdiskret, also Folgen)
\begin{align}
&x_+[k]=\e^{+\im\frac{\pi}{4} k} \epsilon[k]\\
&x_-[k]=\e^{-\im\frac{\pi}{4} k} \epsilon[k]
\end{align}
Geben Sie die Pol-Nullstellen-Diagramme für
$X_+(z) \ztransf x_+[k]$,
$X_-(z) \ztransf x_-[k]$ und
$X(z) = X_+(z) + X_-(z)$ an und skizzieren Sie die Signale
$x_+[k]$, $x_-[k]$, $x[k]=x_+[k]+x_-[k]$

\begin{Werkzeug}
komplexe Zahlen, Euler Identität,
Korrespondenz Formelsammlung $a^k \epsilon[k] \ztransf \frac{z}{z-a}$ für $|z|>|a|$,
Pole, Nullstellen und in komplexe Ebene skizzieren. Diese Grundzutaten brauchen wir
sehr sehr oft. Die Interpretation der Dinge ist hier zunächst wieder wichtiger
als sehr, sehr schwierige Mathe rechnen zu können.
\end{Werkzeug}
\begin{Ansatz}
Wir müssen zunächst erkennen, dass $x_\pm[k]$ komplexe Signale sind. Des weiteren
sind sie hier periodisch, wegen $\frac{\pi}{4}=\frac{2\pi}{8}$ in $N=8$.
$x_+[k]$ hat eine positive digitale Kreisfrequenz $+\frac{2\pi}{8}$, $x_-[k]$ eine negative $-\frac{2\pi}{8}$. Oder
andere Sichtweise: der mit $k$ variierende Zeiger $x_+[k]$ läuft mathematisch
positiv, der Zeiger $x_-[k]$ negativ. Also im Grunde alles genauso, wie wir
es mit Einführung der komplexen Fourierreihe und -transformation schon kennen.

Ein weiterer Klassiker ist, dass die Addition dieser beiden Signale auf
die reellwertige Cosinus-Folge
\begin{align}
x_+[k] + x_-[k]=
\e^{+\im\frac{\pi}{4} k} \epsilon[k] + \e^{-\im\frac{\pi}{4} k} \epsilon[k]
= 2 \cos(\frac{\pi}{4} k) \epsilon[k]
\end{align}
führt, weil beide die gleiche digitale Kreisfrequenz $\frac{\pi}{4}$ haben und
nur das Vorzeichen unterschiedlich ist, also direkt Euler Identität.
%
Wir werden für die $z$-Ebene die Euler Identitäten sehr oft sinnstiftend
anwenden können.
%
Wir könnten also (das machen wir auch) die $z$-Transformierte für diese Folge neu
erfinden, wenn wir nur die Korrespondenz $a^k \epsilon[k] \ztransf \frac{z}{z-a}$
kennen.
\end{Ansatz}
\begin{ExCalc}
\begin{align}
&X_+(z) = \frac{z}{z-\e^{+\im\frac{\pi}{4}}}\text{ für } |z|>1 \\
&X_-(z) = \frac{z}{z-\e^{-\im\frac{\pi}{4}}}\text{ für } |z|>1 \\
&X(z) = X_+(z) + X_-(z) = \frac{z}{z-\e^{+\im\frac{\pi}{4}}} + \frac{z}{z-\e^{-\im\frac{\pi}{4}}}\text{ , i.e. eine Parallelschaltung}\\
&X(z) = \frac{z \left(z-\e^{-\im\frac{\pi}{4}}\right) + z \left(z-\e^{+\im\frac{\pi}{4}}\right)}
{\left(z-\e^{+\im\frac{\pi}{4}}\right)\cdot \left(z-\e^{-\im\frac{\pi}{4}}\right)}\text{ , i.e. eine Reihenschaltung}\\
&X(z)  = \frac{z \left(z-\e^{-\im\frac{\pi}{4}}\right) + z \left(z-\e^{+\im\frac{\pi}{4}}\right)}
{z^2 - z \e^{+\im\frac{\pi}{4}} - z \e^{-\im\frac{\pi}{4}} + 1}=
\frac{z \left(z-\e^{-\im\frac{\pi}{4}}\right) + z \left(z-\e^{+\im\frac{\pi}{4}}\right)}
{z^2 - 2 z \cos(\frac{\pi}{4}) + 1}\\
&X(z) = \frac{z^2 - z \e^{-\im\frac{\pi}{4}} + z^2 - z \e^{+\im\frac{\pi}{4}}}
{z^2 - 2 z \cos(\frac{\pi}{4}) + 1} =
\frac{2 z^2 - z (\e^{+\im\frac{\pi}{4}} + \e^{-\im\frac{\pi}{4}} )}
{z^2 - 2 z \cos(\frac{\pi}{4}) + 1}\\
&X(z) =\frac{2 z^2 - 2 z \cos(\frac{\pi}{4})}{z^2 - 2 z \cos(\frac{\pi}{4}) + 1}=
2 \cdot \frac{z^2 - z \cos(\frac{\pi}{4})}{z^2 - 2 z \cos(\frac{\pi}{4}) + 1}\\
&X(z) = 2 \cdot \frac{z^2-\frac{1}{\sqrt{2}} z}{z^2-\sqrt{2} z +1}\text{ für } |z|>1
\end{align}
%
Wir finden eine passende Korrespondenz in der Formelsammlung, wenn wir
$\Omega_0=\frac{\pi}{4}$ einsetzen. Für Konvergenzbereich $|z|>1$ können wir
zurück transformieren zum zeitdiskreten Signal
$x[k] = 2\cos(\Omega_0 k) \epsilon[k] = 2 \cos(\frac{2\pi}{8} k) \epsilon[k]$.
Wir bekommen eine 8-Werte periodische Cosinus-Folge.
%
Andererseits wussten wir bereits aus dem Ansatz, dass falls wir uns nicht
verrechnet haben, das Ergebnis $X(z)$ genau zu
$x[k] = 2\cos(\Omega_0 k) \epsilon[k]$ gehören muss,
weil auch die $z$-Transformation Linearitätseigenschaft--also Addition bildet sich
auf Addition ab---aufweist.

Um das Pol-Nullstellen Diagramm für $X(z)$ in der $z$-Ebene zeichnen zu können,
brauchen wir  die Pole, Nullstellen und den Verstärkungsfaktor.
Das ist ganz analog zu der Betrachtung die wir im $s$-Bereich bei der Laplace
Transformation gemacht haben.
%
Wir sollten uns klarmachen, dass wir bei der obigen Umformung die Pole nicht
verändert haben. Zur Sicherheit rechnen wir sie nochmal aus. Mit der pq-Formel
\begin{align}
z_{\infty,1,2} = -\frac{-2\cos(\frac{\pi}{4})}{2} \pm \sqrt{(\frac{-2 \cos(\frac{\pi}{4})}{2})^2-1}
=
\frac{1}{\sqrt{2}} \pm \sqrt{\frac{1}{2}-1}
=
\frac{1}{\sqrt{2}} \pm \im \frac{1}{\sqrt{2}},
\end{align}
und in sinnvoller zu überschauender Polardarstellung
\begin{align}
z_{\infty,1,2} = 1 \cdot \e^{\pm \im \frac{\pi}{4}}.
\end{align}
Kein überraschendes Ergebnis, schließlich hatten wir die Aufgabe ja so begonnen.
%
Für die Nullstellen brauchen wir nicht unbedingt die pq-Formel,
es lässt sich hier viel schneller erledigen, weil wir ausklammern können
\begin{align}
z_{0,1,2} (z_{0,1,2} - \cos(\frac{\pi}{4})) = 0,
\end{align}
d.h.
\begin{align}
z_{0,1} = 0\quad \text{und} \quad z_{0,2} = \cos(\frac{\pi}{4})=\frac{1}{\sqrt{2}}.
\end{align}
Hier haben wir wieder den Fall, dass entweder konjugiert-komplexe Nullstellen
und/oder rein reellwertige Nullstellen auftreten dürfen (gilt auch für die Pole),
damit $X(z)$ eine gebrochen rationale Funktion mit reellen Koeffizienten
darstellt, was wiederum rein reellwertige Signale nach sich zieht. In der Praxis
wollen wir meistens genau mit reellwertigen Signalen arbeiten.
%

Die $z$-Transformierte kann jetzt in Pol/Nullstellen/Verstärkung-Darstellung
angegeben werden zu
\begin{align}
X(z) = 2 \cdot \frac{(z-0) (z-\frac{1}{\sqrt{2}})}{(z-(\frac{1}{\sqrt{2}} + \im \frac{1}{\sqrt{2}})) (z-(\frac{1}{\sqrt{2}} - \im \frac{1}{\sqrt{2}}))}
\end{align}
was nichts anderes ist als
\begin{align}
X(z) = 2 \cdot \frac{(z-0) (z-\frac{1}{\sqrt{2}})}{(z-\e^{+ \im \frac{\pi}{4}})(z-\e^{-\im \frac{\pi}{4}})},
\end{align}
die wohl übersichtlichste Form, um das PN-Diagramm malen zu können. Wir sehen
die reellwertigen Nullstellen sofort und das komplex-konjugierte Polstellenpaar
springt einem auch unmittelbar ins Auge, und der Verstärkungsfaktor steht
vor dem Bruch.
%
\end{ExCalc}
\begin{Loesung}
In \fig{fig:542FA69517} sind nun alle geforderten Skizzen zusammengetragen.
\end{Loesung}
\input{../z_transform/cos_rightsided_tikz.tex}


\newpage
\subsection{z-Transformation Sinus und Modulation}
\label{sec:EF72605A91}
\begin{Ziel}
Wir könnten den Ansatz aus Aufgabe \ref{sec:542FA69517} wählen, um die
$z$-Transformierte für $x[k]=\sin(\Omega_0 k)$ zu finden.
Damit die Aufgabe nun noch ein bisschen spannender wird, verschieben wir die Pole
weg vom Einheitskreis ins Innere, d.h. die Pole haben dann Betrag kleiner 1,
und damit erhalten wir gedämpfte/abklingende Schwingungen.
Das können wir uns auch einfacher mit Hilfe des Modulationstheorems erarbeiten,
was wir im folgenden mal durchspielen.
\end{Ziel}
\textbf{Aufgabe} {\tiny EF72605A91}: Berechnen Sie die $z$-Transformierte
\begin{align}
x[k] = 2 \left(\frac{3}{4}\right)^k \cdot \sin(\frac{\pi}{3} k) \cdot \epsilon[k]
\end{align}
und skizzieren Sie das PN-Diagramm mit Angabe des Konvergenzbereichs.
\begin{Werkzeug}
Korrespondenzen:
%
Modulation des Einheitssprungs mit Sinussignal im Zeitbereich
\begin{align}
\sin(\Omega_0 k)\epsilon[k]\quad\ztransf\quad\frac{z\sin(\Omega_0)}{z^2 -2 z \cos(\Omega_0)+1}
\end{align}
führt im Bildbereich zur Polverschiebung (konjugiert-komplex) auf dem Einheitskreis.
%
Dies ist ein Spezialfall des allgemeingültigen Modulationstheorems für
$a\in\mathbb{C}$
\begin{align}
a^k x[k] \quad\ztransf\quad X\left(\frac{z}{a} \right)
\end{align}
\end{Werkzeug}
\begin{Ansatz}
Korrespondenzen benutzen
\end{Ansatz}
\begin{ExCalc}
Zunächst den Sinus einzeln transformieren mit
$\sin(\frac{\pi}{3}) = \frac{\sqrt{3}}{2}$, $\cos(\frac{\pi}{3}) = \frac{1}{2}$
\begin{align}
\sin(\frac{\pi}{3} k) \epsilon[k] \quad\ztransf\quad X_s(z) = \frac{\frac{\sqrt{3}}{2}z}{z^2 - z +1}
\end{align}
dann Amplitudenskalierung $2$ und Modulationstheorem mit $a=\frac{3}{4}$ berücksichtigen
\begin{align}
x[k] \quad\ztransf\quad X(z) = 2 \cdot X_s(\frac{z}{a}) =
2 \cdot \frac{\frac{\sqrt{3}}{2} \frac{z}{\nicefrac{3}{4}}}{(\frac{z}{\nicefrac{3}{4}})^2 - \frac{z}{\nicefrac{3}{4}} +1}
=
2 \cdot \frac{\frac{3\sqrt{3}}{8} z}{z^2 - \frac{3}{4}z + \frac{9}{16}}
\end{align}
%
Verstärkungsfaktor: $g=+2$,
%
Nullstelle: $z_{0,1} = 0$,
%
Polstellen: $z_{\infty,1,2} = \frac{\sqrt{3}}{8} \pm \frac{3\sqrt{3}}{8} \im \approx 0.375 \pm 0.65\im$,
%
Polstellen in Polardarstellung: $z_{\infty,1,2} = \frac{3}{4}\e^{\pm\im \frac{\pi}{3}}$,
%
Polstellenbetrag (dieser Radius bestimmt den KB): $|z_{\infty,1,2}| = \frac{3}{4}$,
%
KB: $|z|>|z_{\infty,1,2}| = \frac{3}{4}$

\end{ExCalc}
\begin{Loesung}
\begin{center}
\begin{tikzpicture}
\def \tic {0.05}
\filldraw[even odd rule,C2!50] (0,0) circle(0.75)
decorate [decoration={snake,segment length=15pt,amplitude=1pt}]{(0,-3pt) circle(1.5)};;
\draw[help lines, C7!50, step=0.25cm] (-1,-1) grid (1,1);
\draw[C3] (0,0) circle(1);
\node at (0.5, 1.5){\tiny $g = +2$};
\draw (1.2*0.86602540378*1.5,1.2*0.5*1.5) node[C2!75]{KB};
\draw[->] (-1.8,0)--(2,0) node[right]{$\Re\{z\}$};
\draw[->] (0,-1.8)--(0,2) node[above]{$\Im\{z\}$};
\draw (0.375,+0.649519052838329) node[C0]{\Large $\times$};
\draw (0.375,-0.649519052838329) node[C0]{\Large $\times$};
\draw (0,0) node[C0]{\Large $\circ$};
\draw (1+2*\tic,-2*\tic) node{$1$};
\draw (2.5,-1) node{$X(z) = 2 \cdot \frac{\frac{3\sqrt{3}}{8} z}{z^2 - \frac{3}{4}z + \frac{9}{16}}$};
\end{tikzpicture}
\end{center}
Wir machen uns klar, dass $\frac{\pi}{3}$ exakt 60 Grad entspricht.
\end{Loesung}


\input{../z_transform/sin_rightsided_tikz.tex}
\begin{mdframed}
%
Der gleiche Gedankengang und Rechenweg wie in Aufgabe \ref{sec:542FA69517} ist
im Folgenden darstellt, siehe dazu die \fig{fig:EF72605A91}.

Für $k\geq 0$
\begin{align}
x[k]=\frac{x_+[k]-x_-[k]}{\im} =
\frac{
\left(\frac{3}{4}\right)^k \e^{+\im\frac{\pi}{3} k} -
\left(\frac{3}{4}\right)^k \e^{-\im\frac{\pi}{3} k}
}{\im}
=
2 \left(\frac{3}{4}\right)^k
\frac{
\e^{+\im\frac{\pi}{3} k} -
\e^{-\im\frac{\pi}{3} k}
}{2\im}
=
2 \left(\frac{3}{4}\right)^k \sin(\frac{\pi}{3} k)
\end{align}
%
\begin{align}
x_+[k] = \left(\frac{3}{4}\right)^k \e^{+\im\frac{\pi}{3} k} =
\left(\frac{3}{4} \e^{+\im\frac{\pi}{3}}\right)^k
\ztransf
X_+(z) = \frac{z}{z-\frac{3}{4}\e^{+\im\frac{\pi}{3}}}\\
%\end{align}
%\begin{align}
x_-[k] = \left(\frac{3}{4}\right)^k \e^{-\im\frac{\pi}{3} k} =
\left(\frac{3}{4} \e^{-\im\frac{\pi}{3}}\right)^k
\ztransf
X_-(z) = \frac{z}{z-\frac{3}{4}\e^{-\im\frac{\pi}{3}}}
\end{align}
Nun $x[k] \ztransf X(z)$, wobei wir das $\frac{1}{\im}$ der besseren Übersichtlichkeit erst einmal
zu $X(z)$ packen:
\begin{align}
\im X(z) = X_+(z) - X_-(z) =
\frac{z}{z-\frac{3}{4}\e^{+\im\frac{\pi}{3}}} - \frac{z}{z-\frac{3}{4}\e^{-\im\frac{\pi}{3}}}
%\end{align}
%
%\begin{align}
\\
\im X(z) =
\frac{z(z-\frac{3}{4}\e^{-\im\frac{\pi}{3}}) - z(z-\frac{3}{4}\e^{+\im\frac{\pi}{3}})}
{(z-\frac{3}{4}\e^{+\im\frac{\pi}{3}})(z-\frac{3}{4}\e^{-\im\frac{\pi}{3}})}
%\end{align}
%
%\begin{align}
\\
\im X(z) =
\frac{z^2-z\frac{3}{4}\e^{-\im\frac{\pi}{3}} - z^2 + z\frac{3}{4}\e^{+\im\frac{\pi}{3}}}
{(z-\frac{3}{4}\e^{+\im\frac{\pi}{3}})(z-\frac{3}{4}\e^{-\im\frac{\pi}{3}})}
=
\frac{\frac{3}{4}z(\e^{+\im\frac{\pi}{3}}-\e^{-\im\frac{\pi}{3}})}
{(z-\frac{3}{4}\e^{+\im\frac{\pi}{3}})(z-\frac{3}{4}\e^{-\im\frac{\pi}{3}})}
%\end{align}
%
%\begin{align}
\\
X(z) =
\frac{\frac{3}{2}z(\frac{\e^{+\im\frac{\pi}{3}}-\e^{-\im\frac{\pi}{3}}}{2\im})}
{(z-\frac{3}{4}\e^{+\im\frac{\pi}{3}})(z-\frac{3}{4}\e^{-\im\frac{\pi}{3}})}=
2 \cdot \frac{\frac{3}{4} z \sin(\frac{\pi}{3})}
{(z-\frac{3}{4}\e^{+\im\frac{\pi}{3}})(z-\frac{3}{4}\e^{-\im\frac{\pi}{3}})}
%\end{align}
%
%\begin{align}
\\
X(z) =
2 \cdot \frac{\frac{3}{4} z \sin(\frac{\pi}{3})}
{z^2 - z \frac{3}{4}\e^{-\im\frac{\pi}{3}} - z \frac{3}{4}\e^{+\im\frac{\pi}{3}} + \frac{9}{16}}=
2 \cdot \frac{\frac{3}{4} \cdot z \sin(\frac{\pi}{3})}
{z^2 - \frac{3}{4} \cdot 2 z \cos(\frac{\pi}{3}) + \frac{9}{16}}
\end{align}
Die allgemeine Formel für ein konjugiert-komplexes Polpaar
$z_{\infty,1,2} = r_0 \e^{\pm \im \phi_0}$ mit Radius $r_0\in\mathbb{R}$ und
Winkel $\phi_0\in\mathbb{R}$ (in zeitdiskreter SigSys ist das $\Omega_0$)
und eine Nullstelle $z_0 = 0$ lautet
\begin{align}
r^k \sin(\Omega_0 k)\epsilon[k] \ztransf \frac{(r\sin\Omega_0)z}{z^2 -(2r\cos\Omega_0)z + r^2}
\end{align}
Das finden wir exakt in unserer Rechnung wieder.
%
Lösen wir noch ein wenig weiter auf mit
$\Omega_0 = \frac{\pi}{3}$,
$\sin(\Omega_0)=\sin(\frac{\pi}{3}) = \frac{\sqrt{3}}{2}$,
$\cos(\Omega_0)=\cos(\frac{\pi}{3}) = \frac{1}{2}$
erhalten wir
\begin{align}
X(z) =
2 \cdot \frac{\frac{3\sqrt{3}}{8} z}
{z^2 - \frac{3}{4}z + \frac{9}{16}}
=
\frac{\frac{3\sqrt{3}}{4} z^{-1}}
{1 - \frac{3}{4}z^{-1} + \frac{9}{16} z^{-2}}
\quad \Ztransf \quad
x[k] = 2 \left(\frac{3}{4}\right)^k \sin(\frac{\pi}{3} k) \epsilon[k]
\end{align}
und bestätigen unseren ersten Rechenweg.
Der zweite Bruch für $X(z)$ ist die für Matlab / Python sinnvolle Darstellung. In Matlab
können wir z.B. mit den Kommandos
\\\texttt{x=impz([0 3*sqrt(3)/4 0],[1 -3/4 9/16])}
und
\\\texttt{x=zplane([0 3*sqrt(3)/4 0],[1 -3/4 9/16])}
prüfen, ob wir richtig gerechnet haben, wenn wir mit dem händisch implementierten
Zeitsignal und PN-Diagramm vergleichen.
\end{mdframed}



\newpage
\subsection{Impuls-/Sprungantwort für rekursives System 1. Ordnung über z-Transformation}
\label{sec:A1D74A9E5B}
\begin{Ziel}
Ähnlich wie Aufgabe~\ref{sec:4408E33353} (3.4) wollen wir uns anhand eines einfachen LTI-Systems
die Benutzung der z-Transformation erarbeiten. Dabei soll rumkommen, dass
der Umweg über den Bildbereich eine elegante Methode ist Differenzengleichungen
zu 'lösen'.
\end{Ziel}
\textbf{Aufgabe} {\tiny A1D74A9E5B}: Gegeben ist die Differenzengleichung (DGL)
\begin{align}
y[k] = x[k] + \frac{1}{2} y[k-1]
\end{align}
eines zeitdiskreten Systems, welches wir für $k \geq 0$ und $y[-1]=0$ betrachten
wollen, also ein kausales System mit verschwindenden Anfangsbedingungen.
Berechnen Sie die Impulsantwort $h[k]$ und die Sprungantwort $h_\epsilon[k]$
im Zeitbereich und über den Umweg der z-Transformation.
\begin{Werkzeug}
Machen wir uns klar, dass die DGL eine Rekursionsformel ist, die vor allem
in Mathematik $y_k = x_k + \frac{1}{2} y_{k-1}$ geschrieben wird. D.h. alles
was wir aus der Mathe/Numerik zu Rekursion wissen, können wir hier verlinken.
Wir werden sehen, dass wir in SigSys sehr elegante Bildbereich-Werkzeuge haben,
diese Rekursionen auszurechnen und viel wichtiger sie aus SigSys-Sicht
interpretieren zu können.
\end{Werkzeug}
\begin{Ansatz}
\textbf{Lösung im Zeitbereich}:
Falls wir den SigSys-Werkzeugkoffer nicht parat haben, könnten wir die
Aufgabenstellung zu Fuß lösen. Da spricht zunächst nichts dagegen.

\textbf{Impulsantwort}
Sei also die obige DGL die Systembeschreibung eines LTI-Systems $\mathcal{H}$.
Dann erhalten wir bei Anregung mit der Dirac Impuls Folge $\delta[k]$, die Impulsantwort $h[k]$
dieses Systems, also $h[k] = \mathcal{H}\{\delta[k]\}$. Machen wir das gleiche
was ein Computer machen würde, wenn wir diese DGL als for-Schleife programmieren
würden. Wir brauchen einen Zwischenspeicher für $y[k-1]$ und müssen für jedes
$k$ die Berechnungsvorschrift ausführen. Auf Papier ist das sehr übersichtlich
in Tabellenform. Jedes Signal aus der DGL (also Eingang $x[k]$, Ausgang $y[k]$
und Zwischenspeicher / rekursives Element $y[k-1]$ bekommt eine Spalte) und
über die Zeilen wird $k$ inkrementiert. Diese Tabelle müssen wir nun ausgehend
von $k=0$ sukzessive ausfüllen. Da das System rekursiv ist, würde die Tabelle
unendlich viele Zeilen beinhalten müssen, wenn wir die gesamte Impulsantwort
in Zahlenform angeben wollen. Das System hier ist natürlich wieder mal didaktisch
so gewählt, dass wir irgendwann mal einen analytischen Zusammenhang sehen.

Also Tabelle ausfüllen:
\begin{center}
\begin{tabular}{||c | c | c | c||}
\hline
$k$ & $x[k]$ & $y[k-1]$ & $y[k]$ \\
\hline\hline
$k$ & $x[k]=\delta[k]$ & $y[k-1]$ & $y[k] = h[k]$ \\
\hline
0 & 1 & 0 & 1  \\\hline
1 & 0 & 1  & $\nicefrac{1}{2}$ \\\hline
2 & 0 & $\nicefrac{1}{2}$ & $\nicefrac{1}{4}$ \\\hline
3 & 0 & $\nicefrac{1}{4}$ & $\nicefrac{1}{8}$ \\\hline
4 & 0 & $\nicefrac{1}{8}$ & $\nicefrac{1}{16}$ \\\hline
5 & 0 & $\nicefrac{1}{16}$ & $\nicefrac{1}{32}$ \\\hline
6 & 0 & $\nicefrac{1}{32}$ & $\nicefrac{1}{64}$ \\\hline
: & : & : & : \\\hline
$K > 0$ & 0 & $\nicefrac{1}{2^{K-1}}$ & $\nicefrac{1}{2^K}$ \\\hline
\end{tabular}
\end{center}
Wir finden eine Regelmäßigkeit, die wir analytisch angeben können
\begin{align}
h[k] = \left(\frac{1}{2}\right)^k \epsilon[k],
\end{align}
was sich noch verallgemeinern lässt für $a\in\mathbb{C}$
\begin{align}
y[k] = x[k] + a \cdot y[k-1] \rightarrow h[k] = a^k \epsilon[k]
\end{align}
Für $|a|<1$ führt dies auf eine abklingende Folge. In unserem ganz einfachen
Beispiel ist $a$ reell und führt daher zu der Folge, der wir sofort die
analytische Berechnungsvorschrift ansehen. Dass es hier so einfach ist, ist
wieder intentional weil es um das Wesen gehen soll.

\textbf{Sprungantwort}
Wenn wir nochmal zeitdiskrete Faltung üben wollen, wäre das eine willkommene
Stelle: wir können die Sprungantwort mittels
\begin{align}
h_\epsilon[k] = \epsilon[k] \ast_k h[k]
\end{align}
berechnen.
Ansonsten funktioniert es auch hier wieder mit Hilfe einer
Tabelle. Wir wählen als Eingangssignal den Einheitssprung $x[k]=\epsilon[k]$
um $h_\epsilon[k] = \mathcal{H}\{\epsilon[k]\}$ zu erhalten.
%
\begin{center}
\begin{tabular}{||c | c | c | c||}
\hline
$k$ & $x[k]$ & $y[k-1]$ & $y[k]$ \\
\hline\hline
$k$ & $x[k]=\epsilon[k]$ & $y[k-1]$ & $y[k] = h_\epsilon[k]$ \\
\hline
0 & 1 & 0 & 1  \\\hline
1 & 1 & 1  & $1+\nicefrac{1}{2}$ \\\hline
2 & 1 & $1+\nicefrac{1}{2}$ & $1+\nicefrac{1}{2}+\nicefrac{1}{4}$ \\\hline
3 & 1 & $1+\nicefrac{1}{2}+\nicefrac{1}{4}$ & $1+\nicefrac{1}{2}+\nicefrac{1}{4}+\nicefrac{1}{8}$ \\\hline
4 & 1 & $1+\nicefrac{1}{2}+\nicefrac{1}{4}+\nicefrac{1}{8}$ & $1+\nicefrac{1}{2}+\nicefrac{1}{4}+\nicefrac{1}{8}+\nicefrac{1}{16}$ \\\hline
5 & 1 & $1+\nicefrac{1}{2}+\nicefrac{1}{4}+\nicefrac{1}{8}+\nicefrac{1}{16}$ & $1+\nicefrac{1}{2}+\nicefrac{1}{4}+\nicefrac{1}{8}+\nicefrac{1}{16}+\nicefrac{1}{32}$ \\\hline
6 & 1 & $1+\nicefrac{1}{2}+\nicefrac{1}{4}+\nicefrac{1}{8}+\nicefrac{1}{16}+\nicefrac{1}{32}$ & $1+\nicefrac{1}{2}+\nicefrac{1}{4}+\nicefrac{1}{8}+\nicefrac{1}{16}+\nicefrac{1}{32}+\nicefrac{1}{64}$ \\\hline
: & : & : & : \\\hline
$K \geq 0$ & 1 & $\sum_{k'=0}^{K-1} \nicefrac{1}{2^{k'}}$ & $\sum_{k'=0}^K \nicefrac{1}{2^{k'}}$ \\\hline
\end{tabular}
\end{center}
Auch hier können wir die Regelmäßigkeit schnell in eine Formel überführen, also für $k\geq 0$
\begin{align}
h_\epsilon[k] = \sum_{k'=0}^k \frac{1}{2^{k'}} = \sum_{k'=0}^k \left(\frac{1}{2}\right)^{k'}
\end{align}
Wir haben hier einen bereits bekannten Zusammenhang neu 'erfunden': die Sprungantwort
ist die kumulierte Summe der Impulsantwort
\begin{align}
h_\epsilon[k] = \sum_{k'=-\infty}^{k} h[k'].
\end{align}
%
Für $k \to \infty$, kennen wir sogar den Wert an den sich unsere betrachtete Folge
asymptotisch annähert. Die Formel ist ja die früher schon mal bemühte
geometrische Reihe
\begin{align}
\sum_{k'=0}^{\infty} a^{k'} = \frac{1}{1-a}\text{ für } a<1
\end{align}
In unserem Fall mit $a=\nicefrac{1}{2}$ ist daher $h_\epsilon[k=\infty] = 2$.
Um eine Analogie
herzustellen, was wir da vor uns haben, wäre das die finale Kondensatorspannung
nach Anlegen von Gleichspannung bei einem digitalen RC-Glied. In der Tat hat
dieses zeitdiskrete System Tiefpasscharakter, wir werden das später vertiefen.

Ok, Aufgabe gelöst?!?! Ja und nein. Ja, weil die eigentliche Aufgabenstellung
tatsächlich gelöst ist. Nein, weil, sobald die Rekursionsformel geringfügig
komplexer wird, wird es sehr mühsam und mutmaßlich sogar unmöglich aus dieser
Rekursionsformel die analytisch geschlossene Berechnungsvorschrift zu extrahieren.
Stellen wir uns vor, dass sich die Impuls- und/oder Sprungantwort zusammensetzt
aus der Summe mehrerer analytischer Berechnungsvorschriften (Linearität),
das ist in der Tat sehr praxisnah für typische SigSys-Systeme. Wir werden diesen
Fakt nur sehr schwer aus den finalen Ergebniszahlen re-engineeren können, vielleicht
ist es sogar unmöglich, das wissen Mathematiker*innen besser.
Wir können also solche Systeme zwar ohne viel Aufwand mit einem Computerprogramm
realisieren, aber wir wissen dann nicht zwangsläufig was das System macht.
Das wäre wieder Gebastel und wir wollen ja ingenieurig arbeiten.
%
Wir haben erfreulicherweise ein hervorragendes Werkzeug dafür: die z-Transformation.
Mit dem Umweg im Bildbereich zu rechnen und die Rücktransformation durchzuführen,
haben wir genau die Chance die Lösung als Summe analytischer Berechnungsvorschriften
darzustellen. Natürlich nur dann, wenn die Rücktransformationen auch bekannt sind,
was für die meisten praxisnahen Fälle zum Glück der Fall ist. Es ist daher ähnlich
wie bei der Laplace Transformation: falls wir wirklich mal in die Lage kommen
sollten, eine Rücktransformation nicht in Tabellenwerken zu finden und selber
erfinden zu müssen, haben wir ein sehr delikates Problem vor uns, was
wissenschaftliches Neuland sein dürfte.
\end{Ansatz}
\begin{ExCalc}
\textbf{Lösung im Bildbereich}:
Die Idee ist wieder eine Differenzengleichung in eine algebraische Gleichung zu überführen,
weil wir damit viel einfacher rechnen können.
Aus dieser lässt sich die Übertragungsfunktion $H(z)$ des Systems in Form einer
gebrochen rationalen Funktion angeben. Das dahinterliegende Wesen ist einer der
schönsten Zusammenhänge des Ingenieurshandwerks, ganz analog zur Laplace
Transformation (hier leider wegen Zeitmangel keine Anfangsbedingungen,
da sei auf die SigSys Literatur verwiesen).
\begin{align}
&y[k] = x[k] + \frac{1}{2} y[k-1] \leftrightarrow y_k = x_k + \frac{1}{2} y_{k-1}\\
&y[k] - \frac{1}{2} y[k-1] = x[k] \,\ztransf\, Y(z) - \frac{1}{2} z^{-1} Y(z) = X(z)\\
&Y(z) (1-\frac{1}{2} z^{-1}) = X(z) \rightarrow H(z) = \frac{Y(z)}{X(z)} =
\frac{1}{1-\frac{1}{2} z^{-1}} = \frac{z}{z-\frac{1}{2}}
\end{align}
Die z-Transformierte des Ausgangssignals findet sich also über
\begin{align}
\label{eq:Y_HX_zTrafo_A1D74A9E5B}
Y(z) = H(z) \cdot X(z) = \frac{1}{1-\frac{1}{2} z^{-1}} \cdot X(z)
\end{align}

\textbf{Impulsantwort}
Machen wir uns klar, dass die Faltung/Multiplikations-Dualität gilt
\begin{align}
x[k] \ast_k h[k] \quad\ztransf\quad X(z) \cdot H(z)
\end{align}
Der Dirac Impuls hat folgende $z$-Trafo Korrespondenz
\begin{align}
\delta[k] \quad\ztransf\quad 1\text{ mit KB:} \in\mathbb{C}
\end{align}
Der Dirac Impuls ist auch in der zeitdiskreten SigSys das Neutralelement der Faltung,
also
\begin{align}
\delta[k] \ast_k h[k] \quad\ztransf\quad 1 \cdot H(z)\\
h[k] \quad\ztransf\quad H(z)
\end{align}
womit wir wieder den Zusammenhang zwischen Impulsantwort und Übertragungsfunktion
gefunden haben, alles ganz analog zur Laplace Transformation.
%
Wenn wir also die Impulsantwort zu Fuß ausrechnen wollen
mit \eq{eq:Y_HX_zTrafo_A1D74A9E5B}, dann müssen wir $X(z)=1$ ansetzen.
%
Oder wir transformieren direkt die Übertragungsfunktion
\begin{align}
H(z) = \frac{1}{1-\frac{1}{2} z^{-1}} = \frac{z}{z-\frac{1}{2}}
\quad\Ztransf\quad
h[k] = \left(\frac{1}{2}\right)^k \epsilon[k]
\end{align}
zurück, weil wir den Zusammenhang ja mittlerweile bestens kennen.
Aus \fig{fig:single_pole_rightsided_tikz} oben ist uns diese Korrespondenz
bereits bekannt, es ist das 1-Pol Signal mit reellem Pol und
der Nullstelle im Ursprung.
%Das war natürlich wieder eine intentionale Verknüpfung
%zu Dingen die wir schon kennen.

\textbf{Sprungantwort}
Die Korrespondenz des Einheitssprungs kennen wir auch schon gut
\begin{align}
x[k]=\epsilon[k] \quad\ztransf\quad X(z) = \frac{z}{z-1} = \frac{1}{1-z^{-1}}
\end{align}
$X(z)$ setzen wir in \eq{eq:Y_HX_zTrafo_A1D74A9E5B} ein. Wir erhalten
\begin{align}
Y(z) = H_\epsilon(z) = \frac{1}{1-\frac{1}{2} z^{-1}} \cdot \frac{1}{1-z^{-1}} =
\frac{z}{z-\frac{1}{2}} \cdot \frac{z}{z-1}
\end{align}
Für die Rücktransformation $h_\epsilon[k] \Ztransf H_\epsilon(z)$ bietet sich
wieder die Partialbruchzerlegung an, wir haben ja das Ziel die gebrochen rationale
Funktionen in die Superpositionen einfacher Korrespondenzen zu zerlegen.
Hier ist jetzt ein \textbf{Trick} sinnvoll, der zur
\textbf{Kategorie sollte man wissen} gehört,
sonst wird die Rechnerei eher unschön:
Wir schreiben um
\begin{align}
\frac{H_\epsilon(z)}{z} = \frac{z}{(z-\frac{1}{2})(z-1)}
\end{align}
und führen die Partialbruchzerlegung für den rechten Term aus. Wir werden beim letzten Schritt der
Rechnung sehen, warum das elegant ist.
\begin{align}
\frac{H_\epsilon(z)}{z} = \frac{z}{(z-\frac{1}{2})(z-1)} = \frac{A}{z-\frac{1}{2}} + \frac{B}{z-1}
\end{align}
Damit bekommen wir
\begin{align}
&z = \frac{A(z-\frac{1}{2})(z-1)}{z-\frac{1}{2}} + \frac{B (z-\frac{1}{2})(z-1)}{z-1}\\
%&z = A(z-1) + B(z-\frac{1}{2})\\
%&z = A z - A + B z - \frac{1}{2} B \\
&z = (A+B) z - (A + \frac{1}{2}B)
\end{align}
Mit Koeffizientenvergleich erhalten wir $A = -1$ und $B=2$.
% \begin{align}
% 0 = - (A + \frac{1}{2}B)\\
% 1 = A+B\\
% 1-A = B\\
% 0 = - A - \frac{1}{2}(1-A)\\
% 0 = - A - \frac{1}{2}(1-A)\\
% A = - \frac{1}{2} + \frac{1}{2} A\\
% \frac{1}{2}A = -\frac{1}{2}\\
% A = -1
% 1-(-1) = B = 2
% \end{align}
Einsetzen
\begin{align}
\frac{H_\epsilon(z)}{z} = \frac{-1}{z-\frac{1}{2}} + \frac{2}{z-1}
\end{align}
Nun das $z$ der linken Seite wieder auf die rechte Seite bringen
\begin{align}
H_\epsilon(z) = -\frac{z}{z-\frac{1}{2}} + \frac{2 z}{z-1},
\end{align}
weil uns das auf wohlbekannte Korrespondenzen führt (deswegen der 'Trick'),
die wir schon benutzt haben und die in der Formelsammlung stehen:
\begin{align}
H_\epsilon(z) = -\frac{z}{z-\frac{1}{2}} + 2\cdot\frac{z}{z-1}
\quad\Ztransf\quad
h_\epsilon[k] = - \left(\frac{1}{2}\right)^k \epsilon[k] + 2 \epsilon[k]
\end{align}
Erinnern wir uns an die Lösung für $k \geq 0$ im Zeitbereich mit Hilfe der Tabelle
\begin{align}
h_\epsilon[k] = \sum_{k'=0}^k \left(\frac{1}{2}\right)^{k'}
\end{align}
Die beiden Lösungen sind identisch, die Darstellung ohne Summe erscheint
eleganter, zumindest im Kontext der SigSys. Mit geübtem SigSys Blick
sehen wir hier viel schneller was grundlegend passiert: die Sprungantwort
läuft asymptotisch gegen 2, weil der erste Term, also
$(\frac{1}{2})^k \epsilon[k]$, für sehr große $k$ gegen Null geht.
Für kleine $k$ ist dieser Term relevanter, und wir können uns überlegen, dass
es sich um eine Art Aufladevorgang handelt, der bei $1$ startet.

Wir sollten immer versuchen, Summen zu vermeiden, und analytisch geschlossene
Darstellungen finden. Für praktische Systeme ist das nicht immer möglich.
Daher ist es wichtig, dass wir uns in der analytischen Welt gut auskennen, um
Programmcode mit bekannten analytischen Lösungen validieren zu können.
%
Das hier diskutierte Beispiel lässt sich entweder als Rekursion oder in geschlossener
Form mit ein paar Zeilen Code checken, so eine Art \texttt{Hello World} Programm
in der SigSys Welt...das sollten wir mal in Python und/oder Matlab checken.
\end{ExCalc}
\begin{Loesung}
Die Differenzengleichung
\begin{align}
y[k] = x[k] + \frac{1}{2} y[k-1]
\end{align}
ist ein LTI-System und hat die Impuls- und Sprungantwort
\begin{align}
h[k] = \left(\frac{1}{2}\right)^k \epsilon[k]\qquad
h_\epsilon[k] = - \left(\frac{1}{2}\right)^k \epsilon[k] + 2 \epsilon[k].
\end{align}
Die beiden Signale sind unten skizziert. Ähnliche Verläufe hatten wir in
\fig{fig:4408E33353} (3.6) / Aufgabe~\ref{sec:4408E33353} (3.4)
erarbeitet und aus der \fig{fig:bodeplot_examples_pt1_element} (5.4) wissen wir, dass dieses
zeitkontinuierliche System ein Tiefpass 1. Ordnung darstellt.
%
Wir haben hier die Analogie eines einfachen 1-Pol Tiefpasses im zeitdiskreten
Bereich vorliegen. Wir werden den Frequenzgang später diskutieren, wenn
wir die zugehörige Fouriertransformation, das ist die DTFT, kennengelernt haben.
%

\begin{tikzpicture}
\begin{scope}[scale=0.75, xshift=0cm]
\def\tic{0.1};
\draw[help lines, C7!25, step=0.25cm] (-2,0) grid (6,2);
\draw[->] (-1.5,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,0) -- (0,2.5) node[above]{$h[k]$};
\foreach \x in {-1,0,...,6}{\draw (\x,+\tic) -- (\x,-\tic)  node[left]{$\x$};};
\foreach \y in {0,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\foreach \k in {-2,-1}
{
  \draw[stem] plot coordinates
  {
    (\k,{0*\k})
  };
};
\foreach \k in {0,1,...,6}{\draw[stem] plot coordinates{(\k,{(1/2)^\k})};};
\end{scope}
%
%
%
\begin{scope}[scale=0.75, xshift=11cm]
\def\tic{0.1};
\draw[help lines, C7!25, step=0.25cm] (-2,0) grid (6,2);
\draw[->] (-1.5,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,0) -- (0,2.5) node[above]{$h_\epsilon[k]$};
\foreach \x in {-1,0,...,6}{\draw (\x,+\tic) -- (\x,-\tic)  node[left]{$\x$};};
\foreach \y in {0,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\foreach \k in {-2,-1}
{
  \draw[stem] plot coordinates
  {
    (\k,{0*\k})
  };
};
\foreach \k in {0,1,...,6}{\draw[stem] plot coordinates{(\k,{2 - (1/2)^\k})};};
\end{scope}
%
\end{tikzpicture}
%
Wir haben bisher also die Konzepte: PN-Diagramm, Impulsantwort, Sprungantwort,
Faltung vs. Multiplikation wieder entdeckt.
%
Komplexere Systeme, heißt im Grunde wieder 'nur': mehr Polstellen und mehr
Nullstellen. Das Wesen bleibt das Gleiche, was wir hier durchgespielt
haben. Die Rechnerei wird nur deutlich mühsamer und wegen meist 'krummer' Zahlen
auf dem Papier eigentlich nicht mehr sinnvoll handhabbar.

Ein schöne eigenständige Übung, wäre die ganze Rechnerei mal für den allgemein
gegebenen Fall reelles $|a|<1$ (Beschränkung auf stabile Systeme)
\begin{align}
y[k] = x[k] + a y[k-1]
\end{align}
durchzuspielen und zu überlegen, wie die Signalverläufe, PN-Diagramm usw.
variieren. Das ist dann schon ein sehr fancy aufgebohrtes \texttt{Hello World}.

Die Jupyter Notebooks

\texttt{z\_system\_analysis2.ipynb}

\texttt{z\_system\_analysis\_A1D74A9E5B\_94A7A6D9E9.ipynb}

sind u.U. hilfreich.
\end{Loesung}


\newpage
\subsection{Impulsantwort für rekursives System 2. Ordnung über z-Transformation}
\label{sec:94A7A6D9E9}
\begin{Ziel}
Wir erweitern den Aufgabentypus von \ref{sec:A1D74A9E5B} um ein Blockschaltbild
und eine komplexere Differenzengleichung. Wir dürfen also erwarten, dass
die Rechnerei mühsamer wird, das Beispiel ist natürlich wieder so gewählt, dass
es sich in Grenzen hält und schöne Zahlen rauskommen. Das sichere Herauslesen
von Differenzengleichungen und Übertragungsfunktionen aus Bockschaltbildern
ist eins der wichtigsten Werkzeuge in der zeitdiskreten SigSys. Ohne dies
können wir auch keinen Computer sinnvoll programmieren, die Aufgabe numerisch
für uns zu lösen. Es ist das Pendant
zum Aufstellen der Maschen-/Knotengleichungen bei der Analyse eines elektrischen
Netzwerks, um zur Differentialgleichung und daraus dann zur Laplace Transformierten
zu gelangen.
\end{Ziel}
\textbf{Aufgabe} {\tiny 94A7A6D9E9}: Gegeben ist ein zeitdiskretes, rekursives,
kausales LTI-System als Blockschaltbild, also als Signalflussdiagramm.
\begin{center}
\begin{tikzpicture}[thick, scale=0.7]
%\newcommand{\filtDelay}{$z^{-1}$}
\newcommand{\filtDelay}{$\ast_k \delta[k-1]$}
\tikzstyle{filtBlock} = [draw, rectangle, minimum height=2em, minimum width=2em,anchor=center]
\tikzstyle{filtBranch}=[fill,shape=circle,minimum size=4pt,inner sep=0pt,anchor=center]
\tikzstyle{filtSum} = [draw, circle, inner sep=1pt,node distance=0.8cm,anchor=center]
\begin{footnotesize}
\def \bNull {$1$}
\def \bEins {$-1$}
\def \bZwei {$2$}
\def \einsDurchANull {$1$}
\def \minusAEins {$\frac{1}{2}$}
\def \minusAZwei {$-\frac{1}{4}$}

\matrix (m) [matrix of nodes, row sep=1em, column sep=1em]{
\node (input) [anchor=center]{$x[k]$}; & \node (ffsplit0) [filtBranch]{}; & \node (b0) [filtBlock]{\bNull}; & \node (join0) [filtSum]{$+$};
& \node (a0) [filtBlock]{\einsDurchANull}; & \node (fbsplit0) [filtBranch]{}; & \node (output)[anchor=center]{$y[k]$}; \\
& \node [filtBlock](ffdelay1) {\filtDelay}; & & & & \node (fbdelay1)[filtBlock] {\filtDelay};  \\
& \node (ffsplit1) [filtBranch]{}; & \node (b1) [filtBlock]{\bEins}; & \node (join1) [filtSum]{$+$};
& \node (a1) [filtBlock]{\minusAEins}; & \node (fbsplit1) [filtBranch]{}; \\
& \node [filtBlock](ffdelay2) {\filtDelay}; & & & & \node (fbdelay2)[filtBlock] {\filtDelay};  \\
& \node (ffsplit2) [coordinate]{}; & \node (b2) [filtBlock]{\bZwei}; & \node (join2) [filtSum]{$+$};
& \node (a2) [filtBlock]{\minusAZwei}; & \node (fbsplit2) [coordinate]{};  \\
};
%\node [above=of join0] {\Large $\mathcal{H}_1$};

\draw [->] (input) -- (ffsplit0) -- (b0); \draw [->] (b0) -- (join0); \draw [->] (ffsplit0) -- (ffdelay1);
\draw [->] (ffdelay1) -- (ffsplit1) -- (b1); \draw [->] (b1) -- (join1); \draw [->] (join1) -- (join0);
\draw [->] (ffsplit1) -- (b1); \draw [->] (b1) -- (join1); \draw [->] (ffsplit1) -- (ffdelay2); \draw[->] (ffdelay2) -- (ffsplit2) -- (b2);
\draw [->] (b2) -- (join2); \draw [->] (join2) -- (join1);
\draw [->] (join0) -- (a0); \draw [->] (a0) -- (fbsplit0) -- (output);
\draw [->] (fbsplit0) -- (fbdelay1); \draw[->] (fbdelay1) -- (fbsplit1) -- (a1);
\draw [->] (a1) -- (join1);
\draw [->] (fbsplit1) -- (fbdelay2); \draw[->] (fbdelay2) -- (fbsplit2) -- (a2);
\draw [->] (a2) -- (join2);
\end{footnotesize}
\end{tikzpicture}
\end{center}

Das System soll sich zu $k=0$ in Ruhe befinden, d.h. alle Zustandsspeicher
sind initial Null.

\begin{itemize}
\item[a)] Geben Sie die Differenzengleichung an
\item[b)] Skizzieren Sie das Blockschaltbild im $z$-Bereich
\item[c)] Geben Sie die Übertragungsfunktion $H(z)=\frac{Y(z)}{X(z)}$
\item[d)] Skizzieren sie das Pol-Nullstellen Diagramm mit Konvergenzbereich
\item[e)] Geben Sie die Impulsantwort $h[k]$ geschlossen analytisch an
\end{itemize}

\begin{Werkzeug}
wie zuvor, jetzt neu: Blockschaltbild-Lesen
\end{Werkzeug}
%\begin{Ansatz}
%\end{Ansatz}
%\begin{ExCalc}
%\end{ExCalc}
\begin{Loesung}
\textbf{zuerst b) Blockschaltbild}
mit $x[k] \ast_k \delta[k-1] \ztransf X(z) \cdot z^{-1}$ und Linearität
können wir skizzieren:
\begin{center}
\begin{tikzpicture}[thick, scale=0.7]
\newcommand{\filtDelay}{$z^{-1}$}
%\newcommand{\filtDelay}{$\ast_k \delta[k-1]$}
\tikzstyle{filtBlock} = [draw, rectangle, minimum height=2em, minimum width=2em,anchor=center]
\tikzstyle{filtBranch}=[fill,shape=circle,minimum size=4pt,inner sep=0pt,anchor=center]
\tikzstyle{filtSum} = [draw, circle, inner sep=1pt,node distance=0.8cm,anchor=center]
\begin{footnotesize}
\def \bNull {$1$}
\def \bEins {$-1$}
\def \bZwei {$2$}
\def \einsDurchANull {$1$}
\def \minusAEins {$\frac{1}{2}$}
\def \minusAZwei {$-\frac{1}{4}$}

\matrix (m) [matrix of nodes, row sep=1em, column sep=1em]{
\node (input) [anchor=center]{$X(z)$}; & \node (ffsplit0) [filtBranch]{}; & \node (b0) [filtBlock]{\bNull}; & \node (join0) [filtSum]{$+$};
& \node (a0) [filtBlock]{\einsDurchANull}; & \node (fbsplit0) [filtBranch]{}; & \node (output)[anchor=center]{$Y(z)$}; \\
& \node [filtBlock](ffdelay1) {\filtDelay}; & & & & \node (fbdelay1)[filtBlock] {\filtDelay};  \\
& \node (ffsplit1) [filtBranch]{}; & \node (b1) [filtBlock]{\bEins}; & \node (join1) [filtSum]{$+$};
& \node (a1) [filtBlock]{\minusAEins}; & \node (fbsplit1) [filtBranch]{}; \\
& \node [filtBlock](ffdelay2) {\filtDelay}; & & & & \node (fbdelay2)[filtBlock] {\filtDelay};  \\
& \node (ffsplit2) [coordinate]{}; & \node (b2) [filtBlock]{\bZwei}; & \node (join2) [filtSum]{$+$};
& \node (a2) [filtBlock]{\minusAZwei}; & \node (fbsplit2) [coordinate]{};  \\
};
%\node [above=of join0] {\Large $\mathcal{H}_1$};

\draw [->] (input) -- (ffsplit0) -- (b0); \draw [->] (b0) -- (join0); \draw [->] (ffsplit0) -- (ffdelay1);
\draw [->] (ffdelay1) -- (ffsplit1) -- (b1); \draw [->] (b1) -- (join1); \draw [->] (join1) -- (join0);
\draw [->] (ffsplit1) -- (b1); \draw [->] (b1) -- (join1); \draw [->] (ffsplit1) -- (ffdelay2); \draw[->] (ffdelay2) -- (ffsplit2) -- (b2);
\draw [->] (b2) -- (join2); \draw [->] (join2) -- (join1);
\draw [->] (join0) -- (a0); \draw [->] (a0) -- (fbsplit0) -- (output);
\draw [->] (fbsplit0) -- (fbdelay1); \draw[->] (fbdelay1) -- (fbsplit1) -- (a1);
\draw [->] (a1) -- (join1);
\draw [->] (fbsplit1) -- (fbdelay2); \draw[->] (fbdelay2) -- (fbsplit2) -- (a2);
\draw [->] (a2) -- (join2);
\end{footnotesize}
\end{tikzpicture}
\end{center}
\textbf{Hinweis}: in der SigSys-Literatur ist es üblich Elemente aus Zeit- und Bildbereich
zu mischen, also z.B. $z^{-1}$ im Blockschaltbild des Zeitbereichs zu verwenden,
obwohl es da streng genommen nichts zu suchen hat. Das Bild sieht etwas
übersichtlicher aus, als das der Aufgabenstellung, daher wird die diese Konvention
gerne gewählt, also:
\begin{center}
\begin{tikzpicture}[thick, scale=0.7]
\newcommand{\filtDelay}{$z^{-1}$}
%\newcommand{\filtDelay}{$\ast_k \delta[k-1]$}
\tikzstyle{filtBlock} = [draw, rectangle, minimum height=2em, minimum width=2em,anchor=center]
\tikzstyle{filtBranch}=[fill,shape=circle,minimum size=4pt,inner sep=0pt,anchor=center]
\tikzstyle{filtSum} = [draw, circle, inner sep=1pt,node distance=0.8cm,anchor=center]
\begin{footnotesize}
\def \bNull {$1$}
\def \bEins {$-1$}
\def \bZwei {$2$}
\def \einsDurchANull {$1$}
\def \minusAEins {$\frac{1}{2}$}
\def \minusAZwei {$-\frac{1}{4}$}

\matrix (m) [matrix of nodes, row sep=1em, column sep=1em]{
\node (input) [anchor=center]{$x[k]$}; & \node (ffsplit0) [filtBranch]{}; & \node (b0) [filtBlock]{\bNull}; & \node (join0) [filtSum]{$+$};
& \node (a0) [filtBlock]{\einsDurchANull}; & \node (fbsplit0) [filtBranch]{}; & \node (output)[anchor=center]{$y[k]$}; \\
& \node [filtBlock](ffdelay1) {\filtDelay}; & & & & \node (fbdelay1)[filtBlock] {\filtDelay};  \\
& \node (ffsplit1) [filtBranch]{}; & \node (b1) [filtBlock]{\bEins}; & \node (join1) [filtSum]{$+$};
& \node (a1) [filtBlock]{\minusAEins}; & \node (fbsplit1) [filtBranch]{}; \\
& \node [filtBlock](ffdelay2) {\filtDelay}; & & & & \node (fbdelay2)[filtBlock] {\filtDelay};  \\
& \node (ffsplit2) [coordinate]{}; & \node (b2) [filtBlock]{\bZwei}; & \node (join2) [filtSum]{$+$};
& \node (a2) [filtBlock]{\minusAZwei}; & \node (fbsplit2) [coordinate]{};  \\
};
%\node [above=of join0] {\Large $\mathcal{H}_1$};

\draw [->] (input) -- (ffsplit0) -- (b0); \draw [->] (b0) -- (join0); \draw [->] (ffsplit0) -- (ffdelay1);
\draw [->] (ffdelay1) -- (ffsplit1) -- (b1); \draw [->] (b1) -- (join1); \draw [->] (join1) -- (join0);
\draw [->] (ffsplit1) -- (b1); \draw [->] (b1) -- (join1); \draw [->] (ffsplit1) -- (ffdelay2); \draw[->] (ffdelay2) -- (ffsplit2) -- (b2);
\draw [->] (b2) -- (join2); \draw [->] (join2) -- (join1);
\draw [->] (join0) -- (a0); \draw [->] (a0) -- (fbsplit0) -- (output);
\draw [->] (fbsplit0) -- (fbdelay1); \draw[->] (fbdelay1) -- (fbsplit1) -- (a1);
\draw [->] (a1) -- (join1);
\draw [->] (fbsplit1) -- (fbdelay2); \draw[->] (fbdelay2) -- (fbsplit2) -- (a2);
\draw [->] (a2) -- (join2);
\end{footnotesize}
\end{tikzpicture}
\end{center}
Wahlweise könnten wir auch mit dem Abtastintervall $T_s$ arbeiten und einen
Block definieren, der genau um ein Sample verzögert, also:
\begin{center}
\begin{tikzpicture}[thick, scale=0.7]
%\newcommand{\filtDelay}{$z^{-1}$}
\newcommand{\filtDelay}{$T_s$}
\tikzstyle{filtBlock} = [draw, rectangle, minimum height=2em, minimum width=2em,anchor=center]
\tikzstyle{filtBranch}=[fill,shape=circle,minimum size=4pt,inner sep=0pt,anchor=center]
\tikzstyle{filtSum} = [draw, circle, inner sep=1pt,node distance=0.8cm,anchor=center]
\begin{footnotesize}
\def \bNull {$1$}
\def \bEins {$-1$}
\def \bZwei {$2$}
\def \einsDurchANull {$1$}
\def \minusAEins {$\frac{1}{2}$}
\def \minusAZwei {$-\frac{1}{4}$}

\matrix (m) [matrix of nodes, row sep=1em, column sep=1em]{
\node (input) [anchor=center]{$x[k]$}; & \node (ffsplit0) [filtBranch]{}; & \node (b0) [filtBlock]{\bNull}; & \node (join0) [filtSum]{$+$};
& \node (a0) [filtBlock]{\einsDurchANull}; & \node (fbsplit0) [filtBranch]{}; & \node (output)[anchor=center]{$y[k]$}; \\
& \node [filtBlock](ffdelay1) {\filtDelay}; & & & & \node (fbdelay1)[filtBlock] {\filtDelay};  \\
& \node (ffsplit1) [filtBranch]{}; & \node (b1) [filtBlock]{\bEins}; & \node (join1) [filtSum]{$+$};
& \node (a1) [filtBlock]{\minusAEins}; & \node (fbsplit1) [filtBranch]{}; \\
& \node [filtBlock](ffdelay2) {\filtDelay}; & & & & \node (fbdelay2)[filtBlock] {\filtDelay};  \\
& \node (ffsplit2) [coordinate]{}; & \node (b2) [filtBlock]{\bZwei}; & \node (join2) [filtSum]{$+$};
& \node (a2) [filtBlock]{\minusAZwei}; & \node (fbsplit2) [coordinate]{};  \\
};
%\node [above=of join0] {\Large $\mathcal{H}_1$};

\draw [->] (input) -- (ffsplit0) -- (b0); \draw [->] (b0) -- (join0); \draw [->] (ffsplit0) -- (ffdelay1);
\draw [->] (ffdelay1) -- (ffsplit1) -- (b1); \draw [->] (b1) -- (join1); \draw [->] (join1) -- (join0);
\draw [->] (ffsplit1) -- (b1); \draw [->] (b1) -- (join1); \draw [->] (ffsplit1) -- (ffdelay2); \draw[->] (ffdelay2) -- (ffsplit2) -- (b2);
\draw [->] (b2) -- (join2); \draw [->] (join2) -- (join1);
\draw [->] (join0) -- (a0); \draw [->] (a0) -- (fbsplit0) -- (output);
\draw [->] (fbsplit0) -- (fbdelay1); \draw[->] (fbdelay1) -- (fbsplit1) -- (a1);
\draw [->] (a1) -- (join1);
\draw [->] (fbsplit1) -- (fbdelay2); \draw[->] (fbdelay2) -- (fbsplit2) -- (a2);
\draw [->] (a2) -- (join2);
\end{footnotesize}
\end{tikzpicture}
\end{center}
Das setzt dann aber voraus, das wir einen Zeitbezug herstellen, was wir
bei Folgen aber gar nicht unbedingt machen müssten. Die ersten beiden von den
vier gezeigten Signalflussgraphen sind daher die technisch saubersten,
das dritte mutmaßlich die am häufigsten benutzte Darstellung.
%
In der Literatur wird der Terminus rekursives System, was wir hier aufgrund
der Rückkopplung vorliegen haben, gleichgesetzt mit der Begrifflichkeit
des \textbf{infinite impulse response (IIR) filter}, also ein Filter
mit unendlicher Impulsantwort. Dies deswegen, weil rekursiv allermeist
(aber eben nicht immer!) heisst, dass das System unendlich lange ausschwingt.


\noindent\textbf{a) Differenzengleichung}
\begin{align}
y[k] &= x[k] - x[k-1] + 2x[k-2] + \frac{1}{2}y[k-1] - \frac{1}{4}y[k-2] \\
y[k] - \frac{1}{2}y[k-1] + \frac{1}{4}y[k-2] &= x[k] - x[k-1] + 2x[k-2]
\end{align}
Wir sollten zunächst alle Pfade, die von $x[k]$ ausgehen zu $y[k]$ einzeln
verfolgen und vielleicht farbig markieren. Dann haben wir schonmal den
nichtrekursiven Teil des Systems erfasst. Die nun noch nicht berücksichtigten
Pfade, die noch nicht bunt markiert sind, gehören zum rekursiven Teil
des Systems, d.h. hier wird der Ausgang verzögert rückgekoppelt.

\noindent\textbf{c) Übertragungsfunktion}
\begin{align}
\mathcal{Z}\{y[k] - \frac{1}{2}y[k-1] + \frac{1}{4}y[k-2]\} &= \mathcal{Z}\{x[k] - x[k-1] + 2x[k-2]\} \\
Y(z) - \frac{1}{2}z^{-1}Y(z) + \frac{1}{4}z^{-2}Y(z) &= X(z) - z^{-1}X(z) + 2z^{-2}X(z) \\
\left(1 - \frac{1}{2}z^{-1} + \frac{1}{4}z^{-2}\right)Y(z) &= \left(1 - z^{-1} + 2z^{-2}\right)X(z) \\
H(z) = \frac{Y(z)}{X(z)} &= \frac{1 - z^{-1} + 2z^{-2}}{1 - \frac{1}{2}z^{-1} + \frac{1}{4}z^{-2}}
= \frac{z^2 - z + 2}{z^2 - \frac{1}{2}z + \frac{1}{4}}
\end{align}

\noindent\textbf{d) Pol-Nullstellen-Diagramm}
Pol- und Nullstellen:
\begin{align}
z_{0,1,2} &= \frac{1}{2} \pm \frac{\sqrt{7}}{2}\im = \sqrt{2} \e^{\pm \im \mathrm{atan}(\sqrt{7})} \approx \sqrt{2} \e^{\pm \im 69.3^\circ}\qquad
z_{\infty,1,2} &= \frac{1}{4} \pm \frac{\sqrt{3}}{4}\im = \frac{1}{2}\e^{\pm \im \frac{\pi}{3}} = \frac{1}{2}\e^{\pm \im 60^\circ}
\end{align}
Konvergenzbereich: für kausales System ist der KB außerhalb des Kreises mit dem Radius
der betragsmäßig größten Polstelle, also
\begin{align}
\text{KB: } |z| > |z_{\infty,1,2}| = \frac{1}{2}
\end{align}
%
Darstellung in Pol-/ Nullstellen/Verstärkungsfaktor-Form zum Malen des PN-Bilds:
\begin{align}
H(z) = \frac{z^2 - z + 2}{z^2 - \frac{1}{2}z + \frac{1}{4}}
= 1 \cdot \frac
{(z-\sqrt{2} \e^{+\im \mathrm{atan}(\sqrt{7})}) \cdot (z-\sqrt{2} \e^{-\im \mathrm{atan}(\sqrt{7})})}
{(z-\frac{1}{2}\e^{+\im \frac{\pi}{3}}) \cdot (z-\frac{1}{2}\e^{-\im \frac{\pi}{3}})}
\end{align}
%
Darstellung für Matlab / Python (hier kann man die Koeffizienten $b_m$, $a_n$ direkt
herauslesen):
\begin{align}
H(z) = \frac{1 z^0 - 1 z^{-1} + 2 z^{-2}}{1 z^0 - \frac{1}{2} z^{-1} + \frac{1}{4} z^{-2}}
\end{align}
\begin{verbatim}
% e.g. check in Matlab
b = [1 -1 2] % numerator coefficients
a = [1 -1/2 1/4] % denominator coefficients
h = impz(b,a) % get impulse response
zplane(b,a) % plot pole/zero plot
\end{verbatim}

\begin{center}
\begin{tikzpicture}[scale=1.5]
\def \tic {0.05}
%\def \zR{0.05}
\filldraw[even odd rule,C2!50] (0,0) circle(0.5)
decorate [decoration={snake,segment length=15pt,amplitude=1pt}]{(0,-3pt) circle(1.6)};
\draw[help lines, C7!50, step=0.25cm] (-1.5,-1.5) grid (1.5,1.5);
\draw (0,0) circle(1);
\draw (1+2*\tic,-2*\tic) node{$1$}; % indicate that this is the unit circle
\node at (1, 1){$g=1$};
\draw[->] (-1.8,0)--(1.9,0) node[right]{$\Re\{z\}$};
\draw[->] (0,-1.8)--(0,1.8) node[above]{$\Im\{z\}$};
\node[C0] at (0.25,+0.43301270189){\Huge $\times$};
\node[C0] at (0.25,-0.43301270189){\Huge $\times$};
\node[C0] at (0.5,+1.3228756555){\Huge $\circ$};
\node[C0] at (0.5,-1.3228756555){\Huge $\circ$};
\node at (0,+0.43301270189)[left]{\tiny$\frac{\sqrt{3}}{4}$};
\node at (0,-0.43301270189)[left]{\tiny$\frac{-\sqrt{3}}{4}$};
\node at (0,+1.3228756555)[left]{\tiny$\frac{\sqrt{7}}{2}$};
\node at (0,-1.3228756555)[left]{\tiny$\frac{-\sqrt{7}}{2}$};
\node at (0.25,0)[below]{\tiny$\frac{1}{4}$};
\node at (0.5,0)[below]{\tiny$\frac{1}{2}$};
\end{tikzpicture}
\end{center}
\textbf{e) Impulsantwort mittels Partialbruchzerlegung} wieder mit dem $1/z$-'Trick'.
Wir haben hier ein konjugiert-komplexes Polpaar, daher benötigen wir den
Ansatz
%
\begin{align}
H(z) =& \frac{z^2 - z + 2}{z^2 - \frac{1}{2}z + \frac{1}{4}}\\
\frac{H(z)}{z} =& \frac{z^2 - z +2}{z(z^2-\frac{1}{2}z +\frac{1}{4})} =
\frac{A}{z} + \frac{Bz+C}{z^2-\frac{1}{2}z +\frac{1}{4}}\\
\rightarrow z^2 - z +2 &= A(z^2-\frac{1}{2}z +\frac{1}{4}) + Bz^2 + Cz
\end{align}
Koeffizientenvergleich
\begin{align}
z^2 - z +2 =& A z^2 -\frac{1}{2}A z +\frac{1}{4}A + B z^2 + Cz\\
z^2:\quad& 1 = A + B\\
z^1:\quad& -1 = -\frac{1}{2}A + C\\
z^0:\quad& 2 = \frac{1}{4}A
\end{align}
bringt
\begin{align}
A = 8\quad B=-7\quad C=3
\end{align}
Einsetzen
\begin{align}
\frac{H(z)}{z} = \frac{8}{z} + \frac{-7 z + 3 }{z^2-\frac{1}{2}z +\frac{1}{4}}
\end{align}
$1/z$ von links wieder nach rechts bringen, also 'Trick' rückgängig machen
\begin{align}
H(z) = 8 + \frac{-7 z^2 + 3 z}{z^2-\frac{1}{2}z +\frac{1}{4}}
\end{align}
Hier jetzt kurz innehalten (in der Klausur ein guter Zeitpunkt die bisherige
Rechnung nochmal gegenzuchecken, $z$ und $2$ sind \textbf{handschriftlich schnell mal
verwechselt} und Bruchrechnung neu falsch erfinden, gilt es auch zu
vermeiden):
Wir könnten mittlerweile eine Erwartungshaltung entwickeln, aus welchen Einzeltermen
die Impulsantwort aufgebaut sein wird/muss. Bei der einzelnen 8 ist der gewichtete
Dirac Impuls direkt ersichtlich, bei dem Bruch wird es per Auge schwieriger.
Aber: wir haben einen konjugiert-komplexen Pol. Wir haben vorher in dieser Übung
angeschaut, was für Zeitsignale dafür korrespondieren.
Wir können daher erwarten, dass wir eine gedämpfte cos und/oder sin-Schwingung
als Rücktransformation bekommen, das System kann uns mit diesem Polpaar gar nichts
anderes anbieten. In der (englischsprachigen und länglichen) Übungsaufgabe
zum zeitkontinuierlichen Tiefpasssystem 2. Ordnung mittels Laplace Transformation
(\texttt{laplace\_transform\_839973EF5D})
war das ganz genauso.

Wir müssen also die gebrochen rationale Funktion so umformen, dass wir in
die gedämpfte cos und/oder sin-Folge
\begin{align}
r^k \cos(\Omega_0 k)\epsilon[k] \ztransf \frac{z^2 -(r\cos\Omega_0)z}{z^2 -(2r\cos\Omega_0)z + r^2}\\
r^k \sin(\Omega_0 k)\epsilon[k] \ztransf \frac{(r\sin\Omega_0)z}{z^2 -(2r\cos\Omega_0)z + r^2}
\end{align}
zerlegen können. Das war SigSys-Erwartungshaltung, jetzt wieder stumpf ausrechnen:
Fangen wir mit dem Nenner an, der ist ja für sin/cos gleich
\begin{align}
H(z) = 8 - 7\cdot\frac{z^2-\frac{3}{7}z}{z^2-(2r\cos\Omega_0)z +r^2},
\end{align}
mit $r = \frac{1}{2}$, $r^2=\frac{1}{4}$ und $\Omega_0 = \frac{\pi}{3}$ (deswegen
die Polardarstellung von $z_{\infty,1,2}$ oben beim PN-Diagramm),
$\cos(\Omega_0)=\frac{1}{2}$.
%
Jetzt kommt ein weiterer Klassiker bei der Umformung: wir müssen so erweitern,
damit wir zwei Brüche auseinander ziehen können, die dann jeweils den cos() und sin()
darstellen. Wir führen also im Zähler $-(r\cos\Omega_0)z + (r\cos\Omega_0)z$
ein und verteilen das dann sinnvoll
\begin{align}
H(z) = 8 -7\bigg(\underbrace{\frac{z^2-(r\cos\Omega_0)z}{z^2-(2r\cos\Omega_0)z +r^2}}_{\Ztransf \quad r^k \cos[\Omega_0 k]\epsilon[k]}
\quad + \quad \frac{-\frac{3}{7}z+(r\cos\Omega_0)z}{z^2-(2r\cos\Omega_0)z +r^2}\bigg)
\end{align}
dann ist der linke Bruch schon direkt zurücktransformierbar zum cos.
Jetzt erweitern wir mit $\frac{r\sin\Omega_0}{r\sin\Omega_0}$, weil wir dann
umstellen können zu
\begin{align}
H(z) = 8 -7\bigg(\frac{z^2-(r\cos\Omega_0)z}{z^2-(2r\cos\Omega_0)z +r^2}
\quad -\quad  \frac{\frac{3}{7}-r\cos\Omega_0}{r\sin\Omega_0}
\cdot \underbrace{\frac{(r\sin\Omega_0)z}{z^2-(2r\cos\Omega_0)z +r^2}}_{\Ztransf \quad r^k \sin[\Omega_0 k]\epsilon[k]}\bigg)
\end{align}
also im rechten Bruch den sin() bekommen.
Nun können wir zurücktransformieren. Wir brauchen noch $\sin(\Omega_0) = \frac{\sqrt{3}}{2}$
und sollten den Vorfaktor vorm sin() schonmal ausfüllen
\begin{align}
\frac{\frac{3}{7}-r\cos\Omega_0}{r\sin\Omega_0} = \frac{\frac{3}{7}-\frac{1}{4}}{\frac{\sqrt{3}}{4}}
\end{align}
Damit erhalten wir
\begin{align*}
h[k] =& 8\delta[k] -7\left(
\left(\frac{1}{2}\right)^k \cos(\frac{\pi}{3} k) \epsilon[k]
-
\frac{\frac{3}{7} - \frac{1}{4}}{\frac{\sqrt{3}}{4}}
\cdot \left(\frac{1}{2}\right)^k \sin(\frac{\pi}{3} k) \epsilon[k] \right) \\
=& 8\delta[k] \, + \, \frac{1}{2^k}
\left( -7\cos(\frac{\pi}{3} k) + \frac{5}{\sqrt{3}} \sin(\frac{\pi}{3} k)\right)
\epsilon[k]
\end{align*}
Mühsam, nicht? Aber ein Klassiker des Ingenieurshandwerks:
wir haben eine Erwartungshaltung (konjugiert-komplexe Polstelle muss gedämpft
sin/cos im Zeitbereich ergeben) und versuchen uns dahin zu rechnen.
%
Es ist die gleiche Idee, wie zeitkontinuierlich: Systeme 2. Ordnung
(also 2 Pole, 2 Nullstellen) sind gerade noch schön zu Papier zu bringen
und die Impulsantwort kann eigentlich nur aus gedämpften sin()/cos() oder
einfach gedämpften
Verläufen bestehen. Falls wir Pol/Nullstellen-Winkel haben, welche gute Teiler zu
$2\pi$ darstellen, sind die cos()/sin()-Werte dann auch noch schöne Brüche. Ansonsten
endet es in krummen Zahlen, was für eine Klausuraufgabe nie intendiert ist!

Daher zerlegen wir zur besseren Übersichtlichkeit und
Interpretation Systeme höherer Ordnung auch wieder
in Systeme 2. Ordnung (englisch sogenannte second order sections, SOSs oder auch
biquads),
entweder als Reihen- oder Parallelschaltung.

Die numerische Lösung mittels Tabelle könnten wir wie folgt angehen:
\begin{center}
\begin{tabular}{|| c | c | c | c | c | c | c ||}
\hline
DGL Koeff & $\cdot 1$ & $\cdot-1$ & $\cdot2$ & $\cdot1$ & $\cdot\nicefrac{1}{2}$ & $\cdot-\nicefrac{1}{4}$ \\
\hline
$k$ & $x[k]$ & $x[k-1]$ & $x[k-2]$ & $y[k]$ & $y[k-1]$ & $y[k-2]$ \\
\hline\hline
$k$ & $x[k]=\delta[k]$ & $x[k-1]$ & $x[k-2]$ & $y[k]$ & $y[k-1]$ & $y[k-2]$ \\
\hline
0 & 1  & 0 & 0 & \qquad 1 $\searrow$ & 0 & 0  \\\hline
1 & 0 & 1  & 0 & $-\nicefrac{1}{2}$ & \qquad 1 $\searrow$ & 0  \\\hline
2 & 0 & 0 & 1 & $+\nicefrac{3}{2}$ & $-\nicefrac{1}{2}$ & 1  \\\hline
3 & 0 & 0 & 0 & $+\nicefrac{7}{8}$ & $+\nicefrac{3}{2}$ & $-\nicefrac{1}{2}$   \\\hline
: & : & :& :& :& :& :\\\hline
\end{tabular}
\end{center}
Wie oben schon angedeutet, bis auf die Algorithmik ist es eigentlich nicht wirklich
erhellend. Hin und wieder ist dies aber eine sinnvolle Methode um for-Schleifen
basierten Programmcode zu validieren, gerade wenn eine analytische Lösung bekannt
ist mit der wir vergleichen können.
Vgl. \texttt{z\_system\_analysis\_A1D74A9E5B\_94A7A6D9E9.ipynb}
\end{Loesung}

\begin{figure}
\includegraphics[width=\textwidth]{../z_system_analysis/system_94A7A6D9E9.pdf}
\caption{LTI-System Diskussion für Aufgabe \ref{sec:94A7A6D9E9}.
Oben rechts: Impulsantwort, mittig rechts: Sprungantwort,
unten rechts: PN-Diagramm. So wie bei der Laplace
Transformation können wir auch mittels des Frequenzgangs viele Systemeigenschaften
interpretieren, das werden wir in den nächsten Einheiten kennenlernen, also
speziell Pegel (oben links), Phase (mittig links), Gruppenlaufzeit
(unten links) über normierte Achsen der digitalen Kreisfrequenz $\Omega$.
%
\texttt{z\_system\_analysis.ipynb}
}
\label{fig:94A7A6D9E9}
\end{figure}
