\clearpage
\section{UE 8: Zeitdiskrete Signale, Beschreibung diskreter Systeme im Zeitbereich}
\label{sec:ue8_dt_systems_intro_conv}
%
In der zeitdiskreten Signal- und Systemtheorie haben wir mit Signalen zu tun,
die wir in der Mathematik als Folgen bezeichnet werden. Es gibt Folgen, die wir analytisch
als Formeln darstellen können.
Ein einfaches Beispiel wäre die Folge bestehend aus ganz bestimmten Cosinuswerten
\begin{align}
x[k] = \cos(\Omega_0 \cdot k)\quad\text{für}\quad k\in\mathbb{Z},\,\Omega_0\in\mathbb{R}.
\end{align}
Wir benutzen zur Kenntlichmachung von Folgen / von zeitdiskreten Signalen eckige
Klammern $x[k]$ und konsistent $k$ als Folgenindex, der daher $k\in\mathbb{Z}$ ist. Dies ist eine sehr SigSys-typische Schreibweise, der viele Bücher folgen.
%
Die obige Folge könnte aus einem zeitlichen Abtastprozess (englisch \textit{sampling})
entstanden sein. Mit dem
\textbf{Abtastintervall / Abtasttakt} $T_s$ werden zu den Zeitpunkten $t = k \cdot T_s$
die Signalwerte $x(t = k \cdot T_s)$ eines zeitkontinuierlichen Signals $x(t) = \cos(\omega_0 t)$
der Folge $x[k]$ zugewiesen, als
\begin{align}
x[k] := x(k T_s) = \cos(\omega_0 T_s k).
\end{align}

%
\begin{figure*}[h]
\centering
\begin{subfigure}{\textwidth}
\centering
\begin{tikzpicture}[scale=0.9]
\def\tic{0.1};
\def\Om{360/8}
\draw[help lines, C7!25, step=1cm] (0,-1) grid (7,1);
\draw[->] (-1.5,0) -- (9,0) node[right]{$k$};
\draw[->] (0,-1) -- (0,2) node[left]{$x[k]=\cos(\frac{2\pi}{8}k)$};
\foreach \x in {-1,0,...,8}{\draw (\x,+\tic) -- (\x,-\tic)  node[left]{$\x$};};
\foreach \y in {-1,1}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\foreach \k in {-1,0,...,8}{\draw[stem2] plot coordinates{(\k,{cos(\Om*\k)})};};
\foreach \k in {-1,8}{\draw[stem2, C3] plot coordinates{(\k,{cos(\Om*\k)})};};
\end{tikzpicture}
\caption{$N=8\in\mathbb{Z}$, daher periodisch in 8 Signalwerten / 8 Folgengliedern,
Periode in blau.}
\label{fig:cos8}
\end{subfigure}
%
\begin{subfigure}{\textwidth}
\centering
\begin{tikzpicture}[scale=0.9]
\def\tic{0.1};
\def\Om{360/8.5}
\draw[->] (-1.5,0) -- (9,0) node[right]{$k$};
\draw[->] (0,-1) -- (0,2) node[left]{$x[k]=\cos(\frac{2\pi}{8.5}k)$};
\foreach \x in {-1,0,...,8}{\draw (\x,+\tic) -- (\x,-\tic)  node[left]{$\x$};};
\foreach \y in {-1,1}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\foreach \k in {-1,0,...,8}{\draw[stem2,C1] plot coordinates{(\k,{cos(\Om*\k)})};};
\end{tikzpicture}
\caption{$N=8.5\notin\mathbb{Z}$, daher \textbf{nicht} periodisch in $N$.
Aber periodisch in $2 N = 17$.}
\label{fig:cos8.5}
\end{subfigure}
%
%
%
\begin{subfigure}{\textwidth}
\centering
\begin{tikzpicture}[scale=0.9]
\def\tic{0.1};
\def\Om{360/9}
\draw[help lines, C7!25, step=1cm] (0,-1) grid (8,1);
\draw[->] (-1.5,0) -- (9,0) node[right]{$k$};
\draw[->] (0,-1) -- (0,2) node[left]{$x[k]=\cos(\frac{2\pi}{9}k)$};
\foreach \x in {-1,0,...,9}{\draw (\x,+\tic) -- (\x,-\tic)  node[left]{$\x$};};
\foreach \y in {-1,1}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\foreach \k in {-1,0,...,9}{\draw[stem2] plot coordinates{(\k,{cos(\Om*\k)})};};
\foreach \k in {-1,9}{\draw[stem2, C3] plot coordinates{(\k,{cos(\Om*\k)})};};
\end{tikzpicture}
\caption{$N=9\in\mathbb{Z}$, daher periodisch in 9 Werten, Periode in blau.}
\label{fig:cos9}
\end{subfigure}
\caption{Cosinusfolgen mit $\Omega_0=\frac{2\pi}{N}$ für $N=8,\,8.5$ und $9$ über
\textit{Sample}-Index $k$ (z.B. entlang diskreter Zeitpunkte) als
sogenannter Stem-Plot (\textit{stem} [englisch] - Stiel, Halm, Stängel [deutsch]).}
\label{fig:Cosinusfolgen}
\end{figure*}
%
Wir können mit der \textbf{Samplingfrequenz / Abtastfrequenz} in Hertz
\begin{align}
f_s=\frac{1}{T_s}
\end{align}
die Umformungen
\begin{align}
\Omega = \omega T_s = \frac{\omega}{f_s} = \frac{2\pi f}{f_s}
\end{align}
zusammentragen. Die Variable $\Omega$ ist als \textbf{digitale, zeitdiskrete oder auch
normierte Kreisfrequenz} bekannt, wir werden sie sehr häufig benutzen.
%
Die Abtastfrequenz $f_s$ bildet sich gemäß Formel auf $\Omega_s = 2 \pi$ ab
(d.h. 360 Grad in einer Kreisdarstellung), die
halbe Abstastfrequenz $\frac{f_s}{2}$ konsistent auf $\Omega=\frac{\Omega_s}{2}=\pi$
(180 Grad auf einem Kreis).


In \fig{fig:Cosinusfolgen} sind drei Cosinusfolgen für verschiedene
$\Omega_0=\frac{2\pi}{N}$ skizziert.
%
Nur für $N\in\mathbb{N}$ ist eine Folge periodisch in $N$, also
im Beispiel $N=8$ und $N=9$. Die Wahl $N=8.5$ führt zu einer nichtperiodischen
Cosinusfolge, d.h. der Cosinus schwingt zwar munter vor sich hin, wir haben
ausreichend Signalwerte, um das sogar grafisch zu sehen, aber wir
können die exakte Periode bzgl. des Signalindex $k$ nicht ganzzahlig angeben,
zumindest nicht in $N$. Weiter unten werden wir sehen, dass es Folgen gibt,
die für $N=\frac{M}{K}$, $M$-periodisch sind, falls $M$ und $K$ ganzzahlig.

\subsection*{Analogien zeitkontinuierlich / zeitdiskret}
%
Wir haben die wesentlichen Werkzeuge für die zeitkontinuierlichen Vorgänge
kennengelernt. Diese Konzepte haben alle Analogien in der zeitdiskreten Welt,
siehe Tabelle \ref{tbl:Analogien_CT_DT}.
%
Wenn wir also das entsprechende Werkzeug und dessen Wesen zeitkontinuierlich
verstanden haben,
wird uns die Anpassung an zeitdiskrete Vorgänge vergleichsweise wenig Mühe
bereiten. Erfahrungsgemäß gestalten sich die zeitdiskreten Vorgänge praktisch
ein wenig zugänglicher, weil wir viel näher an der numerischen Auswertung
mit Computerhilfe sind.
%
Das Probieren und Testen mit kleinen eigenen Signalverarbeitungsprogrammen
ist mutmaßlich einladender, als symbolische Computeralgebra oder
manuelles Rechnen zu betreiben.
%
Jedoch sollten wir uns klarmachen, dass wir viel mehr Probleme geschlossen analytisch
in der zeitkontinuierlichen SigSys durchdringen können, als es bei zeitdiskreter
SigSys der Fall ist.
%
Es gibt deutlich mehr analytische Lösungen von Integralen als von
Summen.
%
Summen sind aber erfahrungsgemäß am Anfang des Studiums beliebter als
Integrale, obwohl Summen mathematisch mehr Stress bedeuten.
%
Wir werden (hoffentlich) in SigSys beide Welten zu schätzen wissen.
%
%
\begin{table}[t]
\begin{center}
\begin{tabular}{ | c | c | }
\hline
zeitkontinuierliche LTI SigSys & zeitdiskrete LTI SigSys\\\hline
Differentialgleichung & Differenzengleichung \\
Eingangssignal $x(t)$ & Eingangsfolge $x[k]$ \\
Ausgangssignal $y(t)$ & Ausgangsfolge $y[k]$ \\
Impulsantwort $h(t)$ & Impulsantwort $h[k]$ \\
Sprungantwort $h_\epsilon(t)$ & Sprungantwort $h_\epsilon[k]$ \\
Faltungsintegral & Faltungssumme \\
Laplace Transformation $s$ & $z$-Transformation \\
komplexe $s$-Ebene & komplexe $z$-Ebene\\
Übertragungsfunktion $H(s)$ & Übertragungsfunktion $H(z)$ \\
imaginäre Achse der $s$-Ebene & Einheitskreis in der $z$-Ebene\\
Pole in der linken $s$-Ebene &
Pole im Einheitskreis der $z$-Ebene \\
Frequenzvariable $\omega$ & Frequenzvariable $\Omega=\frac{\omega}{f_s}$ \\
Frequenzgang $H(s=\im\omega)$ & Frequenzgang $H(z=\e^{\im\Omega})$ \\
Fourier Transformation (FT)  & discrete-time Fourier transform (DTFT)\\
Fourier Reihe (FS)  & discrete Fourier transform (DFT) \\\hline
\end{tabular}
\end{center}
\caption{Entsprechungen von zeitkontinuierlicher und zeitdiskreter LTI-Systemtheorie.}
\label{tbl:Analogien_CT_DT}
\end{table}








\subsection*{Standardsignale}
Die aus der zeitkontinuierlichen SigSys bekannten Standardsignale haben entsprechende
Pendants im zeitdiskreten Bereich. Die vier wichtigsten sind, vgl.
Abb.~\ref{fig:ex08:Standardsignale}:
\begin{itemize}
\item Dirac Impuls (Link zu LTI-Systemen: Impulsantwort)
\begin{align}
\delta[k] =
\begin{cases}
1 & k=0\\
0 & k \neq 0
\end{cases}
%\end{align}
%\begin{align}
%=\delta[k] =
=\epsilon[k] - \epsilon[k-1]
\end{align}
\item Einheitssprungfolge (Link zu LTI-Systemen: Sprungantwort)
\begin{align}
\epsilon[k] =
\begin{cases}
1 & k \geq 0\\
0 & k<0
\end{cases}
=\sum_{\kappa=-\infty}^k \delta[\kappa]
\end{align}
\item Rechteckfolge der Länge $N$ (also $N$ Folgenwerte, in SigSys oft auch Samples genannt)
\begin{align}
\mathrm{rect}_N[k] =
\begin{cases}
1 & 0 \leq k < N\\
0 & k<0
\end{cases}
%\end{align}
%\begin{align}
%=\mathrm{rect}_N[k]
= \epsilon[k] - \epsilon[k-N];
\end{align}
wir beachten den Spezialfall $\mathrm{rect}_{N=1}[k] = \epsilon[k] - \epsilon[k-1] = \delta[k]$.

\item Exponentialfolge (Link zu LTI-Systemen: Eigenfunktion bzw. -folge)

\noindent Mit der komplexen Zahl $z\in\mathbb{C}$ (für $\Sigma,\Omega\in\mathbb{R}$)
\begin{align}
z = \e^{(\Sigma + \im\Omega)} = \e^{\Sigma} \cdot \e^{\im\Omega}
\end{align}
und deren Zerlegung in Betrag und Phasenwinkel
\begin{align}
|z| = |\e^{\Sigma}|,\quad
\angle z = \Omega
\end{align}
können wir eine Exponentialfolge definieren
\begin{align}
x[k] =& \e^{(\Sigma_0 + \im\Omega_0) \, k} = (\e^{(\Sigma_0 + \im\Omega_0)})^k = z_0^k\\
x[k] =& |z_0|^k \cdot (\e^{\im \angle z_0})^k
\end{align}
$|z_0|<1$ ist eine abklingende Folge, $|z_0|>1$ ist eine aufklingende Folge,
Für $|z_0|=1$ erhalten wir eine harmonische, komplexwertige Schwingung,
$x[k] = \e^{\im \Omega_0 k} = \cos(\Omega_0 k) + \im \sin(\Omega_0 k)$,
die periodisch in einer gewissen Länge sein kann, siehe oben.
\end{itemize}
%
\begin{figure}[h]
\centering
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\begin{scope}
\draw[->] (-4.5,0) -- (4.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,1.5) node[above]{$\delta[k]$};
\draw[stem] plot coordinates{(-4,0) (-3,0) (-2,0) (-1,0) (0,1) (1,0) (2,0) (3,0) (4,0)};
\foreach \x in {-1,1}{\draw (\x,+\tic) -- (\x,-\tic)  node[below]{$\x$};};
\foreach \y in {1}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\end{scope}
\begin{scope}[xshift=11cm]
\draw[->] (-4.5,0) -- (4.25,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,1.5) node[above]{$\epsilon[k]$};
\draw[stem] plot coordinates{(-4,0) (-3,0) (-2,0) (-1,0) (0,1) (1,1) (2,1) (3,1) (4,1) (5,1)};
\foreach \x in {-1,1}{\draw (\x,+\tic) -- (\x,-\tic)  node[below]{$\x$};};
\foreach \y in {1}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (5,0.75) node[right]{$\dots$};
\end{scope}
\begin{scope}[xshift=22cm]
\draw[->] (-4.5,0) -- (4.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,1.5) node[above]{$\mathrm{rect}_{N=4}[k]$};
\draw[stem] plot coordinates{(-4,0) (-3,0) (-2,0) (-1,0) (0,1) (1,1) (2,1) (3,1) (4,0)};
\foreach \x in {-1,1,3}{\draw (\x,+\tic) -- (\x,-\tic)  node[below]{$\x$};};
\foreach \y in {1}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (4,\tic) -- (4,-\tic)  node[below]{$N$};
\end{scope}
\end{tikzpicture}
\caption{Links: zeitdiskreter Dirac Impuls $\delta[k]$,
Mitte: Einheitssprungfolge $\epsilon[k]$,
rechts: Rechteckfolge $\mathrm{rect}_N[k]$ (Achtung: bei zeitdiskreter SigSys ist diese nicht axialsymmetrisch!).}
\label{fig:ex08:Standardsignale}
\end{figure}





\newpage
\subsection*{Dirac Impuls und Faltung im zeitdiskreten Bereich}


Im Gegensatz zur zeitkontinuierlichen SigSys, ist der Dirac Impuls in der zeitdiskreten
SigSys eine definierte Folge
\begin{align}
\sum\limits_{k=-\infty}^{+\infty} \delta[k] = 1
\qquad\qquad
\delta[k] =
\begin{cases}
1 & k=0\\
0  & k \neq 0
\end{cases}
\end{align}
mit der wir direkt rechnen dürfen, also keinen (gedanklichen) Umweg nehmen müssen
über eine Distribution und Anwendung von deren Eigenschaften.
Am allerwichtigsten ist wieder
\begin{align}
\delta[k] x[k] = \delta[k] x[0]
\end{align}
und die Summen darüber
\begin{align}
\sum\limits_{k=-\infty}^{+\infty} \delta[k] x[k] = \sum\limits_{k=-\infty}^{+\infty}  \delta[k] x[0] = x[0] \sum\limits_{k=-\infty}^{+\infty} \delta[k] = x[0],
\end{align}
also die \textbf{Multiplikationseigenschaft} und die \textbf{Austasteigenschaft}.
Wenn wir den Impuls verschieben, so dass die Spitze bei $\kappa$ ist (vgl. wir verwenden im Zeitdiskreten kappa und im Zeitkontinuierlichen tau), also
\begin{align}
\sum\limits_{k=-\infty}^{+\infty} \delta[k-\kappa] = 1
\qquad\qquad
\delta[k-\kappa] =
\begin{cases}
1 & k=\kappa\\
0  & k \neq \kappa
\end{cases}
\end{align}
folgt
\begin{align}
\text{Multiplikationseigenschaft allgemein} & \qquad\delta[k-\kappa]\,x[k] = \delta[k-\kappa]\,x[\kappa]\\
\text{Multiplikationseigenschaft für } \kappa=0 & \qquad\delta[k]\,x[k] = \delta[k]\,x[0]\\
\text{Austasteigenschaft I allgemein} & \quad \sum\limits_{k=-\infty}^{+\infty} \delta[k-\kappa] x[k] = x[\kappa]\\
\text{Austasteigenschaft I für } \kappa=0& \quad \sum\limits_{k=-\infty}^{+\infty} \delta[k] x[k] = x[0]
\end{align}
%
Die allgemeine Austasteigenschaft I können wir mit einem Variablentausch $k \leftrightarrow \kappa$ als
\begin{align}
\sum\limits_{\kappa=-\infty}^{+\infty} \delta[\kappa-k] x[\kappa] = x[k]
\end{align}
schreiben. Der Dirac Impuls ist ein gerades Signal, d.h. es gilt $\delta[k]=\delta[-k]$. Es gilt also auch $\delta[\kappa-k]=\delta[-(\kappa-k)]=\delta[-\kappa+k]$ und wir können damit die allgemeine Austasteigenschaft II
\begin{align}
\sum\limits_{\kappa=-\infty}^{+\infty} \delta[-\kappa+k] x[\kappa] = x[k],
\end{align}
aufschreiben, die sich auch in der Formelsammlung findet. Typ I und II sind nützlich für verschiedene Rechenwege. Typ I ist in den meisten Lehrbüchern drin und mutmaßlich am Anfang einfacher zu verdauen. Typ II ist sehr gut geeignet, die Faltung elegant herzuleiten:
%
Der Dirac Impuls ist das \textbf{Neutralelement der Faltung}, an diesem fundamentalen
Konzept halten wir auch in der zeitdiskreten Welt fest. Daher repräsentiert die
obige Austasteigenschaft Typ II
\begin{align}
x[k] = \delta[k] \ast_k x[k] = \sum_{\kappa=-\infty}^{+\infty}
\delta[k-\kappa] \, x[\kappa]
\end{align}
eine spezielle Faltungssumme. Für ein LTI-System $\mathcal{H}$ können wir
die Impulsantwort $h[k]=\mathcal{H}\{\delta[k]\}$ definieren, und damit
Eingang $x[k]$ und Ausgang $y[k]$ verknüpfen mit der \textbf{Faltung}
\begin{align}
x[k] = h[k] \ast_k x[k] = \sum_{\kappa=-\infty}^{+\infty}
h[k-\kappa] \, x[\kappa].
\end{align}
%

In \fig{fig:convolution_discrete_pt1_xhy} ist ein Beispiel für eine Faltung
zweier Folgen dargestellt, es entspricht einer möglichen zeitdiskreten
Variante der Übungsaufgabe~\ref{sec:AF3B15E0D3} (2.7).
%
\begin{figure}[b]
\centering
\includegraphics[width=\textwidth]{../convolution_dt/convolution_discrete_pt1_xhy.pdf}
\caption{Zeitdiskrete Faltung zweier endlicher Folgen, vgl. den zeitkontinuierlichen
Fall aus Aufgabe~\ref{sec:AF3B15E0D3} (2.7). \texttt{convolution\_discrete\_pt1.ipynb}}
\label{fig:convolution_discrete_pt1_xhy}
\end{figure}
%
In \fig{fig:convolution_discrete_pt1_y_over_kt_zoom} ist das Ausgangssignal noch
einmal mit vergrößertem Ausschnitt dargestellt, um den Stem-Plot und damit den
Charakter einer Signalfolge deutlicher zu machen.
%
Zwei Dinge sollten wir hier mitnehmen:
\begin{itemize}
\item das Ausrechnen der Faltungssumme per Hand macht aufgrund der krummen Zahlenwerte
schon für dieses sehr einfache Beispiel (es ähnelt wieder Tiefpassverhalten 1. Ordnung)
keinen Spaß.
Deswegen werden wir Faltungen im Folgenden mit sehr künstlichen Signalen
üben, um halbwegs schöne Zahlen zu bekommen. Das wird uns nun
sehr oft begegnen in der zeitdiskreten Welt:
analytisches Rechnen mit praxisfernen Systemen/Signalen,
praxisnahe Systeme eher simulieren mit dem Rechner. Damit Zweiteres fehlerfrei und
sicher wird, müssen wir Ersteres beherrschen. Nur dann sind wir in der
Lage, Software mit analytischen Referenzlösungen zu validieren.
Ohne dieses wissenschaftliche Vorgehen wäre es nur Bastelei mit Computern...sehr gefährlich gerade im Bereich Machine Learning!
\item Ein System mit \textbf{endlicher Impulsantwort}, also wie das hier einführende Beispiel
vgl. Aufgabe~\ref{sec:AF3B15E0D3} (2.7), ist eine Spezialität das
\textbf{praktisch} sinnvoll \textbf{nur zeitdiskret} zu realisieren geht. In der Literatur
ist dies als \textbf{Finite Impulse Response (FIR)} Filter bekannt, ein Kapitel
zu diesem Filtertyp findet sich in jedem Lehrbuch zu digitaler Signalverarbeitung.
Es dürfte schwierig bis unmöglich sein, analoge Systeme zu bauen die eine
exakt endliche Impulsantwort haben. In Aufgabe~\ref{sec:AF3B15E0D3} (2.7) war das ein didaktisches
Konzept, um die Grenzen des Faltungsintegrals zu verinnerlichen.
\end{itemize}
%
\begin{figure}[t]
\centering
\includegraphics[width=0.7\textwidth]{../convolution_dt/convolution_discrete_pt1_y_over_kt_zoom.pdf}
\caption{Ausgangssignal $y$ aus \fig{fig:convolution_discrete_pt1_xhy},
vergrößerter Ausschnitt und aufgetragen über $k$ und $t=k T_s$.}
\label{fig:convolution_discrete_pt1_y_over_kt_zoom}
\end{figure}

\subsection*{Lernziel}
In dieser Übung werden wir Abtastung verlinken mit Folgen.
Zu einem Ingenieursstudiengang gehört das erfolgreiche Erarbeiten
der Faltung, und weil im Digital Age überaus praxisrelevant,
werden wir auch den zeitdiskreten Fall vertieft üben.
Dafür fallen anderen Themen aus dieser Einheit ein wenig runter, z.B.
der Check von Systemen auf Linearität und Zeitinvarianz, also die Analogie zu
Aufgabe~\ref{sec:25F7F29E2A} (2.4). Die Transferleistung ist jedoch vergleichsweise einfach.
Des weiteren heben wir uns das Konzept der Differenzengleichungen für die folgenden
Einheiten auf, weil sie im Kontext der $z$-Transformation besser aufgehoben sind.


\newpage
\subsection{Mehrdeutigkeit von Folgen}
\label{sec:625E151299}
\begin{Ziel}
Wir wollen die Mehrdeutigkeit von Cosinusfolgen vertiefen und mit
der Abtastung von Zeitsignalen verknüpfen.
\end{Ziel}
\textbf{Aufgabe} {\tiny 625E151299}: Zeigen Sie, dass die $N=8$ periodischen
Cosinusfolgen $x_3[k] = \cos(3\cdot\frac{2\pi}{8}k)$ und
$x_5[k] = \cos(5\cdot\frac{2\pi}{8}k)$
identisch sind.
%
Erklären Sie mittels des idealen Abtastprozesses, warum das so sein muss.
%
\begin{center}
\begin{tikzpicture}[scale=1]
\def\tic{0.1};
\def\Om{360/8}
\draw[help lines, C7!25, step=1cm] (0,-1) grid (7,1);
\draw[->] (-1.5,0) -- (9,0) node[right]{$k$};
\draw[->] (0,-1) -- (0,2) node[above]{$x[k]=\cos(3\cdot\frac{2\pi}{8}k)=\cos(5\cdot\frac{2\pi}{8}k)$};
\foreach \x in {-1,0,...,8}{\draw (\x,+\tic) -- (\x,-\tic)  node[left]{$\x$};};
\foreach \y in {-1,1}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\foreach \k in {-1,0,...,8}{\draw[stem2] plot coordinates{(\k,{cos(3*\Om*\k)})};};
\foreach \k in {-3,-2,-1,8,9,10}{\draw[stem2, C3] plot coordinates{(\k,{cos(3*\Om*\k)})};};
\end{tikzpicture}
\end{center}

\begin{Werkzeug}
Trigonometrie, ideales Abtastmodell.
\end{Werkzeug}
\begin{Ansatz}
$2\pi$-Periodizität checken, Signale und Abtastspektren skizzieren.
\end{Ansatz}
\begin{ExCalc}
für $2\pi$-Vielfache Hilfsvariable $n\in\mathbb{Z}$
\begin{align}
\cos(3\cdot\frac{2\pi}{8}k) = \cos(5\cdot\frac{2\pi}{8}k)\\
\cos\left(\left(3\cdot\frac{2\pi}{8} + 2\pi n\right)k\right) = \cos(5\cdot\frac{2\pi}{8}k)\\
%\cos\left(\left(3\cdot\frac{2\pi}{8} + \frac{16}{8}\pi n\right)k\right) = \cos(5\cdot\frac{2\pi}{8}k)\\
\cos\left(\frac{2\pi}{8}\left(3 + 8 n\right)k\right) = \cos(5\cdot\frac{2\pi}{8}k)
\end{align}
für $n=-1$
\begin{align}
\cos\left(\frac{2\pi}{8}\left(3 - 8\right)k\right) = \cos(5\cdot\frac{2\pi}{8}k)
\quad
\rightarrow
\quad
\cos\left(\frac{2\pi}{8}\left(-5\right)k\right) = \cos(5\cdot\frac{2\pi}{8}k)
\end{align}
Übereinstimmung, weil Cosinus eine axialsymmetrische Funktion ist, also
$\cos(\phi) = \cos(-\phi)$.
%
Es ist immer schön, wenn wir etwas mit Formeln belegen können.
%
Ein wenig greifbarer wird das aber erst, wenn wir in den Formeln auch sehen,
was da im Wesen passiert.
%
Weil wir in der Übung~\ref{sec:ue7_abtastung} (7) Abtastung betrieben haben, ist es didaktisch sinnvoll,
hier eine Verknüpfung dazu herzustellen: Wir könnten uns überlegen, dass diese
Folgen aus einem Abtastprozess zeitkontinuierlicher Signale entstanden
sind.
%
Wir sind dafür völlig frei in der Wahl der Abtast-(Kreis)-Frequenz!
%
Die Folge $x[k]$ selbst 'lebt' über $k$.
%
Was wir damit über die tatsächliche Zeit machen, also wie wir die diskreten Zeitpunkte
$t=k T_s$ mittels $T_s$ definieren, interessiert $x[k]$ nicht.
%
Machen wir uns es nun nicht schwerer als nötig und legen die Abtast-Kreis-Frequenz
$\omega_s=8$\,rad/s fest. Das ist sinnvoll, weil die Folgen periodisch in 8 sind,
und alle weiteren Zahlen dann auch ganzzahlig bzw. schnell überschaubare
Vielfache von $\pi$ werden.
%
Es folgt das Abtastintervall
$T_s = \frac{2\pi}{\omega_s}=\frac{\pi}{4}$ s.
%
Damit können wir die physikalischen Frequenzen der beiden zeitkontinuierlichen
Cosinussignale ermitteln. Wir kennen den Zusammenhang
\begin{align}
\Omega = \frac{2\pi}{N} \leftrightarrow \Omega = \omega T_s
\end{align}
und daher für $x_{3,5}[k]$
\begin{align}
\Omega_3 = 3\frac{2\pi}{8} = \omega_3 T_s \rightarrow \omega_3 = 3 \text{ rad/s},\quad\quad
\Omega_5 = 5\frac{2\pi}{8} = \omega_5 T_s \rightarrow \omega_5 = 5 \text{ rad/s}
\end{align}
%
Die Folge $x_3[k]=x_5[k]$ könnte also aus den beiden Signalen $x_3(t)=\cos(3 t)$
und $x_5(t) = \cos(5 t)$ durch ideale Abtastung mit Abtast-kreis-frequenz
$\omega_s = 8$\,rad/s entstanden sein, halbe Abtast-kreis-frequenz also
$\frac{\omega_s}{2} = 4$\,rad/s.
%
Das können wir nochmal prüfen, indem wir für $t=k T_s$
einsetzen und für die ganzzahligen $k$ die Cosinuswerte ausrechnen.
In \fig{fig:mehrdeutigkeit_625E151299} ist das grafisch aufbereitet.
%
Das Abtasttheorem verrät uns, dass das Signal $x_5(t) = \cos(5 t)$ unterabgetastet
ist, ein erster Hinweis, dass $x_3(t)$ und $x_5(t)$ nach der Abtastung keine
unterschiedlichen Folgen ergeben könnten.
%
Machen wir uns das anhand der Spektren der abgetasteten Signale klar. Siehe Skizze
unten (das können wir nochmal wiederholend üben, siehe Übung~\ref{sec:ue7_abtastung} (7)).
%
\begin{center}
\begin{tikzpicture}[scale=1]
\def\freqs{8}
\def\mult{0.2}
\begin{scope}
\def\freq{3}
\draw[help lines, C7!80, step=\mult*\freqs*0.5 cm] (-\freqs*\mult*3,0) grid (\freqs*\mult*3,1.5);
\draw[->] (-5 ,0) -- (5,0) node[below]{$\omega$  / (rad/s)};
\draw[->] (0,-0.1) -- (0,1.5) node[above]{$\mathcal{F}\{\cos(3 t) \cdot \frac{4}{\pi}\Sha\left(\frac{4 t}{\pi}\right)\}$};
\draw[->, C1, line width=0.75mm] (-\freq*\mult,0) node[below]{$-\freq$} -- (-\freq*\mult,1) node[above]{$(4)$};
\foreach \y in {-2,-1,1,2,3}{\draw[->, C0, line width=0.75mm] (-\freq*\mult+\y*\freqs*\mult,0) -- (-\freq*\mult+\y*\freqs*\mult,1);};
\draw[->, C1, line width=0.75mm] (+\freq*\mult,0) node[below]{$+\freq$} -- (+\freq*\mult,1);
\foreach \y in {-3,-2,-1,1,2}{\draw[->, C0, line width=0.75mm] (+\freq*\mult+\y*\freqs*\mult,0) -- (+\freq*\mult+\y*\freqs*\mult,1);};
\draw[C0] (-5,0.5) node{$\dots$};
\draw[C0] (+5,0.5) node{$\dots$};
\end{scope}
\begin{scope}[shift={(0,-2.5)}]
\def\freq{5}
\draw[help lines, C7!80, step=\mult*\freqs*0.5 cm] (-\freqs*\mult*3,0) grid (\freqs*\mult*3,1.5);
\draw[->] (-5 ,0) -- (5,0) node[below]{$\omega$ / (rad/s)};
\draw[->] (0,-0.1) -- (0,1.5) node[above]{$\mathcal{F}\{\cos(5 t) \cdot \frac{4}{\pi}\Sha\left(\frac{4 t}{\pi}\right)\}$};
\draw[->, C3, line width=0.75mm] (-\freq*\mult,0) node[below]{$-\freq$} -- (-\freq*\mult,1)  node[above]{$(4)$};
\foreach \y in {-2,-1,1,2,3}{\draw[->, C0, line width=0.75mm] (-\freq*\mult+\y*\freqs*\mult,0) -- (-\freq*\mult+\y*\freqs*\mult,1);};
\draw[->, C3, line width=0.75mm] (+\freq*\mult,0) node[below]{$+\freq$} -- (+\freq*\mult,1);
\foreach \y in {-3,-2,-1,1,2}{\draw[->, C0, line width=0.75mm] (+\freq*\mult+\y*\freqs*\mult,0) -- (+\freq*\mult+\y*\freqs*\mult,1);};
\draw[C0] (-5,0.5) node{$\dots$};
\draw[C0] (+5,0.5) node{$\dots$};
\end{scope}
\end{tikzpicture}
\end{center}
%
Die Spektren sind identisch, unterschiedlich bunt sind sie nur deswegen,
damit wir schneller die Zusammenhänge des jeweiligen Abtastprozesses erkennen.
%
Zu einem Spektrum gehört nur ein einziges Zeitsignal, daher
müssen die beiden Folgen $x_3[k]$ und $x_5[k]$ identisch sein.
%
Das Spektrum ist a) periodisch und besitzt nur bei diskreten Frequenzen einen
Eintrag (Dirac), d.h. es ist ein sogenanntes b) Linienspektrum.
%
Daraus lässt sich für den Zeitbereich folgern: a) es ist eine Folge und b)
es ist eine periodische Folge.
Die jeweiligen Bedingungen a) und b) korrespondieren direkt.
%
Es gibt eine spezielle Fouriertransformation für diesen speziellen Folgen- bzw.
Spektrentyp, es ist die sogenannte \textbf{Diskrete Fourier Transformation (DFT)}.
%
Wir werden diese bald kennenlernen.
%
\end{ExCalc}
%\begin{Loesung}
%\end{Loesung}
%
\begin{figure*}[h]
\centering
\begin{subfigure}{0.75\textwidth}
\includegraphics[width=\textwidth]{../fundamental_signals_dt/mehrdeutigkeit_625E151299_w3.pdf}
\caption{Drei Schwingungen pro $2\pi$ ausreichend abgetastet.}
\label{fig:mehrdeutigkeit_625E151299_w3}
\end{subfigure}
%
\begin{subfigure}{0.75\textwidth}
\includegraphics[width=\textwidth]{../fundamental_signals_dt/mehrdeutigkeit_625E151299_w5.pdf}
\caption{Fünf Schwingungen pro $2\pi$ unterabgetastet.}
\label{fig:mehrdeutigkeit_625E151299_w5}
\end{subfigure}
\caption{Oben: korrekte Abtastung vs. unten: Unterabtastung für
gewählte Abtast-(kreis)-frequenz $\omega_s = 8$ rad/s,
also Abtastintervall $T_s = \frac{2\pi}{\omega_s} = \frac{\pi}{4}$ s.
Für beide Fälle resultiert die gleiche Folge $x[k]$. Dies mündet in die
Mehrdeutigkeit periodischer Folgen, die aber auch ganz unabhängig von
Signal-Abtastung gilt.}
\label{fig:mehrdeutigkeit_625E151299}
\end{figure*}


















\clearpage
\subsection{Faltungssumme für zwei endliche, zeitdiskrete Signale---Lösungsweg I, II \& III}
\label{sec:FD58EEB1EC}
\begin{Ziel}
Wir wollen uns die Faltung von (endlichen) zeitdiskreten Signalen erarbeiten.
Die Faltungsoperation selber funktioniert genau wie bei zeitkontinuierlichen
Signalen, das Integral wird hier durch eine Summenoperation ersetzt.
Die Analogie wird deutlich wenn wir uns die Faltung in den beiden
Signaldomänen mal nebeneinander schreiben
\begin{align}
y(t) = \int\limits_{-\infty}^{+\infty} h(-\tau+t) \cdot x(\tau) \, \fsd \tau\qquad
y[k] = \sum\limits_{\kappa = -\infty}^{+\infty} h[-\kappa+k] \cdot x[\kappa].
\end{align}
Die Variablen haben analoge Entsprechungen, also $t \leftrightarrow k$ als
Zeitvariable des Ausgangssignals und
die Hilfsvariable $\tau \leftrightarrow \kappa$ für das Integral bzw. die Summe.
%
Deswegen ist alles was wir schon zur zeitkontinuierlichen Faltung verstanden haben,
hier nützlich.
%
Nachdem wir kein Integral lösen müssen, sondern eine Summe,
fällt es vielleicht sogar leichter, die 'Algorithmik' des Faltungsprozesses
für ein gewähltes $k$, also eine bestimmte Überlagerung der beiden zu faltenden
Signale, nachzuvollziehen.
%
Wir werden uns das unter anderem grafisch erarbeiten. In der Klausur empfiehlt sich z.B.
die Benutzung von zwei Papierstreifen auf denen $x[\kappa]$ und $h[-\kappa]$
aufgetragen sind, und $h[-\kappa]$ sukzessive verschoben wird um $k$. Die
Multiplikation der exakt überlagerten Signalwerte und die Summe davon ergibt
dann das Faltungsergebnis bei $k$. Das besagt die Faltungsformel.
\end{Ziel}
\textbf{Aufgabe} {\tiny FD58EEB1EC}: Berechnen Sie die zeitdiskrete Faltung
$y[k] = x[k] \ast h[k]$ für die unten gegebenen Signale.
%
%% Signal x[k], h[k]
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\draw[->] (-0.5,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$x[k]$};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\begin{scope}[xshift=11cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[k]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,2) (1,1) (2,-1) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\end{tikzpicture}
\end{center}
%
Es ist sinnvoll auch den analytischen Lösungsweg aus Aufgabe \ref{sec:4CBF4358D5}
für die beiden Signale durchzuspielen.
Siehe auch Python/Matlab Skripe: \texttt{convolution\_discrete\_FD58EEB1EC.ipynb/.m}
\begin{Werkzeug}
Wir machen uns anhand \fig{fig:FD58EEB1EC_Methods} klar, wie die Signaloperationen
zeitliche Verschiebung und Drehung auf eine zeitdiskrete Folge wirken. Methode II
ist eine mögliche, elegante Sichtweise zur Verwendung in der Faltungssumme
\begin{align}
y[k]
= h[k] \ast_k x[k]
= x[k] \ast_k h[k]
= \sum_{\kappa=-\infty}^{+\infty} h[-\kappa + k] \cdot x[\kappa]
= \sum_{\kappa=-\infty}^{+\infty} h[\kappa] \cdot x[-\kappa + k].
\end{align}
D.h. ein beteiligtes Signal,
hier $h[\kappa]$ wird zunächst einmal zeitlich gedreht zu $h[-\kappa]$ und
dann sukzessive mit der Variable $k$ verschoben, für $k>0$ nach rechts, für
$k<0$ nach links.
\end{Werkzeug}
%
\begin{figure*}[h]
\centering
\begin{subfigure}{0.7\textwidth}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\begin{scope}[xshift=0cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[\kappa]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,2) (1,1) (2,-1) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\begin{scope}[xshift=9cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[\kappa-2]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem, C1] plot coordinates{ (-1+2,0) (0+2,2) (1+2,1) (2+2,-1) (3+2,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\draw (2,\tic) -- (2,-\tic)  node[below]{$2$};
\end{scope}
\begin{scope}[xshift=18cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[-(\kappa-2)] = h[-\kappa+2]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,-1) (1,1) (2,2) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\draw (2,\tic) -- (2,-\tic)  node[below]{$2$};
\end{scope}
\end{tikzpicture}
\caption{Methode I: zunächst Verschiebung, dann Spiegelung bzgl. $\kappa=2$ Achse}
\label{fig:FD58EEB1EC_MethodI}
\end{subfigure}
%
%
%
\begin{subfigure}{0.7\textwidth}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\begin{scope}[xshift=0cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[\kappa]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,2) (1,1) (2,-1) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\begin{scope}[xshift=9cm]
\draw[->] (-3,0) -- (4,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[-\kappa]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem, C3] plot coordinates{ (-3,0) (-2,-1) (-1,1) (0,2) (1,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\draw (2,\tic) -- (2,-\tic)  node[below]{$2$};
\end{scope}
\begin{scope}[xshift=18cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[-\kappa+2]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,-1) (1,1) (2,2) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\draw (2,\tic) -- (2,-\tic)  node[below]{$2$};
\end{scope}
\end{tikzpicture}
\caption{Methode II: zunächst Spiegelung bzgl. $\kappa=0$ Achse, dann Verschiebung.}
\label{fig:FD58EEB1EC_MethodII}
\end{subfigure}
%
\caption{Zeitliche Signaloperationen für $h[\kappa] \rightarrow h[-\kappa+k]$ , $k=2$.
Methode III: direkte Spiegelung von $h[\kappa]$ bzgl. $\kappa=\frac{k}{2}=\frac{2}{2}=1$-Achse;
nicht dargestellt, weil es nichts zu malen gibt.
Methode II ist vorteilhaft für die Faltungssumme.}
\label{fig:FD58EEB1EC_Methods}
\end{figure*}
%
%
%
\begin{Ansatz}
Die Signale sind endlich, daher ist auch das Ergebnis $y[k]$ endlich.
Es gilt allgemein die Formel
\begin{align}
N_y = N_x + N_h-1
\end{align}
%$N_y = N_x + N_h-1$
mit den Längen $N$ für $y,x,h$.
Das Signal $y[k]$ 'beginnt' bei $k_y=k_x+k_h$, wenn $k_x$ und $k_h$ die
sich zeitlichen Startwerte der beiden Signale $x$ und $h$ sind, wo die Samples
nicht Null sind, also die Signale 'losgehen'.

Hier also: $k_x=1$, $k_h = 0$, d.h. $k_y=k_x+k_h = 1$ und
$N_x = 4$, $N_h=3$, d.h. $N_y = N_x+N_h-1 = 6$.

\end{Ansatz}
%\begin{ExCalc}
%Die grafische Lösung ist auf den nächsten Seiten aufbereitet.
%\end{ExCalc}
\begin{Loesung}
%
Das grafische Lösungsschema (Lösungsweg I) ist auf den nächsten Seiten aufbereitet.
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{7}
\begin{scope}
\draw[help lines, C7!25, step=1cm] (0,-3) grid (6,4);
\foreach \y in {-3,-2,-1,0,1,2,3,4}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\draw (2,\tic) -- (2,-\tic)  node[below]{$2$};
\draw (3,\tic) -- (3,-\tic)  node[below]{$3$};
\draw (4,\tic) -- (4,-\tic)  node[above]{$4$};
\draw (5,\tic) -- (5,-\tic)  node[above]{$5$};
\draw (6,\tic) -- (6,-\tic)  node[below]{$6$};
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\end{scope}
\end{tikzpicture}
\end{center}
\end{Loesung}
%
%
%
\clearpage
%% k = 0
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{0}
\begin{scope}
\draw[->] (-3.5,0) -- (8,0) node[below]{$\kappa$};
\draw[->] (0,-1.5) -- (0,4) node[above]{\shortstack{\textcolor{C0}{$x[\kappa]\,,$}\\\textcolor{C1}{$h[-\kappa+\k]$}}};
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C1, xshift=2pt, yshift=1pt] plot coordinates{ (-2+\k, -1) (-1+\k,1) (0+\k,2)};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\node at (-5,1){$k=\k$};
\end{scope}
\begin{scope}[yshift=-7cm]
\draw[->] (-0.5,0) -- (6,0) node[right]{$\kappa$};
\draw[->] (0,-2.5) -- (0,4) node[above]{$x[\kappa]\cdot h[-\kappa+\k]$};
\foreach \y in {-2,...,3}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C3] plot coordinates{(0,0) (1,0) (2,0) (3,0) (4,0) (5,0) };
\node at (8,4){$y[\k] = \sum_{\kappa} x[\kappa]\cdot h[-\kappa+\k] = +0$};
\end{scope}
\begin{scope}[yshift=-7cm, xshift=10cm]
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C2!10] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem, C2, dashed] plot coordinates{(0,0)};
\end{scope}
\end{tikzpicture}
\end{center}
%
%
%
\clearpage
%% k = 1
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{1}
\begin{scope}
\draw[->] (-3.5,0) -- (8,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,4) node[above]{\shortstack{\textcolor{C0}{$x[\kappa]\,,$}\\\textcolor{C1}{$h[-\kappa+\k]$}}};
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C1, xshift=2pt, yshift=1pt] plot coordinates{ (-2+\k, -1) (-1+\k,1) (0+\k,2)};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\node at (-5,1){$k=\k$};
\end{scope}
\begin{scope}[yshift=-7cm]
\draw[->] (-0.5,0) -- (6,0) node[right]{$\kappa$};
\draw[->] (0,-2.5) -- (0,4) node[above]{$x[\kappa]\cdot h[-\kappa+\k]$};
\foreach \y in {-2,...,3}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C3] plot coordinates{(0,0) (1,2) (2,0) (3,0) (4,0) (5,0) };
\node at (8,4){$y[\k] = \sum_{\kappa} x[\kappa]\cdot h[-\kappa+\k] = +2$};
\end{scope}
\begin{scope}[yshift=-7cm, xshift=10cm]
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C2!10] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem,  C2!75] plot coordinates{(0,0) (1,2)};
\draw[stem, C2, dashed] plot coordinates{(1,2)};
\end{scope}
\end{tikzpicture}
\end{center}
%
%
%
\clearpage
%% k=2
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{2}
\begin{scope}
\draw[->] (-3.5,0) -- (8,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,4) node[above]{\shortstack{\textcolor{C0}{$x[\kappa]\,,$}\\\textcolor{C1}{$h[-\kappa+\k]$}}};
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C1, xshift=2pt, yshift=1pt] plot coordinates{ (-2+\k, -1) (-1+\k,1) (0+\k,2)};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\node at (-5,1){$k=\k$};
\end{scope}
\begin{scope}[yshift=-7cm]
\draw[->] (-0.5,0) -- (6,0) node[right]{$\kappa$};
\draw[->] (0,-2.5) -- (0,4) node[above]{$x[\kappa]\cdot h[-\kappa+\k]$};
\foreach \y in {-2,...,3}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C3] plot coordinates{(0,0) (1,1) (2,2) (3,0) (4,0) (5,0) };
\node at (8,4){$y[\k] = \sum_{\kappa} x[\kappa]\cdot h[-\kappa+\k] = +3$};
\end{scope}
\begin{scope}[yshift=-7cm, xshift=10cm]
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C2!10] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem,  C2!75] plot coordinates{(0,0) (1,2) (2,3) };
\draw[stem, C2, dashed] plot coordinates{(2,3)};
\end{scope}
\end{tikzpicture}
\end{center}
%
%
%
\clearpage
%% k=3
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{3}
\begin{scope}
\draw[->] (-3.5,0) -- (8,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,4) node[above]{\shortstack{\textcolor{C0}{$x[\kappa]\,,$}\\\textcolor{C1}{$h[-\kappa+\k]$}}};
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C1, xshift=2pt, yshift=1pt] plot coordinates{ (-2+\k, -1) (-1+\k,1) (0+\k,2)};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\node at (-5,1){$k=\k$};
\end{scope}
\begin{scope}[yshift=-7cm]
\draw[->] (-0.5,0) -- (6,0) node[right]{$\kappa$};
\draw[->] (0,-2.5) -- (0,4) node[above]{$x[\kappa]\cdot h[-\kappa+\k]$};
\foreach \y in {-2,...,3}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C3] plot coordinates{(0,0) (1,-1) (2,1) (3,4) (4,0) (5,0) };
\node at (8,4){$y[\k] = \sum_{\kappa} x[\kappa]\cdot h[-\kappa+\k] = +4$};
\end{scope}
\begin{scope}[yshift=-7cm, xshift=10cm]
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C2!10] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem,  C2!75] plot coordinates{(0,0) (1,2) (2,3) (3,4) };
\draw[stem, C2, dashed] plot coordinates{(3,4)};
\end{scope}
\end{tikzpicture}
\end{center}
%
%
%
\clearpage
%% k=4
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{4}
\begin{scope}
\draw[->] (-3.5,0) -- (8,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,4) node[above]{\shortstack{\textcolor{C0}{$x[\kappa]\,,$}\\\textcolor{C1}{$h[-\kappa+\k]$}}};
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C1, xshift=2pt, yshift=1pt] plot coordinates{ (-2+\k, -1) (-1+\k,1) (0+\k,2)};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\node at (-5,1){$k=\k$};
\end{scope}
\begin{scope}[yshift=-7cm]
\draw[->] (-0.5,0) -- (6,0) node[right]{$\kappa$};
\draw[->] (0,-2.5) -- (0,4) node[above]{$x[\kappa]\cdot h[-\kappa+\k]$};
\foreach \y in {-2,...,3}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C3] plot coordinates{(0,0) (1,0) (2,-1) (3,2) (4,-2) (5,0) };
\node at (8,4){$y[\k] = \sum_{\kappa} x[\kappa]\cdot h[-\kappa+\k] = -1$};
\end{scope}
\begin{scope}[yshift=-7cm, xshift=10cm]
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C2!10] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem,  C2!75] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1)};
\draw[stem, C2, dashed] plot coordinates{(4,-1)};
\end{scope}
\end{tikzpicture}
\end{center}
%
%
%
\clearpage
%% k=5
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{5}
\begin{scope}
\draw[->] (-3.5,0) -- (8,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,4) node[above]{\shortstack{\textcolor{C0}{$x[\kappa]\,,$}\\\textcolor{C1}{$h[-\kappa+\k]$}}};
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C1, xshift=2pt, yshift=1pt] plot coordinates{ (-2+\k, -1) (-1+\k,1) (0+\k,2)};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\node at (-5,1){$k=\k$};
\end{scope}
\begin{scope}[yshift=-7cm]
\draw[->] (-0.5,0) -- (6,0) node[right]{$\kappa$};
\draw[->] (0,-2.5) -- (0,4) node[above]{$x[\kappa]\cdot h[-\kappa+\k]$};
\foreach \y in {-2,...,3}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C3] plot coordinates{(0,0) (1,0) (2,0) (3,-2) (4,-1) (5,0) };
\node at (8,4){$y[\k] = \sum_{\kappa} x[\kappa]\cdot h[-\kappa+\k] = -3$};
\end{scope}
\begin{scope}[yshift=-7cm, xshift=10cm]
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C2!10] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem,  C2!75] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3)};
\draw[stem, C2, dashed] plot coordinates{(5,-3)};
\end{scope}
\end{tikzpicture}
\end{center}
%
%
%
\clearpage
%% k=6
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{6}
\begin{scope}
\draw[->] (-3.5,0) -- (8,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,4) node[above]{\shortstack{\textcolor{C0}{$x[\kappa]\,,$}\\\textcolor{C1}{$h[-\kappa+\k]$}}};
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C1, xshift=2pt, yshift=1pt] plot coordinates{ (-2+\k, -1) (-1+\k,1) (0+\k,2)};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\node at (-5,1){$k=\k$};
\end{scope}
\begin{scope}[yshift=-7cm]
\draw[->] (-0.5,0) -- (6,0) node[right]{$\kappa$};
\draw[->] (0,-2.5) -- (0,4) node[above]{$x[\kappa]\cdot h[-\kappa+\k]$};
\foreach \y in {-2,...,3}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C3] plot coordinates{(0,0) (1,0) (2,0) (3,0) (4,1) (5,0) };
\node at (8,4){$y[\k] = \sum_{\kappa} x[\kappa]\cdot h[-\kappa+\k] = +1$};
\end{scope}
\begin{scope}[yshift=-7cm, xshift=10cm]
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C2!10] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem,  C2!75] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1)};
\draw[stem, C2, dashed] plot coordinates{(6,1)};
\end{scope}
\end{tikzpicture}
\end{center}
%
%
%
\clearpage
%% k=7
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{7}
\begin{scope}
\draw[->] (-3.5,0) -- (8,0) node[right]{$\kappa$};
\draw[->] (0,-1.5) -- (0,4) node[above]{\shortstack{\textcolor{C0}{$x[\kappa]\,,$}\\\textcolor{C1}{$h[-\kappa+\k]$}}};
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C1, xshift=2pt, yshift=1pt] plot coordinates{ (-2+\k, -1) (-1+\k,1) (0+\k,2)};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\node at (-5,1){$k=\k$};
\end{scope}
\begin{scope}[yshift=-7cm]
\draw[->] (-0.5,0) -- (6,0) node[right]{$\kappa$};
\draw[->] (0,-2.5) -- (0,4) node[above]{$x[\kappa]\cdot h[-\kappa+\k]$};
\foreach \y in {-2,...,3}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C3] plot coordinates{(0,0) (1,0) (2,0) (3,0) (4,0) (5,0) };
\node at (8,4){$y[\k] = \sum_{\kappa} x[\kappa]\cdot h[-\kappa+\k] = +0$};
\end{scope}
\begin{scope}[yshift=-7cm, xshift=10cm]
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k]$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem, C2!10] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem,  C2!75] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\draw[stem, C2, dashed] plot coordinates{(7,0)};
\end{scope}
\end{tikzpicture}
\end{center}

\noindent\textbf{Lösungsweg II: Einzel Diracs / Toeplitz Matrix}

\noindent Statt Papierstreifen (gedanklich) rumzuschieben, können wir die Faltung
auch anders lösen.
%
Dies ist vielleicht sogar der erhellendere, schnellere und weniger fehlerträchtige Weg.
%
Wir wissen, dass der Dirac Impuls das Neutralelement der Faltung ist, d.h. es gilt
\begin{align}
x[k - \kappa] = x[k] \ast_k \delta[k-\kappa]
\end{align}
Wir können dem Dirac ein Gewicht $a$ geben
\begin{align}
a \cdot x[k - \kappa] = x[k] \ast_k (a \cdot \delta[k-\kappa])
\end{align}
und es resultiert das mit $a$ gewichtete $x[k - \kappa]$ Signal.
%
Wenn wir die Samples aus $h[k]$ als Gewichte nehmen, können wir die Teilsignale
\begin{align}
y_\kappa = h[\kappa] \cdot x[k - \kappa] = x[k] \ast_k (h[\kappa] \cdot \delta[k-\kappa])
\end{align}
erzeugen, die das Eingangssignal $x[k]$ um $\kappa$ verschoben und um $h[\kappa]$ gewichtet beinhalten.
%
Die Summe aller Teilsignale ist nun das gesuchte Faltungsergebnis
\begin{align}
\label{eq:LinKombDiskFaltung}
y[k] = \sum\limits_{\kappa} y_\kappa = \sum\limits_{\kappa} h[\kappa] \cdot x[-\kappa + k],
\end{align}
weil ja im letzten Term wieder die Faltungssummenformel rauskommt.
%
Wir können uns das mit dem gewählten Zahlenbeispiel mit der nächsten Grafik durchdenken.

\newpage
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\draw[->] (-0.5,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$x[k]$};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\begin{scope}[xshift=11cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[k]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,2) (1,1) (2,-1) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\end{tikzpicture}
\end{center}


\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\draw[->] (-0.5,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$x[k]$};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\begin{scope}[xshift=11cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[0] \cdot \delta[k-0]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,2) (1,0) (2,0) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\begin{scope}[xshift=19cm]
\draw[help lines, C7!25, step=1cm] (0,-3) grid (6,4);
\draw[->] (-1.5,0) -- (7.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,4.5) node[above]{$y_{0} = x[k] \ast_k (h[0] \cdot \delta[k-0])$};
\foreach \y in {-1,1,2,3,4}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{(0,0) (1,2) (2,2) (3,4) (4,-2) (5,0) (6,0) (7,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\end{tikzpicture}
\end{center}




\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\draw[->] (-0.5,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$x[k]$};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\begin{scope}[xshift=11cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[1] \cdot \delta[k-1]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,0) (1,1) (2,0) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\begin{scope}[xshift=19cm]
\draw[help lines, C7!25, step=1cm] (0,-3) grid (6,4);
\draw[->] (-1.5,0) -- (7.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,4.5) node[above]{$y_{1} = x[k] \ast_k (h[1] \cdot \delta[k-1])$};
\foreach \y in {-1,1,2,3,4}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{(0,0) (1,0) (2,1) (3,1) (4,2) (5,-1) (6,0) (7,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\end{tikzpicture}
\end{center}



\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\draw[->] (-0.5,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$x[k]$};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,2) (4,-1) (5,0) };
\foreach \y in {-1, 1, 2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\begin{scope}[xshift=11cm]
\draw[->] (-1.5,0) -- (4,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,3) node[above]{$h[2] \cdot \delta[k-2]$};
\foreach \y in {-1,1,2}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{ (-1,0) (0,0) (1,0) (2,-1) (3,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\begin{scope}[xshift=19cm]
\draw[help lines, C7!25, step=1cm] (0,-3) grid (6,4);
\draw[->] (-1.5,0) -- (7.5,0) node[right]{$k$};
\draw[->] (0,-1.5) -- (0,4.5) node[above]{$y_{2} = x[k] \ast_k (h[2] \cdot \delta[k-2])$};
\foreach \y in {-1,1,2,3,4}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw[stem] plot coordinates{(0,0) (1,0) (2,0) (3,-1) (4,-1) (5,-2) (6,+1) (7,0)};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\end{scope}
\end{tikzpicture}
\end{center}



\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\def\k{7}
\begin{scope}
\draw[help lines, C7!25, step=1cm] (0,-3) grid (6,4);
\foreach \y in {-3,-2,-1,0,1,2,3,4}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (1,\tic) -- (1,-\tic)  node[below]{$1$};
\draw (2,\tic) -- (2,-\tic)  node[below]{$2$};
\draw (3,\tic) -- (3,-\tic)  node[below]{$3$};
\draw (4,\tic) -- (4,-\tic)  node[above]{$4$};
\draw (5,\tic) -- (5,-\tic)  node[above]{$5$};
\draw (6,\tic) -- (6,-\tic)  node[below]{$6$};
\draw[->] (-0.5,0) -- (8,0) node[right]{$k$};
\draw[->] (0,-3.2) -- (0,5) node[above]{$y[k] = y_0 + y_1 + y_2$};
\foreach \y in {-3,...,4}{\draw (\tic,\y) -- (-\tic,\y);};
\draw[stem] plot coordinates{(0,0) (1,2) (2,3) (3,4) (4,-1) (5,-3) (6,1) (7,0)};
\end{scope}
\end{tikzpicture}
\end{center}






Richtig elegant für händisches Rechnen statt Malen wird es,
wenn wir die Summe \eqref{eq:LinKombDiskFaltung} als
Linearkombination auffassen und
sie tatsächlich als Matrix-Vektor Produkt rechnen. Wir wissen, dass $N_y=N_x+N_h-1=4+3-1=6$.
%
Die von Null verschiedenen Samples von $x[k]$
bauen wir in eine Matrix mit Dimension $N_y \times N_h = 6 \times 3$
wie folgt:
%
In die erste Spalte kommen oben die vier Werte von $x[k]$, die restlichem zwei
Spaltenwerte füllen wir mit Null auf, damit wir auf insgesamt $N_y$ Werte kommen.
%
Die zweite Spalte enthält die vier Werte von $x[k]$ zentriert, auffüllen jeweils
einer Null unten und oben (letztere realisiert die Verzögerung von $x[k]$
um ein Sample).
%
Die dritte Spalte enthält dann die vier Werte von $x[k]$ unten, d.h. es sind
zwei Nullen oben eingefügt entsprechend einer Verzögerung von $x[k]$ um zwei Samples.
%
Die fertige Matrix ist eine \textbf{Toeplitz Matrix} (konstante Diagonalen;
komplett definiert, wenn 1. Spalte und 1. Zeile bekannt)
und realisiert in den Spalten
die verschobenen $x[k-\kappa]$ Signale.
%
Die Folge $h$ kommt in einen Spaltenvektor, also Dimension $N_h \times 1 = 3 \times 1$,
und realisiert die Gewichte.
%
Produkt von Toeplitz-Matrix und Gewichtungsvektor ergibt das Faltungsergebnis,
wobei das erste Element davon dem Zeitindex $k_y = k_x + k_h = 1 + 0 = 1$ zuzuordnen
ist, so wie wir das oben schon diskutiert haben.
%
Die Linearkombination von Toeplitz-Matrix-Spaltenvektoren erscheint hier sehr geeignet,
das Ergebnis auf sehr übersichtliche Weise zu berechnen:
%
\begin{align}
\begin{pmatrix}
1 & 0 & 0 \\
1 & 1 & 0 \\
2 & 1 & 1 \\
-1 & 2 & 1 \\
0 & -1 & 2 \\
0 & 0 & -1
\end{pmatrix}
\cdot
\begin{pmatrix}
2\\1\\-1
\end{pmatrix}
=
(2) \cdot
\begin{pmatrix}
1\\
1\\
2\\
-1\\
0 \\
0
\end{pmatrix}
\quad+\quad
(1) \cdot
\begin{pmatrix}
0\\
1\\
1\\
2\\
-1\\
0
\end{pmatrix}
\quad+\quad
(-1) \cdot
\begin{pmatrix}
0 \\
0 \\
1 \\
1 \\
2 \\
-1
\end{pmatrix}
=
\begin{pmatrix}
2 \\
3 \\
4 \\
-1 \\
-3 \\
1
\end{pmatrix}
\end{align}

Wenn wir die $k_y = k_x + k_h$ Regel nicht mögen, können wir auch beide Signale
beim Index Null anfangen zu betrachten, dann beginnt das Faltungsergebnis automatisch
beim Zeitindex $k_y = 0 + 0$. Das geht natürlich nur, wenn
die Signale wirklich Null sind für $k<0$ und es ist u.U. sehr aufwändig, wenn
sehr viele Nullen ab $k=0$ auftauchen, bevor die Signale 'richtig losgehen'. Hier im
Beispiel ist es vergleichsweise überschaubar, weil wir nur das zusätzliche
Sample bei $x[k=0]$ mit in der Toeplitz Matrix berücksichtigen müssen.
Also, $N_x = 5$, $N_h = 3$, daher Faltungsergebnis mit der Länge $N_y = N_x + N_h -1 = 7$ und
daher Toeplitz-Dimension $N_y \times N_h = 7 \times 3$.
%
Erneut Linearkombination
\begin{align}
\begin{pmatrix}
0 & 0 & 0 \\
1 & 0 & 0 \\
1 & 1 & 0 \\
2 & 1 & 1 \\
-1 & 2 & 1 \\
0 & -1 & 2 \\
0 & 0 & -1
\end{pmatrix}
\cdot
\begin{pmatrix}
2\\1\\-1
\end{pmatrix}
=
(2) \cdot
\begin{pmatrix}
0 \\
1\\
1\\
2\\
-1\\
0 \\
0
\end{pmatrix}
\quad+\quad
(1) \cdot
\begin{pmatrix}
0 \\
0\\
1\\
1\\
2\\
-1\\
0
\end{pmatrix}
\quad+\quad
(-1) \cdot
\begin{pmatrix}
0 \\
0 \\
0 \\
1 \\
1 \\
2 \\
-1
\end{pmatrix}
=
\begin{pmatrix}
0 \\
2 \\
3 \\
4 \\
-1 \\
-3 \\
1
\end{pmatrix}
\end{align}
%
bringt im Ergebnisspaltenvektor das Signal $y[k]$ für $0 \leq k \leq 6$.

Wir sehen, dass die diskrete Faltung sehr eng verküpft ist mit linearer Algebra, speziell
mit Toeplitz-Matrizen. Das ist gut so, denn dann ist die Faltung auf ganz natürliche Weise
eingebettet in die Mathematik und keine reine SigSys-Erfindung.

\newpage
\noindent\textbf{Lösungsweg III: Mit Umweg über die z-Transformation}

\noindent Dieser Lösungsweg passt eigentlich hier didaktisch nicht, weil wir bestimmtes
Wissen noch nicht haben.
Er ist aber hin und wieder in der Klausur benutzt worden und führt, wenn man sich
beim Ausmultiplizieren nicht vertut, auch vergleichsweise schnell zum Ergebnis.
Daher soll er hier der Vollständigkeit und als Ausblick wo es hingeht, mit betrachtet werden.

Zunächst schreiben wir die beiden Signale in Form gewichteter Dirac Impulse, also
%
\begin{align}
&x[k] = 1 \cdot \delta[k-1] + 1 \cdot \delta[k-2] + 2 \cdot \delta[k-3]  - 1 \cdot \delta[k-4]\\
&h[k] = 2 \cdot \delta[k] + 1 \cdot \delta[k-1] - 1 \cdot \delta[k-2]
\end{align}
%
Mit den Korrespondenzen (vom Wesen bekannt: Dirac ist neutral,
zeitliche Verschiebung dreht 'Phase';
hier nun aber etwas komplizierter als nur die Phase, weil $z^{-\kappa}$)
$$\delta[k] \ztransf 1$$
$$x[k - \kappa] \ztransf X(z) z^{-\kappa}$$
und der Dualität (Faltung vs. Multiplikation)
$$x[k] \ast_k h[k] \ztransf X(z) \cdot H(z)$$
können wir zunächst $z$-transformieren
\begin{align}
&X(z) = 1 \cdot z^{-1} + 1 \cdot z^{-2} + 2 \cdot z^{-3}  - 1 \cdot z^{-4}\\
&H(z) = 2 \cdot z^{0} + 1 \cdot z^{-1} - 1 \cdot z^{-2}
\end{align}
und dann (Konzentration beim Ausmultiplizieren und beim gleiche Potenzen zusammensammeln)
\begin{align}
Y(z) = X(z)\cdot H(z) =
&(1 \cdot z^{-1} + 1 \cdot z^{-2} + 2 \cdot z^{-3}  - 1 \cdot z^{-4}) \cdot
(2 \cdot z^{0} + 1 \cdot z^{-1} - 1 \cdot z^{-2})\\
=
&2  z^{-1} + 3 z^{-2} + 4 z^{-3} - z^{-4} - 3 z^{-5} + z^{-6}
\end{align}
und dann mit inverser z-Transformation
\begin{align}
y[k] =
2  \delta[k-1] + 3 \delta[k-2] + 4 \delta[k-3] - \delta[k-4] - 3 \delta[k-5] + \delta[k-6]
\end{align}
finden.
Streng genommen, müssten wir hier noch Konvergenzbereichbetrachtungen durchführen,
was wir uns mal für später aufheben.


\newpage
\subsection{Faltungssumme für zwei endliche, zeitdiskrete Signale---Lösungsweg IV}
\label{sec:4CBF4358D5}
\begin{Ziel}
Nochmal eine Faltungssumme zweier endlicher Signale. Diesmal analytische
Rechnerei in aller Ausführlichkeit, damit wir sehen, was die Formel macht.
Nachdem wir die Toeplitz-Matrix Methode und den Umweg über z-Transformation
aus der vorhigen Aufgabe kennen, wird
uns das hier vielleicht sehr umständlich vorkommen. Es komplettiert aber die
Sicht auf die Dinge.
Damit es ein bisschen spannend bleibt, nehmen wir nun mal zwei andere Signale.
\end{Ziel}
\textbf{Aufgabe} {\tiny 4CBF4358D5}: Berechnen Sie die Faltung $y[k] = x[k] * h[k]$
für
\begin{align}
&x[k] = 1\cdot\delta[k-2] + 2\cdot\delta[k-3] + 3\cdot\delta[k-4] + 4\cdot\delta[k-5]\\
&h[k] = 8\cdot\delta[k+2] + 7\cdot\delta[k]   + 6\cdot\delta[k-1] + 5\cdot\delta[k-2]
\end{align}
%\begin{align}
%&x[k] = [1,2,3,4] \quad &\mathrm{for} \quad &k = [2,3,4,5]\\
%&h[k] = [8,0,7,6,5] \quad &\mathrm{for} \quad &k = [-2,-1,0,1,2]
%\end{align}
und skizzieren Sie die Signale $x[k]$, $h[k]$, $y[k]$.

Es ist sinnvoll auch die Lösungswege aus Aufgabe \ref{sec:FD58EEB1EC}
für diese beiden Signale durchzuspielen. Jede Klausur hat eine Faltungsaufgabe
zum Üben, checken können wir mit Python/Matlab, vgl. \texttt{convolution\_discrete\_4CBF4358D5.ipynb}.

%\begin{Werkzeug}
%\end{Werkzeug}
%\begin{Ansatz}
%\end{Ansatz}
%\begin{ExCalc}
%\end{ExCalc}
\begin{Loesung}
%% Signal x[k], h[k]
\begin{center}
%
\begin{tikzpicture}[scale=0.5]
\def\tic{0.1};
\begin{scope}
\draw[help lines, C7!50, step=1cm] (0,0) grid (5,4);
\draw[->] (0,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,0) -- (0,5) node[above]{$x[k]$};
\foreach \x in {0,1,2,3,4,5}{\draw (\x,+\tic) -- (\x,-\tic)  node[below]{$\x$};};
\foreach \y in {0, 1, 2, 3, 4}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
%
\draw[stem] plot coordinates{(0,0) (1,0) (2,1) (3,2) (4,3) (5,4) (6,0)};
%
\end{scope}
%
\begin{scope}[xshift=11cm]
\def\g{0.5}
\draw[help lines, C7!50, step=\g cm] (-2,0) grid (4,4);
\draw[->] (-3,0) -- (4,0) node[right]{$k$};
\draw[->] (0,0) -- (0,5) node[above]{$h[k]$};
\foreach \x in {-2,0,2,4}{\draw (\x,+\tic) -- (\x,-\tic)  node[below]{$\x$};};
\foreach \y in {2,4,6,8}{\draw (\tic,\y*\g) -- (-\tic,\y*\g)  node[left]{$\y$};};
%
\draw[stem] plot coordinates{ (-3,0*\g) (-2,8*\g) (-1,0*\g) (0,7*\g) (1,6*\g) (2,5*\g) (3,0*\g)};
%
\end{scope}
%
\begin{scope}[xshift=5.5cm, yshift=-10cm]
\def\g{0.1}
\draw[help lines, C7!50, step=0.5cm] (0,0) grid (8,7);
\draw[->] (0,0) -- (9,0) node[right]{$k$};
\draw[->] (0,0) -- (0,7) node[above]{$y[k]$};
\foreach \x in {0,2,4,6,8}{\draw (\x,+\tic) -- (\x,-\tic)  node[below]{$\x$};};
\foreach \y in {0,10,20,30,40,50,60}{\draw (\tic,\y*\g) -- (-\tic,\y*\g)  node[left]{$\y$};};
%
\draw[stem] plot coordinates{ (0,8*\g) (1,16*\g) (2,31*\g) (3,52*\g) (4,38*\g) (5,56*\g) (6,39*\g) (7,20*\g) (8,0*\g)};
%
\end{scope}
%
\end{tikzpicture}
\end{center}

$k_x=2$, $k_h=-2$, also $k_y=k_x+k_y = 0$
$N_x=4$, $N_h=5$, also $N_y=N_x + N_h -1 = 8$
%
\begin{align}
y[k] =&
8\,\delta[k]+
16\,\delta[k-1]+
31\,\delta[k-2]+
52\,\delta[k-3]+
38\,\delta[k-4]\nonumber\\
&+56\,\delta[k-5]+
39\,\delta[k-6]+
20\,\delta[k-7]
\end{align}
%
Im Folgenden ist eine Rechnung Schritt für Schritt durchgeführt.
\end{Loesung}



\clearpage
%% k = 0
Für die ausführliche analytische Lösung, wählen wir für das zu spiegelnde/verschiebende
Signal $x[k]$.
D.h. nach Variablensubstitution zu $\kappa$ ergibt die zeitliche
Drehung und Verschiebung $x[-\kappa+k]=x[k-\kappa]$.
%
Wir können feststellen, dass hier $y[k<0]=0$ und $y[k>N_y-1]=0$, d.h.
wir müssen das Faltungsergebnis für $0\leq k \leq N_y-1$ ermitteln.
%
Bei der Faltung zweier endlicher Signale, bestimmt das aktuelle $k$, welche $\kappa$
wir in der Faltungssumme berücksichtigen müssen.
Es ist daher hilfreich, wenn wir uns das kleinste und größte $\kappa$ suchen,
so dass potentiell alle Nicht-Null-Signalwerte für $x[\nu=k-\kappa]$ and $h[\nu=\kappa]$
berücksichtigt werden.
Für $k=0$, führt das zu
\begin{itemize}
\item $\kappa=-5$, weil $x[\nu=k-\kappa=5]=4$, $h[\nu=\kappa=5]=0$
\item $\kappa=+2$, weil $x[\nu=k-\kappa=-2]=0$, $h[\nu=\kappa=2]=5$
\end{itemize}
Dafür können wir jetzt die Faltungssumme im Detail aufschreiben
(das länglich, umständlich aufgeschriebene Berücksichtigen von Summentermen
entspricht in der zeitkontinuierlichen Welt der Integraloperation bei der Faltung):
%
\begin{align}
y[k=0] = &\sum\limits_{\kappa = -5}^{+2} x[0 -\kappa] \cdot h[\kappa] =\\
&x[0 -(-5)] \cdot h[-5]\nonumber\\
+&x[0 -(-4)] \cdot h[-4]\nonumber\\
+&x[0 -(-3)] \cdot h[-3]\nonumber\\
+&x[0 -(-2)] \cdot h[-2]\nonumber\\
+&x[0 -(-1)] \cdot h[-1]\nonumber\\
+&x[0 -(0)] \cdot h[0]\nonumber\\
+&x[0 -(1)] \cdot h[1]\nonumber\\
+&x[0 -(2)] \cdot h[2]
\end{align}
In einem zweiten Schritt können wir nun genau die Terme finden, die durch
Multiplikation nicht zu Null werden (weil da eins der beiden Signale den Wert
Null hat).
Dazu können wir alle Terme analytisch einzeln durchgehen, oder uns das wie
in der vorherigen Aufgabe~\ref{sec:FD58EEB1EC} grafisch überlegen.
Wir kommen für $k=0$ darauf, dass nur bei $\kappa=-2$ die beiden Signale so
überlagern, dass deren Multiplikation in die Faltungssumme eingeht, also
\begin{align}
y[k=0] = & \sum\limits_{\kappa = -2}^{-2} x[0 -\kappa] \cdot h[\kappa] =\\
&x[0 -(-2)] \cdot h[-2] = 1 \cdot 8 = 8\nonumber
\end{align}
Dies ist dann auch schon unser erster Ergebniswert der Faltung. Für alle weiteren
$k$ werden die beiden hier diskutierten Schritte im Detail aufgezeigt und
wir errechnen dadurch sukzessive alle weiteren Ergebniswerte.

\clearpage
%% k = 1
\begin{align}
y[k=1] = &\sum\limits_{\kappa = -4}^{+2} x[1 -\kappa] \cdot h[\kappa] =\\
&x[1 -(-4)] \cdot h[-4]\nonumber\\
+&x[1 -(-3)] \cdot h[-3]\nonumber\\
+&x[1 -(-2)] \cdot h[-2]\nonumber\\
+&x[1 -(-1)] \cdot h[-1]\nonumber\\
+&x[1 -(0)] \cdot h[0]\nonumber\\
+&x[1 -(1)] \cdot h[1]\nonumber\\
+&x[1 -(2)] \cdot h[2]\nonumber\\
y[k=1] = & \sum\limits_{\kappa = -2}^{-1} x[1 -\kappa] \cdot h[\kappa] =\nonumber\\
&x[1 -(-2)] \cdot h[-2]\nonumber\\
+&x[1 -(-1)] \cdot h[-1] = 2\cdot 8 + 1\cdot 0 = 16\nonumber
\end{align}

%\clearpage
%% k = 2
\begin{align}
y[k=2] =& \sum\limits_{\kappa = -3}^{+2} x[2 -\kappa] \cdot h[\kappa] =\\
&x[2 -(-3)] \cdot h[-3]\nonumber\\
+&x[2 -(-2)] \cdot h[-2]\nonumber\\
+&x[2 -(-1)] \cdot h[-1]\nonumber\\
+&x[2 -(0)] \cdot h[0]\nonumber\\
+&x[2 -(1)] \cdot h[1]\nonumber\\
+&x[2 -(2)] \cdot h[2]\nonumber\\
y[k=2] = & \sum\limits_{\kappa = -2}^{0} x[2 -\kappa] \cdot h[\kappa] =\nonumber\\
&x[2 -(-2)] \cdot h[-2]\nonumber\\
+&x[2 -(-1)] \cdot h[-1]\nonumber\\
+&x[2 -(0)] \cdot h[0] = 3\cdot 8 + 2\cdot 0 + 1\cdot 7 = 31\nonumber
\end{align}

\clearpage
%% k = 3
\begin{align}
y[k=3] = & \sum\limits_{\kappa = -2}^{+2} x[3 -\kappa] \cdot h[\kappa] =\\
&x[3 -(-2)] \cdot h[-2]\nonumber\\
+&x[3 -(-1)] \cdot h[-1]\nonumber\\
+&x[3 -(0)] \cdot h[0]\nonumber\\
+&x[3 -(1)] \cdot h[1]\nonumber\\
+&x[3 -(2)] \cdot h[2]\nonumber\\
y[k=3] = & \sum\limits_{\kappa = -2}^{+1} x[3 -\kappa] \cdot h[\kappa] =\nonumber\\
&x[3 -(-2)] \cdot h[-2]\nonumber\\
+&x[3 -(-1)] \cdot h[-1]\nonumber\\
+&x[3 -(0)] \cdot h[0]\nonumber\\
+&x[3 -(1)] \cdot h[1] = 4\cdot 8 + 3\cdot 0 + 2\cdot 7 + 1\cdot 6 = 52\nonumber
\end{align}

%\clearpage
%% k = 4
\begin{align}
y[k=4] =& \sum\limits_{\kappa = -2}^{+2} x[4 -\kappa] \cdot h[\kappa] =\\
&x[4 -(-2)] \cdot h[-2]\nonumber\\
+&x[4 -(-1)] \cdot h[-1]\nonumber\\
+&x[4 -(0)] \cdot h[0]\nonumber\\
+&x[4 -(1)] \cdot h[1]\nonumber\\
+&x[4 -(2)] \cdot h[2]\nonumber\\
y[k=4] = & \sum\limits_{\kappa = -1}^{+2} x[4 -\kappa] \cdot h[\kappa] =\nonumber\\
&x[4 -(-1)] \cdot h[-1]\nonumber\\
+&x[4 -(0)] \cdot h[0]\nonumber\\
+&x[4 -(1)] \cdot h[1]\nonumber\\
+&x[4 -(2)] \cdot h[2] = 4\cdot 0 + 3\cdot 7 + 2\cdot 6 + 1\cdot 5 = 38\nonumber
\end{align}

\clearpage
%% k = 5
\begin{align}
y[k=5] = & \sum\limits_{\kappa = -2}^{+3} x[5 -\kappa] \cdot h[\kappa] =\\
&x[5 -(-2)] \cdot h[-2]\nonumber\\
+&x[5 -(-1)] \cdot h[-1]\nonumber\\
+&x[5 -(0)] \cdot h[0]\nonumber\\
+&x[5 -(1)] \cdot h[1]\nonumber\\
+&x[5 -(2)] \cdot h[2]\nonumber\\
+&x[5 -(3)] \cdot h[3]\nonumber\\
y[k=5] = & \sum\limits_{\kappa = 0}^{+2} x[5 -\kappa] \cdot h[\kappa] =\nonumber\\
&x[5 -(0)] \cdot h[0]\nonumber\\
+&x[5 -(1)] \cdot h[1]\nonumber\\
+&x[5 -(2)] \cdot h[2] = 4\cdot 7 + 3\cdot 6 + 2\cdot 5 = 56\nonumber
\end{align}

%\clearpage
%% k = 6
\begin{align}
y[k=6] =& \sum\limits_{\kappa = -2}^{+4} x[6 -\kappa] \cdot h[\kappa] =\\
&x[6 -(-2)] \cdot h[-2]\nonumber\\
+&x[6 -(-1)] \cdot h[-1]\nonumber\\
+&x[6 -(0)] \cdot h[0]\nonumber\\
+&x[6 -(1)] \cdot h[1]\nonumber\\
+&x[6 -(2)] \cdot h[2]\nonumber\\
+&x[6 -(3)] \cdot h[3]\nonumber\\
+&x[6 -(4)] \cdot h[4]\nonumber\\
y[k=6] =& \sum\limits_{\kappa = +1}^{+2} x[6 -\kappa] \cdot h[\kappa] =\nonumber\\
&x[6 -(1)] \cdot h[1]\nonumber\\
+&x[6 -(2)] \cdot h[2] = 4\cdot 6 + 3\cdot 5 = 39\nonumber
\end{align}

\clearpage
%% k=7
\begin{align}
y[k=7] =& \sum\limits_{\kappa = -2}^{+5} x[7 -\kappa] \cdot h[\kappa] =\\
&x[7 -(-2)] \cdot h[-2]\nonumber\\
+&x[7 -(-1)] \cdot h[-1]\nonumber\\
+&x[7 -(0)] \cdot h[0]\nonumber\\
+&x[7 -(1)] \cdot h[1]\nonumber\\
+&x[7 -(2)] \cdot h[2]\nonumber\\
+&x[7 -(3)] \cdot h[3]\nonumber\\
+&x[7 -(4)] \cdot h[4]\nonumber\\
+&x[7 -(5)] \cdot h[5]\nonumber\\
y[k=7] =& \sum\limits_{\kappa = +2}^{+2} x[7 -\kappa] \cdot h[\kappa] =\nonumber\\
+&x[7 -(2)] \cdot h[2] = 4\cdot 5 = 20\nonumber
\end{align}







\newpage
\subsection{Faltungssumme für zwei Rechteckfolgen}
\label{sec:99D5D9F1C9}
\begin{Ziel}
Anhand eines allgemeinen Beispiels, d.h. ohne speziell gegebene Parameter
wollen wir uns die Faltung zweier Rechteckfolgen erarbeiten.
%
Dadurch müssen wir allgemeingültiger über die Faltung nachdenken
und wiederholen ein paar wichtige Zusammenhänge bzgl. der zeitlichen Lage und
Länge des Faltungsergebnisses.
\end{Ziel}
\textbf{Aufgabe} {\tiny 99D5D9F1C9}: Berechnen Sie die zeitdiskrete Faltung
$y[k] = \rectN{M}{k-\kappa_M} \, \ast \,\rectN{N}{k-\kappa_N}$.
Skizzieren Sie die Signale
\begin{align}
x[k]=\rectN{M}{k-\kappa_M}\\
h[k] = \rectN{N}{k-\kappa_N}
\end{align}
und $y[k]$ für den allgemeinen Fall mit
$N,M, \kappa_N, \kappa_M$. Die Variablen $\kappa_N, \kappa_M$ dienen zur Verschiebung der
Rechteckfolgen, sie sind nicht zu verwechseln mit der Faltungshilfsvariable, die wir typisch
auch mit $\kappa$ bezeichnen.
%\begin{Werkzeug}
%\end{Werkzeug}
%
\begin{Ansatz}
Für verschiedene $M$ und $N$ grafisch durchspielen und
daraus eine allgemeingültige Formel ableiten.
\end{Ansatz}
%
\begin{ExCalc}
Wir müssen 'rausfinden':
\begin{itemize}
\item Beginn des Faltungsprodukts bei $k=\kappa_M+\kappa_N$
\item Länge des Faltungsprodukts $L=M+N-1$ Samples
\item Maximalwert der Faltungssumme $\hat{y} = \min\{M,N\}$ bei vollständiger Überlappung der beiden Rechtecksignale
\item Maximalwert $\hat{y}$ im Signal für $|M-N|+1$ Samples in der 'Mitte'
\item Teilüberlappungen am Anfang und am Ende für $\hat{y}-1$ Samples (ohne das Maximum)
\end{itemize}
\end{ExCalc}
\begin{Loesung}
%
Möglichst elegant allgemein aufschreiben. Check mit z.B. Matlab Skript
\texttt{conv\_99D5D9F1C9.m}
\begin{center}
\begin{tikzpicture}[scale=0.5]
\def\tic{0.4};
\draw[->] (-0.5,0) -- (6.5,0) node[right]{$k$};
\draw[->] (0,0) -- (0,1.5) node[above]{$x[k]$};
\draw[stem] plot coordinates{(0,0) (1,1) (2,1) (3,1) (4,1) (5,1) (6,0)};
\foreach \y in {0, 1}{\draw (\tic,\y) -- (-\tic,\y)  node[left]{$\y$};};
\draw (1,\tic) -- (1,-\tic)  node[below]{$\kappa_M$};
\draw (5,\tic) -- (5,-\tic)  node[below]{$\kappa+M-1$};
\begin{scope}[xshift=16cm]
\draw[->] (-5,0) -- (5,0) node[right]{$k$};
\draw[->] (0,0) -- (0,1.5) node[above]{$h[k]$};
\foreach \y in {1}{\draw (\tic,\y) -- (-\tic,\y)  node[above]{$\y$};};
\draw[stem] plot coordinates{ (-4,0) (-3,1) (-2,1) (-1,1) (0,1) (1,1) (2,1) (3,1) (4,0)};
\draw (-3,\tic) -- (-3,-\tic)  node[below]{$\kappa_N$};
\draw (3,\tic) -- (3,-\tic)  node[below]{$\kappa_N+N-1$};
\end{scope}
\end{tikzpicture}
\end{center}
%
\begin{align*}
y[k] &= \begin{cases}
k - \kappa_M-\kappa_N +1 & \text{ für } \kappa_M+\kappa_N \leq k < \kappa_M+\kappa_N+\hat{y} -1\\
\hat{y} & \text{ für } \kappa_M+\kappa_N+\hat{y} - 1 \leq k \leq \kappa_M+\kappa_N+L-\hat{y}\\
\kappa_M+\kappa_N+L-k & \text{ für } \kappa_M+\kappa_N+L-\hat{y} < k \leq \kappa_M+\kappa_N+L-1\\
0 & \text{ sonst} \\
\end{cases}
\end{align*}
%
\begin{center}
\begin{tikzpicture}[scale=1]
\begin{axis}[stemaxis,
x=0.5cm, y=0.5cm,
xtick={3,6,9,12}, x tick label style ={rotate=90},
xticklabels={$\kappa_M+\kappa_N$, $\kappa_M+\kappa_N+\hat{y}-1$,$\kappa_M+\kappa_N+L-\hat{y}$, $\kappa_M+\kappa_N+L-1$},
ytick={4}, yticklabels={$\hat{y}$},
xlabel=$k$, ylabel={$y[k]$},
grid=both]
\addplot[stem2] plot coordinates{(1,0) (2,0) (3,1) (4,2) (5,3) (6,4) (7,4) (8,4) (9,4) (10,3) (11,2) (12,1) (13,0) (14,0)};
\end{axis}
\end{tikzpicture}
\end{center}
%
Wir sollten uns klar machen, dass für $M=N$ ein Dreieckssignal resultiert,
das kennen wir schon aus der zeitkontinuierlichen Signalverarbeitung, nämlich
\begin{align}
\mathrm{tri}(t) = \mathrm{rect}(t) \ast_t \mathrm{rect}(t).
\end{align}
\end{Loesung}
