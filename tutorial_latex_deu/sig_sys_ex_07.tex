\clearpage
\section{UE 7: Abtastung von Signalen und Spektren}

Wir lernen in dieser Übungseinheit die sogenannte äquidistante Abtastung bezüglich
der Variable Zeit (Aufgabe 1) und der Variable (Kreis)-Frequenz (Aufgabe 2) kennen.
%

Dies ist wichtig, um den Übergang zur zeitdiskreten Signalverarbeitung
herstellen zu können.
%
Die meisten (wenn nicht alle?!) natürlich vorkommenden Signale sind zeit- und
wertekontinuierlich.
%
Um die Signale mit einem Rechner verarbeiten zu können, müssen wir sie bzgl. der
Zeit (oder einer anderen Variable, z.B. Ort bei Bild/Video)
diskretisieren (also abtasten) und bzgl. der Werte diskretisieren
(also quantisieren).
%
Nach Abtasten und Quantisieren erhält man ein digitales Signal.
%
Hier in SigSys werden wir nun zunächst die Abtastung kennenlernen, im Mastermodul
Digital Signal Processing folgt dann die Quantisierung.
%

Ein anderer wichtiger Punkt ideale Abtastung und die Rekonstruktion zurück
zu kontinuierlichen Signalen (oder Spektren) als SigSys Werkzeug einzuführen, ist
die Verknüpfung von verschiedenen Fourier Transformationen.
%
Es gibt im Grunde ja keine verschiedenen Fourier Transformationen, sondern
eigentlich 'nur' mindestens 4 verschiedene Typen, die jeweils für eine bestimmte
Signal/Spektrum-Charakteristik gelten.
%
Wir kennen bisher die Fourier Reihe und die Fourier Transformation.
%
Wir werden lernen die beiden über Abtastung und Rekonstruktion elegant zu
verknüpfen, siehe die Vorbetrachtung vor Aufgabe~\ref{sec:45C76AFB33}.

%
\begin{figure}[h]
\centering
\begin{tikzpicture}[align=center,node distance=0.5cm and 0.5cm]
\tikzstyle{block} = [draw, rectangle, minimum height=3em, minimum width=3em]
\begin{scope}
\node (input) {$\displaystyle x(t)$};
\node [draw, circle, right=of input, minimum size=7.5mm] (op1) {$\cdot$};
\node [above=of op1] (sop1) {$s(t)$};
\node [block, right=of op1] (mult) {$1$};
\node [draw, circle, right=of mult, minimum size=7.5mm, xshift=0.5cm] (op2) {$\ast_t$};
\node [above=of op2] (sop2) {$h_\mathrm{r}(t)$};
\node [right=of op2] (output) {$x_\mathrm{r}(t)$};
\draw [->] (input) -- (op1);
\draw [->] (op1) -- (mult);
\draw [->] (mult) node[below, xshift=1.1cm, yshift=0cm] {$x_\mathrm{s}(t)$} -- (op2);
\draw [->] (op2) -- (output);
\draw [->] (sop1) -- (op1);
\draw [->] (sop2) -- (op2);
\node [right=of output, xshift=-0.4cm, yshift=0.5cm] (fourier) {$\fourier$};
\end{scope}
%
\begin{scope}[shift={(8,0)}]
\node (input) {$\displaystyle X(\im\omega)$};
\node [draw, circle, right=of input, minimum size=7.5mm] (op1) {$\ast_\omega$};
\node [above=of op1] (sop1) {$S(\im\omega)$};
\node [block, right=of op1] (mult) {$\frac{1}{2\pi}$};
\node [draw, circle, right=of mult, minimum size=7.5mm, xshift=0.5cm] (op2) {$\cdot$};
\node [above=of op2] (sop2) {$H_\mathrm{r}(\im\omega)$};
\node [right=of op2] (output) {$X_\mathrm{r}(\im\omega)$};
\draw [->] (input) -- (op1);
\draw [->] (op1) -- (mult);
\draw [->] (mult) node[below, xshift=+1.1cm, yshift=0cm] {$X_\mathrm{s}(\im\omega)$} -- (op2);
\draw [->] (op2) -- (output);
\draw [->] (sop1) -- (op1);
\draw [->] (sop2) -- (op2);
\end{scope}
\end{tikzpicture}
\caption{Abtastung und Rekonstruktion für \textbf{zeitliche Signale} mit Dirac Impuls Kamm
$s(t)\fourier  S(\im\omega)$ und Rekonstruktionsfilter $h_\mathrm{r}(t) \fourier H_\mathrm{r}(\im \omega)$.}
\label{fig:sampling_model_time_domain_signals}
\end{figure}
%
\begin{figure}[h]
\centering
\begin{tikzpicture}[align=center,node distance=0.5cm and 0.5cm]
\tikzstyle{block} = [draw, rectangle, minimum height=3em, minimum width=3em]
\begin{scope}
\node (input) {$\displaystyle x(t)$};
\node [draw, circle, right=of input, minimum size=7.5mm] (op1) {$\ast_t$};
\node [above=of op1] (sop1) {$s(t)$};
\node [draw, circle, right=of op1, minimum size=7.5mm, xshift=0.5cm] (op2) {$\cdot$};
\node [above=of op2] (sop2) {$h_\mathrm{r}(t)$};
\node [block, right=of op2] (mult) {$1$};
\node [right=of mult] (output) {$x_\mathrm{r}(t)$};
\draw [->] (input) -- (op1);
\draw [->] (op1) node[below, xshift=0.9cm, yshift=0cm] {$x_\mathrm{s}(t)$} -- (op2);
\draw [->] (op2) -- (mult);
\draw [->] (mult) -- (output);
\draw [->] (sop1) -- (op1);
\draw [->] (sop2) -- (op2);
\node [right=of output, xshift=-0.4cm, yshift=0.5cm] (fourier) {$\fourier$};
\end{scope}
%
\begin{scope}[shift={(8,0)}]
\node (input) {$\displaystyle X(\im\omega)$};
\node [draw, circle, right=of input, minimum size=7.5mm] (op1) {$\cdot$};
\node [above=of op1] (sop1) {$S(\im\omega)$};
\node [draw, circle, right=of op1, minimum size=7.5mm, xshift=0.5cm] (op2) {$\ast_\omega$};
\node [above=of op2] (sop2) {$H_\mathrm{r}(\im\omega)$};
\node [block, right=of op2] (mult) {$\frac{1}{2\pi}$};
\node [right=of mult] (output) {$X_\mathrm{r}(\im\omega)$};
\draw [->] (input) -- (op1);
\draw [->] (op1) node[below, xshift=0.9cm, yshift=0cm] {$X_\mathrm{s}(\im\omega)$} -- (op2);
\draw [->] (op2) -- (mult);
\draw [->] (mult) -- (output);
\draw [->] (sop1) -- (op1);
\draw [->] (sop2) -- (op2);
\end{scope}
\end{tikzpicture}
\caption{Abtastung und Rekonstruktion für \textbf{Frequenz-Spektren} mit Dirac Impuls Kamm
$S(\im\omega) \Fourier s(t)$ und Rekonstruktionsspektrum $H_\mathrm{r}(\im\omega) \Fourier h_\mathrm{r}(t)$.}
\label{fig:sampling_model_frequency_domain_signals}
\end{figure}



\subsection*{Werkzeuge für Abtastung / Rekonstruktion}

Wir brauchen drei wesentliche Zutaten: i) ein Modell als Signalflussgraph und
zwei fundamentale Signale/Spektren: ii) den Dirac Impuls Kamm (Variable $s$ bzw. $S$)
um die Abtastung zu modellieren und iii) Impulsantwort/Fenster bzw. deren
Spektren (Variable $h_\mathrm{r}$ bzw. $H_\mathrm{r}$) für die Rekonstruktion.

\subsubsection*{i) Modell für Abtastung und Rekonstruktion}
Die Modelle sind in \fig{fig:sampling_model_time_domain_signals}
und \fig{fig:sampling_model_frequency_domain_signals} dargestellt. Sie leben
von der Dualität Faltung vs. Multiplikation.
Die Multiplikation des abzutastenden Signals/Spektrums mit einem Dirac Impuls Kamm
bestimmt, in welchem Bereich wir abtasten.
Daher sehen wir in \fig{fig:sampling_model_time_domain_signals} die Abtastung
von Zeitsignalen mit Dirac-Kamm $s(t)$. In \fig{fig:sampling_model_frequency_domain_signals}
sehen wir die Abtastung von Spektren, also Abtastung einer Fouriertransformierten
mit Dirac-Kamm $S(\im\omega)$.









\subsubsection*{ii) Abtastung als Multiplikation mit Dirac Impuls Kamm}
%
In der Übung 4 zur Fouriertransformation hatten wir ein wichtiges
Signalpaar und gleichzeitig eine wichtige Dualität (absichtlich) unterschlagen.
%
Diese soll nun hier im Mittelpunkt stehen, weil wir sie für unser Abtastmodell
brauchen: die Dualität des sogenannten Dirac Impuls Kamms.
%
Genauso wie die Gaussglocke bildet sich der Dirac Impuls Kamm bei der
Fouriertransformation in skalierter Form auf sich selbst ab.
%
Genau dieser Eigenschaft verdanken wir die elegante und kompakte Veranschaulichung
der Signal- oder Spektren-abtastung.

Für das Folgende benutzen wir den kyrillischen Buchstaben $\Sha$ (genannt `Scha`,
gesprochen wie das 'Sch' in Schule oder Shannon) als Formelzeichen.
%
Die Korrespondenz der Fourier Transformation des Dirac Impuls Kamms lautet
\begin{mdframed}
\begin{equation}
\frac{1}{T_\mathrm{s}} {\Sha}(\frac{t}{T_\mathrm{s}}) \quad\fourier\quad
{\Sha}(\frac{\omega T_\mathrm{s}}{2 \pi}) =
\Sha(\frac{\omega}{\omega_\mathrm{s}})
%{\Sha}(\frac{\Omega}{2 \pi})
\end{equation}
\end{mdframed}
mit dem zeitlichen Abtastintervall $T_\mathrm{s} = \frac{1}{f_\mathrm{s}}>0$
und der (Kreis)-Abtastfrequenz
\begin{align}
\omega_\mathrm{s} = \frac{2 \pi}{T_\mathrm{s}}  = 2 \pi f_\mathrm{s}.
\end{align}
%
Diese Korrespondenz ist sehr wichtig und wir müssen in der Lage sein, diese
aus der allgemeinen Definition des Dirac Impuls Kamms (in der Formelsammlung gegeben)
\begin{equation}
{\Sha}(t) := \sum_{m=-\infty}^{+\infty} \delta(t-m)% \quad\mathrm{für}\quad m\in\mathbb{Z}.
\end{equation}
fehlerfrei und schnell ableiten zu können.
%
Dazu brauchen wir die Skalierungseigenschaft des Dirac Impulses ($a\in\mathbb{R}$)
\begin{equation}
\delta(a t) = \frac{1}{|a|} \delta(t) \quad\longleftrightarrow\quad
\delta(t) = |a| \delta(a t),
\end{equation}
wobei die zweitere Darstellung übersichtlicher angewendet werden kann.
%
Für ein beliebiges, zeitliches Abtastintervall $T_\mathrm{s}>0$ können wir
für einen verschobenen Dirac Impuls
\begin{equation}
\delta(t - m T_\mathrm{s}) =
\frac{1}{T_\mathrm{s}}\cdot \delta(\frac{t - m T_\mathrm{s}}{T_\mathrm{s}}) =
\frac{1}{T_\mathrm{s}} \cdot \delta(\frac{t}{T_\mathrm{s}}-m)
\end{equation}
schreiben, wenn wir für die Skalierung $a=\frac{1}{T_\mathrm{s}}$ verwenden.
%
Daraus folgen die äquivalenten Darstellungen, wenn wir eine Summe
verschobener Dirac Impulse einführen
\begin{equation}
\sum_{m=-\infty}^{+\infty} \delta(t-m T_\mathrm{s}) =
\frac{1}{T_\mathrm{s}}\sum_{m=-\infty}^{+\infty} \delta(\frac{t}{T_\mathrm{s}}-m) =
\frac{1}{T_\mathrm{s}} {\Sha}(\frac{t}{T_\mathrm{s}}).
\end{equation}
Die erste Darstellung ist sinnvoll um sich anhand von Skizzen die zeitliche
Lage und das Gewicht $1$ der Dirac Impulse klarzumachen. Die letzte
Darstellung können wir für kompakte Schreibweise bei Rechnungen benutzen. Das
mag zu Beginn unnötig erscheinen, aber erleichtert den Rechen- und Lesefluss
erheblich, sobald wir in dieser Formel im Kopf sofort sehen, wie der Dirac Kamm
ausschaut. Das gelingt mit ein wenig Übung (unbedingt zu empfehlen).
%Vielleicht hilft es, wenn wir
%uns nochmal klarmachen, dass das Signal
%$\frac{1}{T_\mathrm{s}}\mathrm{rect}(\frac{t}{T_\mathrm{s}})$
%eine Rechteckfunktion der Fläche 1 mit Breite $T_\mathrm{s}$ und daher
%Höhe $\frac{1}{T_\mathrm{s}}$ darstellt. Dies ist eine ähnliche Zeit- und
%Amplitudenskalierung.

Wir können die allgemeine Definition des Dirac Impuls Kamms
auch für die Frequenzvariable benutzen, also
\begin{equation}
{\Sha}(\omega) := \sum_{\nu=-\infty}^{+\infty} \delta(\omega-\nu)
%\quad\mathrm{für}\quad \nu\in\mathbb{Z}
\end{equation}
einführen.
Führen wir nun die Kreis-Abtastfrequenz $\omega_\mathrm{s}>0$ ein, mit der Motivation
diesbezüglich ganzzahlig verschobene Dirac Impulse $\delta(\omega - \nu \omega_s)$
zu realisieren.
Erneut die Skalierungseigenschaft angewandt ergibt dann diesmal für
$a=\frac{1}{\omega_\mathrm{s}}$
\begin{equation}
\delta(\omega - \nu \omega_s) =
\frac{1}{\omega_s}\delta(\frac{\omega - \nu \omega_s}{\omega_s}) =
\frac{1}{\omega_s} \cdot \delta(\frac{\omega}{\omega_s}-\nu).
\end{equation}
%
Damit lässt sich jetzt der Link zum Scha-Operator herstellen
\begin{equation}
\omega_s \sum_{\nu=-\infty}^{+\infty} \delta(\omega-\nu \omega_s) =
\frac{\omega_s}{\omega_s} \sum_{\nu=-\infty}^{+\infty} \delta(\frac{\omega}{\omega_s}-\nu) =
{\Sha}(\frac{\omega}{\omega_s}).
\end{equation}
%
In der Formelsammlung ist 'nur' die Korrespondenz
\begin{align}
  \Sha(t) \quad\fourier\quad \Sha(\frac{\omega}{2\pi})
\end{align}
gegeben, die wir nun allgemein auch ohne genaue Kenntnis des Scha-Operators zeitlich
skalieren können, also genauso wie wir das z.B. bei der rect()-Funktion machen würden,
\begin{align}
  \Sha(\frac{t}{T_\mathrm{s}}) \quad\fourier\quad
  T_\mathrm{s} \Sha(\frac{\omega T_\mathrm{s}}{2\pi}).
\end{align}
Wir sehen wegen $\omega_\mathrm{s} = \frac{2 \pi}{T_\mathrm{s}} $,
dass dies exakt das Ergebnis von oben ist, unsere Werkzeuge
sind erfreulicherweise konsistent.
%
Damit erhalten wir zusammenfassend die äquivalenten Korrespondenzen
(aus der Formelsammlung ableitbar, üben...)
\begin{mdframed}
\begin{equation}
\frac{1}{T_\mathrm{s}} {\Sha}(\frac{t}{T_\mathrm{s}}) \quad\fourier\quad
{\Sha}(\frac{\omega T_\mathrm{s}}{2 \pi}) =
\Sha(\frac{\omega}{\omega_\mathrm{s}})
%{\Sha}(\frac{\Omega}{2 \pi})
\end{equation}
\end{mdframed}
Für Skizzen und tatsächliche Rechnungen ist eventuell anschaulicher
\begin{mdframed}
\begin{equation}
\sum_{m=-\infty}^{+\infty} \delta(t-m T_\mathrm{s}) \quad\fourier\quad
\omega_s \sum_{\nu=-\infty}^{+\infty} \delta(\omega-\nu \omega_s)
\end{equation}
\end{mdframed}
%
In \fig{fig:DiracImpulsKammSkizze} ist die Korrespondenz der Dirac Impuls Kämme
skizziert, dies werden wir sehr oft brauchen bzw. zur Veranschaulichung benutzen
müssen.

\begin{figure}[h!]
\centering
%
\begin{tikzpicture}[scale=0.75]
\begin{scope}
\draw[->] (-2.1 ,0) -- (2.4,0) node[right]{$t$};
\draw[->] (0,-1.1) -- (0,1.75) node[above]{$x(t)=\frac{1}{T_\mathrm{s}}\Sha(\frac{t}{T_\mathrm{s}})$};
\draw[->, C0, line width=1mm] (+0,0) -- (+0,1);
\draw[->, C0, line width=1mm] (-1,0) -- (-1,1);
\draw[->, C0, line width=1mm] (-2,0) -- (-2,1);
\draw[->, C0, line width=1mm] (-3,0) -- (-3,1);
\draw[->, C0, line width=1mm] (1,0) -- (1,1) node[above] {$(1)$};
\draw[->, C0, line width=1mm] (2,0) -- (2,1);
\draw[->, C0, line width=1mm] (3,0) -- (3,1);
\node at (4,0) {$\fourier$};
\node at (1,-0.4) {$T_\mathrm{s}$};
\node at (-1,-0.4) {$-T_\mathrm{s}$};
\node at (2,-0.4) {$2 T_\mathrm{s}$};
\end{scope}
\begin{scope}[shift={(8,0)}]
\draw[->] (-2.1 ,0) -- (2.4, 0) node[right]{$\omega$};
\draw[->] (0,-1.1) -- (0,1.75) node[above]{$X(\im\omega)=\Sha(\frac{\omega T_\mathrm{s}}{2\pi})$};
\draw[->, C3, line width=1mm] (+0,0) -- (+0,1);
\draw[->, C3, line width=1mm] (-1,0) -- (-1,1);
\draw[->, C3, line width=1mm] (-2,0) -- (-2,1);
\draw[->, C3, line width=1mm] (-3,0) -- (-3,1);
\draw[->, C3, line width=1mm] (1,0) -- (1,1) node[above] {$(\omega_\mathrm{s})$};
\draw[->, C3, line width=1mm] (2,0) -- (2,1);
\draw[->, C3, line width=1mm] (3,0) -- (3,1);
\node at (1,-0.4) {$\omega_\mathrm{s}$};
\node at (-1,-0.4) {$-\omega_\mathrm{s}$};
\node at (2,-0.4) {$2 \omega_\mathrm{s}$};
\end{scope}
\end{tikzpicture}
%
%
%

\caption{Korrespondenz der Fourier Transformation für den Dirac Impuls Kamm.
Dirac Impulse sind äquidistant bzgl. der Zeitachse (links) und
der Frequenzachse (rechts). Zeit-Austast-Intervall $T_\mathrm{s}$.
Kreis-Frequenz-Austast-Intervall $\omega_\textrm{s}=\frac{2\pi}{T_\mathrm{s}}$.
%
Dirac Gewichte 1 im Zeitbereich. Dirac Gewichte $\omega_\text{s}$ im Spketralbereich.}
\label{fig:DiracImpulsKammSkizze}
\end{figure}


\textbf{Hinweis I:} In der Praxis arbeiten und denken wir wahrscheinlich
lieber mit der physikalischen
Frequenz $f$ als mit der Kreisfrequenz $\omega$. Es bietet sich jedoch hier an, bei der Denke
mit Kreisfrequenzen zu bleiben, weil wir dann konsistent in unserer SigSys-Welt
weitermachen können. Andere Argumentation: jetzt bei der Abtastung von Zeitsignalen
die physikalische Frequenz $f$ zu benutzen, erscheint vielleicht elegant,
weil zunächst einfacher vorstellbar und praxisbezogener,
aber macht wegen vielen Umnormierungen mehr Arbeit und bietet Raum für
Schusselfehler und Verwirrung.
Daher die Empfehlung, SigSys einfach weiter mit $\omega$ durchzuziehen,
alle Aufgaben sind auch so gestellt. Wenn die SigSys Tools dann sitzen, ist die
Transferleistung zu physikalischen Frequenzen $f$ vergleichsweise einfach, z.B.
ganz am Schluss von Rechnungen bei der grafischen Darstellung.


\subsubsection*{iii) Rekonstruktion}
Aus der Formelsammlung und den bisher behandelten Themen kennen wir vier
Korrespondenzen der Fourier Transformation die für eine Rekonstruktion
in Frage kommen könnten (vgl. \fig{fig:ReconstructionSplines})
\begin{align}
h_\mathrm{r}(t) \quad\fourier\quad  & H_\mathrm{r}(\im\omega)\\
\text{rect}(t) \quad\fourier\quad  &\text{sinc}\left( \frac{\omega}{2} \right)\text{ für Abtastung im Zeit-/Frequenzbereich}\\
\text{sinc}(t)  \quad\fourier\quad  &\pi \,\text{rect}\left(\frac{\omega}{2}\right)\text{ für Abtastung im Zeit-/Frequenzbereich}\\
\Lambda(t) \quad\fourier\quad  &\text{sinc}^2\left( \frac{\omega}{2} \right)  \text{ für Abtastung im Zeitbereich}\\
\text{sinc}^2\left( t \right) \quad\fourier\quad  &\pi\Lambda(\frac{\omega}{2})\text{ für Abtastung im Frequenzbereich}
\end{align}
Es gibt natürlich viel mehr Korrespondenzen, die für die Praxis auch deutlich mehr
Sinn ergeben. Aber das ist dann Spezialwissen, wenn wir
Rekonstruktion vertiefter betreiben wollen, Stichwort wäre hier u.a. Splines.
Wir beschränken uns hier darauf das Wesen der Rekonstruktion didaktisch möglichst
zugänglich zu gestalten und dafür sind ideale Modelle sehr gut geeignet.

Für die \textbf{ideale Abtastung und Rekonstruktion im Zeitbereich} benutzen
wir in dieser Übung
\begin{align}
h_\mathrm{r}(t) = \frac{1}{\pi}\text{sinc}(t)
\quad\fourier\quad
H_\mathrm{r}(\im\omega) = \text{rect}\left(\frac{\omega}{2}\right).
\end{align}
Wenn wir $h_\mathrm{r}(t)$ als Impulsantwort eines LTI-Systems auffassen (laut
Modell in Abb.~\ref{fig:sampling_model_time_domain_signals} falten wir mit diesem Signal), können wir
dessen Spektrum als ideales Tiefpassfilter mit Grenzfrequenz $\omega_c=1$ rad/s auffassen (vgl. gestreckte Rechteckfunktion).
%

Für die \textbf{ideale Abtastung und Rekonstruktion im Frequenzbereich} benutzen
wir in dieser Übung
\begin{align}
H_\mathrm{r}(\im\omega) = \text{sinc}\left( \frac{\omega}{2} \right)
\quad\Fourier\quad
h_\mathrm{r}(t)  = \text{rect}(t)
\end{align}
Wir können $h_\mathrm{r}(t)$ als Zeitfenster um $t=0$ mit Breite 1 auffassen,
weil wir laut Modell in Abb.~\ref{fig:sampling_model_frequency_domain_signals}
damit multiplizieren.
Mit diesen Rekonstruktionen wurde das Abtasttheorem initial eingeführt und
bewiesen. Eine historische Abhandlung und wie diese Rekonstruktion
aus einer verallgemeinernden Sichtweise einzuordnen ist, findet sich in
\url{https://doi.org/10.1109/5.843002}.

\textbf{Hinweis II}: Wir können uns das nicht oft genug klarmachen: die ganzen
Formeln der Transformationen interessieren sich nicht welchen Bereich wir wie
interpretieren,
also was wir als Zeitbereich und was als Frequenzbereich deklarieren. Daher werden
wir alle Dinge die wir für einen Bereich lernen, also Signaloperationen, Zusammenhänge usw.
auch im anderen Bereich wieder entdecken, denken wir an die Modulations-/Verschiebungsdualität,
die uns schon oft nützlich war.
Hier ist es nun die Abtastung, die wir in beiden Domänen anwenden können und
im Grunde nicht zwei völlig verschiedene Dinge erlernen müssen. Bis auf ein
paar Normierungen ist das Gedankenkonstrukt völlig identisch. Kopfweh macht
erfahrungsgemäß das sichere Hin- und Herspringen zwischen dem deklarierten
Zeit- und Bildbereich,
das braucht Übung und auch Erfahrung, zugegeben! Es wird uns aber allgemein
einfacher fallen, wenn wir Abtastung als fundamentale Operation
nicht nur als Spezialfall im Zeitbereich einführen, sondern als fundamentaleres
Konzept. Daher unser didaktischer Faden in der Vorlesung und hier in der
Übung.



\begin{figure}
\includegraphics[width=\textwidth]{../sampling/ReconstructionSplines.pdf}
  \caption{Für die \textbf{Abtastung im Zeitbereich}: Impulsantworten (links) und
  Spektren (rechts) von
  Rekonstruktionsfiltern. In blau, links die Sinc-Impulsantwort des idealen
  Tiefpassfilters mit zugehörigem Rechtecksprektrum (rechts),
  \texttt{ReconstructionSplines.ipynb}}
  \label{fig:ReconstructionSplines}
\end{figure}



\clearpage
\subsection{Abtastung und Rekonstruktion eines Zeitsignals: Sinus}
\label{sec:EF235EE3D8}
\begin{Ziel}
Wir wollen das ideale Abtast- und Rekonstruktionsmodell einmal
anhand speziell gewählter Parameter durchspielen, sowohl im Zeitbereich, als
in der nächsten Aufgabe dann auch im Bildbereich. Wir werden wieder sehen,
dass einfach zu interpretierende
Ergebnisse in einem Bereich, schwer zugängliche Darstellungen im anderen Bereich
bedingen. Hier wird uns der Frequenzbereich eine deutlich anschaulichere Lösung
liefern. Quasi während unserer Rechnerei werden wir auf die
Sinc-Interpolationsformel im Zeitbereich stoßen, die als Grundlage des
Abtasttheorems 1925 (Whittaker) bzw. 1933 (Kotelnikov) streng bewiesen wurde, vgl.
\url{https://en.wikipedia.org/wiki/Nyquist-Shannon_sampling_theorem}
\end{Ziel}
\textbf{Aufgabe} {\tiny EF235EE3D8}:
Für das dargestellte zeitliche Abtast- und Rekonstruktionsmodell
\begin{center}
\begin{tikzpicture}[align=center,node distance=0.5cm and 0.5cm]
\tikzstyle{block} = [draw, rectangle, minimum height=3em, minimum width=3em]
\begin{scope}
\node (input) {$\displaystyle x(t)$};
\node [draw, circle, right=of input, minimum size=7.5mm] (op1) {$\cdot$};
\node [above=of op1] (sop1) {$s(t)$};
\node [block, right=of op1] (mult) {$1$};
\node [draw, circle, right=of mult, minimum size=7.5mm, xshift=0.5cm] (op2) {$\ast_t$};
\node [above=of op2] (sop2) {$h_\mathrm{r}(t)$};
\node [right=of op2] (output) {$x_\mathrm{r}(t)$};
\draw [->] (input) -- (op1);
\draw [->] (op1) -- (mult);
\draw [->] (mult) node[below, xshift=1.1cm, yshift=0cm] {$x_\mathrm{s}(t)$} -- (op2);
\draw [->] (op2) -- (output);
\draw [->] (sop1) -- (op1);
\draw [->] (sop2) -- (op2);
\node [right=of output, xshift=-0.4cm, yshift=0.5cm] (fourier) {$\fourier$};
\end{scope}
%
\begin{scope}[shift={(8,0)}]
\node (input) {$\displaystyle X(\im\omega)$};
\node [draw, circle, right=of input, minimum size=7.5mm] (op1) {$\ast_\omega$};
\node [above=of op1] (sop1) {$S(\im\omega)$};
\node [block, right=of op1] (mult) {$\frac{1}{2\pi}$};
\node [draw, circle, right=of mult, minimum size=7.5mm, xshift=0.5cm] (op2) {$\cdot$};
\node [above=of op2] (sop2) {$H_\mathrm{r}(\im\omega)$};
\node [right=of op2] (output) {$X_\mathrm{r}(\im\omega)$};
\draw [->] (input) -- (op1);
\draw [->] (op1) -- (mult);
\draw [->] (mult) node[below, xshift=+1.1cm, yshift=0cm] {$X_\mathrm{s}(\im\omega)$} -- (op2);
\draw [->] (op2) -- (output);
\draw [->] (sop1) -- (op1);
\draw [->] (sop2) -- (op2);
\end{scope}
\end{tikzpicture}
\end{center}
soll für
\begin{align}
x(t)= \sin(3 t)\qquad
%\end{align}
%
%\begin{align}
s(t) = \frac{2}{\pi} {\Sha}(\frac{2 t}{\pi})\qquad
%\end{align}
%
%\begin{align}
H_r(\mathrm{j}\omega) = \frac{\pi}{2}\mathrm{rect}(\frac{\omega}{4})
\end{align}
die Abtastung und die Rekonstruktion berechnet und skizziert werden.

\begin{itemize}
  \item Berechnen Sie die Spektren $X(\im\omega)$, $S(\im\omega)$, $X_\mathrm{s}(\im\omega)$, $X_\mathrm{r}(\im\omega)$.
  \item Berechnen Sie die Signale $x_\mathrm{s}(t)$, $h_\mathrm{r}(t)$ und $x_\mathrm{r}(t)$.
  \item Skizzieren Sie alle Signale, d.h. $x(t)$, $s(t)$, $x_\mathrm{s}(t)$, $h_\mathrm{r}(t)$ und $x_\mathrm{r}(t)$
  \item Skizzieren Sie alle Spektren, d.h.  $X(\im\omega)$, $S(\im\omega)$, $X_\mathrm{s}(\im\omega)$, $H_\mathrm{r}(\im\omega)$ und $X_\mathrm{r}(\im\omega)$
  \item Ist die Rekonstruktion des Zeitsignals erfolgreich?
\end{itemize}






\begin{Werkzeug}
Alles was wir bisher im SigSys Koffer sortiert vorfinden :-)
\end{Werkzeug}
\begin{Ansatz}
Wir finden zunächst für alle gegebenen Signale und Spektren die direkten
Fouriertransformierten.

\textbf{Eingang, Signal und Spektrum}:
Wir haben
\begin{equation}
x(t) = \sin(\omega_0 t) = \sin(3 t),
\end{equation}
also  $\omega_0=3$ rad/s gegeben. Das sind 3 Schwingungen pro $2\pi$ oder eben
als Periodendauer $T_0 = \frac{2\pi}{3}$ s.
Die blaue Kurve in \fig{fig:EF235EE3D8_TimeDomain} zeigt das Sinussignal.
Daraus folgt die Fourier Transformierte
\begin{equation}
X(\mathrm{j} \omega) =
\mathrm{j} \pi \left( \delta(\omega+\omega_0) - \delta(\omega-\omega_0) \right) =
\mathrm{j} \pi \left( \delta(\omega+3) - \delta(\omega-3) \right),
\end{equation}
also ein rein imagiäres, ungerades Spektrum. Es ist in \fig{fig:Sampling_02_Sine_EF235EE3D8}
dargestellt.

\textbf{Abtastung mit Dirac Impuls Kamm, Signal und Spektrum}:
Wir können $T_\mathrm{s} = \frac{\pi}{2}$ und
$\omega_\mathrm{s} = \frac{2 \pi}{T_\mathrm{s}} = \frac{2 \pi}{\frac{\pi}{2}} = 4$
herauslesen und damit die Korrespondenz
\begin{equation}
s(t) = \frac{2}{\pi} {\Sha}(\frac{2 t}{\pi}) =
\sum_{m=-\infty}^{+\infty} \delta(t-m \frac{\pi}{2})
\quad\fourier\quad
S(\mathrm{j}\omega) = {\Sha}(\frac{\omega}{4}) =
4 \sum_{\nu=-\infty}^{+\infty} \delta(\omega-4 \nu)
\end{equation}
angeben. Das Spektrum, also der Dirac Impuls Kamm $S(\mathrm{j}\omega)$
ist in \fig{fig:Sampling_01_DiracComb_EF235EE3D8}
dargestellt. Hier erfolgt die Darstellung mit Pfeil und Gewicht so wie wir es
für den Dirac Impuls eingeführt haben.

In \fig{fig:EF235EE3D8_TimeDomain} ist der Dirac Impuls Kamm $s(t)$ des Zeitbereichs
in rot dargestellt. Hier erfolgt die Darstellung der Dirac Impulse leicht abgewandelt
mit einer Raute. Es ist leichter in dem Diagramm alle beteiligten Signale einheitlich
zu programmieren und wir stellen so die Verknüpfung zur sogenannten
\texttt{stem}-Darstellung von diskreten Folgen her, auch wenn $s(t)$ streng genommen
noch keine zeitdiskrete Folge ist.

\textbf{Rekonstruktionsfilter mit idealem Tiefpass, Signal und Spektrum}:
Wir sind mittlerweile sehr sicher bei den Korrespondenzen zur Rechteck- und
Spaltfunktion und finden
\begin{equation}
h_\mathrm{r}(t) = \mathrm{sinc}(2 t) \quad\fourier\quad
H_\mathrm{r}(\mathrm{j}\omega) = \frac{\pi}{2}\mathrm{rect}(\frac{\omega}{4}).
\end{equation}

Die Impulsantwort ist in \fig{fig:Sampling_05_LowpassIR_EF235EE3D8} aufgetragen,
das Spektrum, also der Frequenzgang in \fig{fig:Sampling_04_LowpassSpectrum_EF235EE3D8}.
Es handelt sich um das ideale Tiefpassfilter (das Filter als Neutrum ist die in der
Signalverarbeitung üblichere Bezeichnung) mit einer Grenzfrequenz von $\omega_c=2$ rad/s.
Das Filter lässt Signalanteile der Frequenzen $0\leq |\omega_c|<2$ perfekt passieren
(mit Amplitude $\nicefrac{\pi}{2}$ gewichtet), höherfrequente
Signalanteile, also $|\omega_c|>2$, werden perfekt unterdrückt.
Das Filter ist nicht realisierbar, da es eine unendliche Impulsantwort hat
und das System nicht kausal ist.
Es ist aber bestens geeignet, die Theorie der Abtastung und Rekonstruktion
zu beschreiben, in fact: damit wurde das Abtasttheorem erfunden. Dies ist verglichen
mit anderen Tools aus SigSys noch gar nicht so lange her. Die potentielle
Rekonstruktion mit der Sinc-Funktion datiert auf 1910er Jahre (1915 Whittaker),
die Abtastung und fehlerfreie Rekonstruktion auf die 1930er (1933 Kotelnikov).
Ab 1948 ist es auch in der westlichen Literatur durch 'Neuerfindung' von Shannon
flächendeckend bekannt geworden und dann als Shannon'sches Abtasttheorem in die
Technikhistorie eingegangen.
\end{Ansatz}
\begin{ExCalc}
Wir müssen nun 'einfach' dem Signaflussgraphen des idealen Abtast-Rekonstruktionsmodells
folgen und nach und nach alle Signale und deren Spektren zusammentragen und dabei
verstehen, was im Detail passiert.

\textbf{Abtastung}:
Die Abtastung in Formeln aufgeschrieben lautet für den Zeitbereich
\begin{equation}
x_\mathrm{s}(t) = \sin(3 t) \cdot \frac{2}{\pi} {\Sha}(\frac{2 t}{\pi}) =
\sin(3 t) \cdot \sum_{m=-\infty}^{+\infty} \delta(t-m \frac{\pi}{2})=
\sum_{m=-\infty}^{+\infty} \sin(3 m \frac{\pi}{2}) \cdot \delta(t-m \frac{\pi}{2}),
\end{equation}
letzteres unter Ausnutzung der Multiplikationseigenschaft des Dirac Impulses.

In \fig{fig:TimeSignals_EF235EE3D8} ist das der mit $\sin(3 m \frac{\pi}{2})$
gewichtete  Dirac Impuls Kamm in schwarz, der Abstand der Dirac Impulse ist jeweils
$T_\mathrm{s}=\nicefrac{\pi}{2}$ s,
die Gewichte können durch das Sinusargument nur $0$ oder $\pm 1$ sein.
Machen wir uns hier klar: Diese Dirac Impulse enger zusammenschieben und daher
den Sinus noch genauer über noch mehr unterschiedliche Gewichte erfassen, erfordert
Abtastintervall $T_\mathrm{s}$ verringern, also (Kreis)-Abtastfrequenz $\omega_\mathrm{s}$
erhöhen.

Im Frequenzbereich korrespondiert dieses abgetastete Signal mit der Faltung der Spektren
\begin{equation}
X_\mathrm{s}(\im\omega) = \frac{1}{2\pi}
\left[
\mathrm{j} \pi \left( \delta(\omega+3) - \delta(\omega-3) \right)
\ast_\omega 4 \sum_{\nu=-\infty}^{+\infty} \delta(\omega-4 \nu)
\right].
\end{equation}
%
Hier im gewählten Beispiel haben wir es wieder einmal mit der Faltung zweier
Dirac Impulse zu tun. Es hilft uns nun wieder die Beziehung (vgl. Glg. (4.63))
\begin{align}
\delta(\omega-\omega_1) \ast_\omega \delta(\omega-\omega_2)=
\delta(\omega-[\omega_1+\omega_2]).
\end{align}
Nehmen wir das einmal in aller Ausführlichkeit auseinander, wir müssen es einmal
gesehen haben, später können wir uns das anhand von Skizzen veranschaulichen.
Zunächst erst einmal aufteilen und die Vorfaktoren ein wenig vereinfachen
%
% \begin{equation}
% X_\mathrm{s}(\im\omega) = \frac{4\pi\im}{2\pi}
% \left[
% \delta(\omega+3)
% \ast_\omega \sum_{\nu=-\infty}^{+\infty} \delta(\omega-4 \nu)
% \right]-
% \frac{4\pi\im}{2\pi}
% \left[
% \delta(\omega-3)
% \ast_\omega \sum_{\nu=-\infty}^{+\infty} \delta(\omega-4 \nu)
% \right].
% \end{equation}
%
\begin{equation}
X_\mathrm{s}(\im\omega) = 2\im
\delta(\omega+3)
\ast_\omega \sum_{\nu=-\infty}^{+\infty} \delta(\omega-4 \nu)
\quad-
2\im
\delta(\omega-3)
\ast_\omega \sum_{\nu=-\infty}^{+\infty} \delta(\omega-4 \nu).
\end{equation}
Danach, damit wir es schneller sehen, umschreiben mit Vorzeichen
\begin{equation}
X_\mathrm{s}(\im\omega) = 2\im
\delta(\omega-(-3))
\ast_\omega \sum_{\nu=-\infty}^{+\infty} \delta(\omega-4 \nu)
\quad-
2\im
\delta(\omega-(+3))
\ast_\omega \sum_{\nu=-\infty}^{+\infty} \delta(\omega-4 \nu).
\end{equation}
Jetzt können wir die Faltung zweier Dirac Impulse für jedes einzelne $\nu$
der Summe durchspielen
\begin{align}
\delta(\omega-(-3)) \ast_\omega \delta(\omega-4 \nu) = \delta(\omega - [(-3)+4\nu])\\
\delta(\omega-(+3)) \ast_\omega \delta(\omega-4 \nu) = \delta(\omega - [(+3)+4\nu])
\end{align}
und können irgendwann einsehen, dass wir für die Berücksichtigung aller $\nu$
wieder Summen einführen können in der Form
\begin{equation}
X_\mathrm{s}(\im\omega) = 2\im
\sum_{\nu=-\infty}^{+\infty} \delta(\omega - [(-3)+4\nu])
\quad-
2\im
\sum_{\nu=-\infty}^{+\infty} \delta(\omega - [(+3)+4\nu]).
\end{equation}
Die erste Summe ist ein Dirac Impulskamm mit positiven Gewichten $2\im$, die
zweite ein Dirac Impulskamm mit negativen Gewichten $-2\im$. Der Abstand zwischen
den Dirac Impulsen beträgt $4$ rad/s, wobei wir hier die Einheit der
Übersichtlichkeit nicht mitschreiben.
%
Wir können uns das nochmal anders sortieren bzgl. der Variation mit $\nu$,
nämlich in Linksverschiebung eines Diracs $\delta(\omega)$
(die beiden ersten Terme) und in Rechtsverschiebung
(die beiden letzten Terme) auftrennen, also
\begin{align}
X_\mathrm{s}(\im\omega) =
&+2\im\sum_{\nu=-\infty}^{0} \delta(\omega - [4\nu-3])
-2\im\sum_{\nu=-\infty}^{-1} \delta(\omega - [4\nu+3])\\
&+2\im\sum_{\nu=1}^{+\infty} \delta(\omega - [4\nu-3])
-2\im\sum_{\nu=0}^{+\infty} \delta(\omega - [4\nu+3]).
\end{align}
Zu Erinnerung: die Zahl $4$ ist unsere Abtast-Kreisfrequenz und die Zahl $3$
die Kreisfrequenz des Sinus, also die gegebenen Parameter aus der Aufgabenstellung.

Damit können wir uns nun klarmachen, wie
\fig{fig:Sampling_03_DiscreteSine_EF235EE3D8} entsteht. Wir haben das Gesamtspektrum
in 4 Dirac Impuls Kämme zerlegt, die immer mit dem gleichen Frequenzabstand
(der Abtast-Kreisfrequenz agieren, das ist ja der Sinn der Sache) und wegen
des abgetasteten Sinussignals einen Offset von $\pm 3$ rad/s und $\pm 2\im$ Gewicht
aufweisen.
Wenn wir das in Skizzen später aufmalen, müssen wir 'nur' das Eingangsspektrum
sukzessive um Vielfache der Abtast-Kreisfrequenz verschieben und für die Amplitude
den bei der Faltung entstehenden Faktor $\frac{1}{2\pi}$ nicht vergessen, vgl.
Vorlesungsfolie 9-5.
\end{ExCalc}
\begin{Loesung}
\textbf{Rekonstruktion}:
Die Rekonstruktion ist im \textbf{Frequenzbereich} vergleichsweise einfach einzusehen,
da wir die Spektren $X_\mathrm{s}(\im\omega)$ und $H_\mathrm{r}(\im\omega)$
multiplizieren, was anschaulich gelingt, siehe
\fig{fig:Sampling_06_DiscreteSineLowpassSpectrum_EF235EE3D8}.
In Formeln ist das ein wenig umständlicher, aber im Vergleich zum Zeitbereich immer
noch überschaubar. Wir tragen zusammen
\begin{align}
&X_\mathrm{r}(\im\omega) =
H_\mathrm{r}(\mathrm{j}\omega) \cdot X_\mathrm{s}(\im\omega) =\\
&2\im
\frac{\pi}{2}\mathrm{rect}(\frac{\omega}{4}) \cdot \sum_{\nu=-\infty}^{+\infty} \delta(\omega - [(-3)+4\nu])
\quad-
2\im
\frac{\pi}{2}\mathrm{rect}(\frac{\omega}{4}) \cdot \sum_{\nu=-\infty}^{+\infty} \delta(\omega - [(+3)+4\nu]).
\end{align}
%
Jetzt können wir wieder einzelne $\nu$ anschauen, also überlegen, für welche $\nu$
der Ausdruck
\begin{equation}
\pm 2\im \frac{\pi}{2}\mathrm{rect}(\frac{\omega}{4}) \cdot \delta(\omega - [(\mp 3)+4\nu])
\end{equation}
nicht Null ist. Das Tiefpassfilter unterdrückt alle Frequenzen $|(\mp 3)+4\nu|>2$,
und weil $\nu\in\mathbb{Z}$ bleiben nur die beiden Frequenzanteile bei $\nu=\pm 1$,
die innerhalb des Durchlassbereichs des Rekonstruktionsfilters liegen
und daher eine Rolle im Spektrum spielen. Es verbleiben also die Summen-Anteile
\begin{equation}
\pm \im \pi  \delta(\omega - [(\mp 3)+4 \cdot (\pm 1)]) \rightarrow
+ \im \pi  \delta(\omega - [-3+4]) - \im \pi  \delta(\omega - [3-4])=
\im \pi  \delta(\omega - 1) - \im \pi  \delta(\omega + 1),
\end{equation}
und somit das rekonstruierte Spektrum (rein imaginär, punktsymmetrisch)
\begin{align}
X_\mathrm{r}(\im\omega) = \im \pi  \delta(\omega - 1) - \im \pi  \delta(\omega + 1),
\end{align}
welches in \fig{fig:Sampling_07_ReconstructedSine_EF235EE3D8} dargestellt ist.
Wir finden das korrespondierende rekonstruierte Zeitsignal ohne viel Mühe, weil
es eine gut bekannte Korrespondenz (nur mit mit invertierter Polarität, vgl.
Skalierungseigenschaft LTI System!) ist, also
\begin{equation}
x_r(t) = -\quad\sin(1\cdot t) \quad\fourier\quad X_r(\mathrm{j} \omega) =
 -\quad\mathrm{j} \pi [\delta(\omega+1) - \delta(\omega-1)].
\end{equation}
In \fig{fig:TimeSignals_EF235EE3D8} ist es das orangfarbene Sinussignal.
Aus $x(t)=\sin(3\,t)$ ist nach dieser Abtastung und Rekonstruktion mit idealem
Tiefpassfilter das Signal $x_r(t) = -\sin(1\cdot t)$ geworden. Falls wir uns nicht verrechnet
haben (sollten wir nicht, es könnten nur irgendwo unbeabsichtigte Typos am Start sein),
müssen wir also konstatieren, dass die Rekonstruktion nicht fehlerfrei gelingt,
weil offensichtlich $x(t) \neq x_r(t)$.

Im \textbf{Zeitbereich} ist die Rechnerei ein wenig komplizierter (es ist aber
nichts Neues, sondern Anwendung bekannter SigSys Werkzeuge), die Interpretation
ist deutlich komplizierter.
Machen wir zunächst den Ansatz gemäß Signalflussgraph
\begin{align}
&x_\mathrm{s}(t) =
\sum_{m=-\infty}^{+\infty} \sin(3 m \frac{\pi}{2}) \cdot \delta(t-m \frac{\pi}{2})\\
&h_\mathrm{r}(t) = \mathrm{sinc}(2 t)\\
&x_\mathrm{r}(t) = h_\mathrm{r}(t) \ast_t x_\mathrm{s}(t)
\end{align}
Wir erinnern uns, dass wir die Faltung eigentlich umgehen wollen, indem
wir die Multiplikation/Faltung-Dualität verwenden (haben wir im Frequenzbereich
ja gerade gemacht), hier aber jetzt didaktisch explizit gewollt.
Also schreiben wir das Faltungsintegral tatsächlich hin (zeitliche Spiegelung beim sinc)
\begin{align}
x_\mathrm{r}(t) =&
\mathrm{sinc}(2 t)
\ast_t
\sum_{m=-\infty}^{+\infty} \sin(3 m \frac{\pi}{2}) \cdot \delta(t-m \frac{\pi}{2})\\
=&
\int\limits_{-\infty}^{\infty}
\sum_{m=-\infty}^{+\infty} \sin(3 m \frac{\pi}{2}) \cdot \delta(\tau-m \frac{\pi}{2})
\cdot \mathrm{sinc}(2 [-\tau + t]) \fsd \tau\\
=&
\sum_{m=-\infty}^{+\infty} \sin(3 m \frac{\pi}{2}) \cdot
\int\limits_{-\infty}^{\infty} \delta(\tau-m \frac{\pi}{2})
\cdot \mathrm{sinc}(2 [-\tau + t]) \fsd \tau\\
=&
\sum_{m=-\infty}^{+\infty} \sin(3 m \frac{\pi}{2}) \cdot \mathrm{sinc}(2 [-m \frac{\pi}{2} + t]),
\label{eq:EF235EE3D8_SincSpecialResult}
\end{align}
wobei letzteres der Austasteigenschaft des Diracs zu verdanken ist.
Das Faltungsintegral selber war also gar nicht so schlimm.
%
Wir erinnern uns, dass wir die Parameter Abtastintervall, $T_\mathrm{s}=\frac{\pi}{2}$ s,
Abtast-Kreisfrequenz $\omega_\mathrm{s}=4$  rad/s, Grenzfrequenz ideales
Tiefpassfilter $\omega_\mathrm{c} = 2$ rad/s und Sinusfrequenz $\omega_0=3$ rad/s
speziell gewählt hatten.
\end{Loesung}
%
%

\begin{mdframed}
Jetzt steht als letztes Ergebnis eine Summendarstellung, die allgemeingültig
\begin{align}
x_\mathrm{r}(t)
= \sum_{m=-\infty}^{+\infty} x(m T_\mathrm{s}) \cdot \mathrm{sinc}(\omega_\mathrm{c} [-m T_\mathrm{s} + t]),
\end{align}
lautet.
Nehmen wir nun für die Grenzfrequenz des idealen Tiefpassfilters
\begin{align}
\textbf{1.}:\quad\omega_\mathrm{c} = \frac{\omega_\mathrm{s}}{2}
\end{align}
an, dann lässt sich mit dem Zusammenhang
$\omega_\mathrm{s} = \frac{2\pi}{T_\mathrm{s}}$
\begin{align}
\label{eq:EF235EE3D8:ZeitSincInterpolation}
x_\mathrm{r}(t)=
\sum_{m=-\infty}^{+\infty} x(m T_\mathrm{s}) \cdot \mathrm{sinc}(\frac{\omega_\mathrm{s}}{2} [-m T_\mathrm{s} + t])=
\sum_{m=-\infty}^{+\infty} x(m T_\mathrm{s}) \cdot \mathrm{sinc}\left(\pi \cdot \frac{t-m T_\mathrm{s}}{T_\mathrm{s}}\right)
\end{align}
schreiben. Diese Formel gilt zunächst immer noch allgemein, 'nur' jetzt mit der
fixen Verknüpfung der Grenzfrequenz des idealen Tiefpasses mit der \textbf{halben Abtastfrequenz}.
Nehmen wir nun weiter an, dass das abzutastende Signal $x(t)$ nur Frequenzen
\begin{align}
\textbf{2.}:\quad<\omega_\mathrm{c}\quad\text{also}\quad<\frac{\omega_\mathrm{s}}{2}
\end{align}
enthält, dann (und nur dann, also bei Einhaltung von 1. und 2.) gilt
\begin{align}
x_\mathrm{r}(t) \equiv x(t).
\end{align}
Der mathematisch saubere Beweis dieser \textbf{perfekten Rekonstruktion}
mittels der Summenformel (sogenannte \textbf{Sinc-Interpolation}, 1915, Whittaker)
unter den beiden Bedingungen \textbf{1./2.} (1933, Kotelnikov) bilden die theoretische
Grundlage des \textbf{Abtasttheorem}s für tiefpassbegrenzte Signale.
%

Hinweis: in anderer Literatur ist $\mathrm{sinc}(x)=\frac{\sin(\pi x)}{\pi x}$ definiert,
dann schreiben wir den Interpolator in der Form
$\mathrm{sinc}\left(\frac{t-m T_\mathrm{s}}{T_\mathrm{s}}\right)$.
\end{mdframed}


\begin{Loesung}
Wir sehen relativ schnell ein, dass wir in der gestellten Aufgabe Bedingung 1.
erfüllen, aber nicht Bedingung 2., daher müssen wir erwarten, dass die perfekte
Rekonstruktion $x_\mathrm{r}(t) \equiv x(t)$ nicht gelingt,
was wir ja auch schon wissen.
%
Anders als im Frequenzbereich, werden wir unserer Summendarstellung
\eq{eq:EF235EE3D8_SincSpecialResult} im Zeitbereich das analytische Ergebnis
$x_\mathrm{r}(t)=-\sin(t)$ nicht so einfach analytisch entlocken können.
Das wollen wir uns hier auch nicht zur Aufgabe machen, weil wir ja elegantere
SigSys Tools haben, die uns das einfacher zeigen.
%

Sehr viel wichtiger müssen wir uns klar machen, was diese Summierung über
verschobene, gewichtetet Spaltfunktionen macht, das numerische Auswerten
überlassen wir dem Computer. Dazu mag die
\fig{fig:SincInterpolation_Aliasing_EF235EE3D8}
und
\fig{fig:SincInterpolation_NoAliasing_EF235EE3D8}
helfen.


\fig{fig:SincInterpolation_Aliasing_EF235EE3D8} zeigt exakt den Fall
\eq{eq:EF235EE3D8_SincSpecialResult}.
%
Für \fig{fig:SincInterpolation_NoAliasing_EF235EE3D8} wurde die Abtastfrequenz
auf $\omega_\mathrm{s}=8$ rad/s und gemäß Bedingung 1. die Grenzfrequenz
auf $\omega_\mathrm{c}=4$ rad/s erhöht. Wir sehen, dass wir nun auch Bedingung
2., also $\omega_0 < \frac{\omega_\mathrm{s}}{2}$ einhalten und damit
$x_\mathrm{r}(t) \equiv x(t)$ gilt, also fehlerfreie Abtastung und Rekonstruktion.

Wir müssen zu einer wichtigen Erkenntnis erlangen, um die Sinc-Interpolation
vom Wesen zu verstehen.
Es kommen zeitlich verschobene Sinc-Funktionen vor,
also $\mathrm{sinc}\left(\pi \cdot \frac{t-m T_\mathrm{s}}{T_\mathrm{s}}\right)$,
deren absolutes Maximum jeweils exakt bei $m T_\mathrm{s}$ liegt. Das ist
genau an der Stelle des $m$-ten Abtastwerts, also wo das Gewicht
$x(m T_\mathrm{s})$ mittels des Dirac Impuls Kamms ausgetastet wurde.
Die Nullstellen der Sinc-Funktionen liegen
nun durch 'geschickte' zeitliche Skalierung genau in allen anderen
$m T_\mathrm{s}$. D.h.
eine einzige Sinc-Funktion berücksichtigt nur einen einzigen Abtastwert.
Die Überlagerung aller Sinc-Funktionen (was wir schwer per Auge überblicken können)
liefert dann die rekonstruierte Funktion.

In \fig{fig:SincInterpolation_Aliasing_EF235EE3D8} sind die gewichteten Sinc-Funktionen
beispielhaft
für $m=1,2,3,4,5$ bunt dargestellt. Die Gewichte (also die Abtastwerte) für $m=2,4$
sind Null, wegen $\sin(3 m \frac{\pi}{2})$, daher ist auch die Sinc Funktion für diese
$m$ Null. Für $m=1$ resultiert die grüne Sinc-Funktion mit Gewicht -1, für $m=3$
die lila Kurve mit Gewicht 1, und magenta für $m=5$ mit Gewicht -1.

Viele weitere (eine endliche Zahl Sinc-Funktionen) sind in in grauen dünnen Linien
mit eingemalt. Die Überlagerung liefert die Sinc-Interpolation als rekonstruiertes
Signal, im Computer wurde $-200\leq m\leq 200$ berücksichtigt,
was ausreichend hoch gewählt ist,
dass das simulierte Ergebnis auch mit dem analytischen Ergebnis übereinstimmt.

\end{Loesung}










\begin{figure*}[h!]
\centering
\begin{subfigure}{0.49\textwidth}
\includegraphics[width=\textwidth]{../sampling/Sampling_02_Sine_EF235EE3D8.pdf}
\caption{Eingang $X(\im\omega)$.}
\label{fig:Sampling_02_Sine_EF235EE3D8}
\end{subfigure}
\begin{subfigure}{0.49\textwidth}
\includegraphics[width=\textwidth]{../sampling/Sampling_01_DiracComb_EF235EE3D8.pdf}
\caption{Dirac Impuls Kamm $S(\im\omega)$.}
\label{fig:Sampling_01_DiracComb_EF235EE3D8}
\end{subfigure}
\begin{subfigure}{0.49\textwidth}
\includegraphics[width=\textwidth]{../sampling/Sampling_03_DiscreteSine_EF235EE3D8.pdf}
\caption{Abtastversion $X_\mathrm{s}(\im\omega)$.}
\label{fig:Sampling_03_DiscreteSine_EF235EE3D8}
\end{subfigure}
\begin{subfigure}{0.49\textwidth}
\includegraphics[width=\textwidth]{../sampling/Sampling_04_LowpassSpectrum_EF235EE3D8.pdf}
\caption{Rekonstruktionsfilter Übertragungsfunktion $H_\mathrm{r}(\im\omega)$.}
\label{fig:Sampling_04_LowpassSpectrum_EF235EE3D8}
\end{subfigure}
\begin{subfigure}{0.49\textwidth}
\includegraphics[width=\textwidth]{../sampling/Sampling_06_DiscreteSineLowpassSpectrum_EF235EE3D8.pdf}
\caption{
\fig{fig:Sampling_03_DiscreteSine_EF235EE3D8}
und
\fig{fig:Sampling_04_LowpassSpectrum_EF235EE3D8}
zusammen.
}
\label{fig:Sampling_06_DiscreteSineLowpassSpectrum_EF235EE3D8}
\end{subfigure}
\begin{subfigure}{0.49\textwidth}
\includegraphics[width=\textwidth]{../sampling/Sampling_07_ReconstructedSine_EF235EE3D8.pdf}
\caption{Rekonstruierter Ausgang $X_\mathrm{r}(\im\omega)$.}
\label{fig:Sampling_07_ReconstructedSine_EF235EE3D8}
\end{subfigure}
\caption{Aufgabe \ref{sec:EF235EE3D8} Frequenzbereich. \texttt{IdealSamplingReconstruction\_EF235EE3D8.ipynb}}
\label{fig:EF235EE3D8_FrequencyDomain}
\end{figure*}






\begin{figure*}[h!]
\centering
\begin{subfigure}{0.75\textwidth}
\includegraphics[width=\textwidth]{../sampling/Sampling_05_LowpassIR_EF235EE3D8.pdf}
\caption{Rekonstruktionsfilter Impulsantwort $h_\mathrm{r}(t)$}
\label{fig:Sampling_05_LowpassIR_EF235EE3D8}
\end{subfigure}

\begin{subfigure}{0.75\textwidth}
\includegraphics[width=\textwidth]{../sampling/TimeSignals_EF235EE3D8.pdf}
\caption{blau: Eingang $x(t)$, rot: Dirac Impuls Kamm $s(t)$,
schwarz: Abtastversion $x_\mathrm{s}(t)$, orange: rekonstruierter Ausgang $x_\mathrm{r}(t)$}
\label{fig:TimeSignals_EF235EE3D8}
\end{subfigure}
\caption{Aufgabe \ref{sec:EF235EE3D8} Zeitbereich. \texttt{IdealSamplingReconstruction\_EF235EE3D8.ipynb}}
\label{fig:EF235EE3D8_TimeDomain}
\end{figure*}





\begin{figure*}[h!]
\centering
\begin{subfigure}{0.75\textwidth}
\includegraphics[width=\textwidth]{../sampling/SincInterpolation_Aliasing_EF235EE3D8.pdf}
\caption{Abtastung im Zeitbereich und \textbf{nicht fehlerfreie Rekonstruktion}
durch Unterabtastung (Bedingung 2. verletzt).}
\label{fig:SincInterpolation_Aliasing_EF235EE3D8}
\end{subfigure}

\begin{subfigure}{0.75\textwidth}
\includegraphics[width=\textwidth]{../sampling/SincInterpolation_NoAliasing_EF235EE3D8.pdf}
\caption{Abtastung im Zeitbereich und \textbf{fehlerfreie Rekonstruktion},
Bedingung 1. und 2. eingehalten.}
\label{fig:SincInterpolation_NoAliasing_EF235EE3D8}
\end{subfigure}
\caption{Aufgabe \ref{sec:EF235EE3D8} Zeitbereich.
Darstellung der Sinc-Interpolation. \texttt{IdealSamplingReconstruction\_EF235EE3D8.ipynb}}
\label{fig:SincInterpolation_EF235EE3D8}
\end{figure*}






\clearpage
\subsection*{Vorbetrachtung: Zusammenhang zwischen Fourier Reihe und Fourier
Transformation,
oder:
Abtastung \& Rekonstruktion eines Fourier-Transformation-Spektrums}
%
Betrachten wir die komplexe Fourierreihe für die Periodendauer
$T_s$ und die Grundkreisfrequenz $\omega_s=\frac{2\pi}{T_s}$.
Dann ist die Signalsynthese für ein $T_s$-periodisches Signal mittels Fourierreihe
gegeben %, vgl. Glg.~(1.2)
\begin{align}
  \tilde{x}(t) = \frac{1}{T_s}\sum_{\nu=-\infty}^{+\infty} X[\nu\,\omega_s]
  \e^{+\im\,(\omega_s \nu)\cdot t}.
\end{align}
Wir bezeichnen hier die Fourierkoeffizienten mit der Schreibweise
$X[\nu\,\omega_s]$,
dann sind wir mit dem Großbuchstaben $X$ besser in unserer SigSys-Welt unterwegs und mit
dem Term $\nu\,\omega_s$ können wir sofort sehen,
welche tatsächliche Kreisfrequenz $\omega$ welcher Harmonischen $\nu$ zuzuordnen ist.
Die eckigen Klammern sollen andeuten, dass
es abzählbare $\nu$ gibt, also dass die 'Funktion' $X[\nu\omega_s]$
als Zahlenfolge von Fourierkoeffizienten aufzufassen ist.
Wir hatten das bei der Fourierreihe
als Linienspektrum bezeichnet.
Diese Schreibweise werden wir für das Kapitel zeitdiskrete
Signale- und Systeme oft benutzen.
%
Nehmen wir ein weiteres Signal
\begin{align}
  x(t) =
  \begin{cases}
  \tilde{x}(t)&\text{für}\quad-\frac{T_s}{2} \leq t < \frac{T_s}{2}\\
  0&\text{sonst}
  \end{cases}
\end{align}
an, welches mit dem periodischen Signal $\tilde{x}(t)$
in einer einzelnen Periode um $t=0$ herum übereinstimmt
und außerhalb dieses Zeitbereichs Null ist, also ein einmaliger Vorgang.
Wenn wir weiter annehmen, dass die Amplitude in dieser Periode beschränkt ist,
können wir die Fouriertransformierte
\begin{align}
  X(\im\omega) = \int\limits_{-\frac{T_s}{2}}^{+\frac{T_s}{2}} x(t) \e^{-\im\omega t} \fsd t
\end{align}
ansetzen.
Nun können wir für $x(t)$ die Syntheseformel der komplexen Fourierreihe einsetzen,
also
\begin{align}
X(\im\omega) = \int\limits_{-\frac{T_s}{2}}^{+\frac{T_s}{2}}
\left(\frac{1}{T_s}\sum_{\nu=-\infty}^{+\infty} X[\nu\,\omega_s] \e^{\im\,(\omega_s \nu)\cdot t}\right)
\e^{-\im\omega t} \fsd t.
\end{align}
Das lässt sich umstellen und ausrechnen zu
\begin{align}
&X(\im\omega) = \frac{1}{T_s}\sum_{\nu=-\infty}^{+\infty} X[\nu\,\omega_s]
\int\limits_{-\frac{T_s}{2}}^{+\frac{T_s}{2}}
\e^{-\im (\omega-\nu\omega_s) t} \fsd t=
\frac{1}{T_s}\sum_{\nu=-\infty}^{+\infty} X[\nu\,\omega_s]
\frac{\e^{-\im (\omega-\nu\omega_s) t}}{-\im (\omega-\nu\omega_s)}
\bigg|_{-\frac{T_s}{2}}^{+\frac{T_s}{2}}\\
%\end{align}
%Grenzen einsetzen und wie üblich (siehe Übung 1) vereinfachen
%\begin{align}
&X(\im\omega) = \sum_{\nu=-\infty}^{+\infty} X[\nu\,\omega_s]\left(
-\frac{\e^{-\im (\omega-\nu\omega_s)\frac{T_s}{2}}}{2 \im (\omega-\nu\omega_s) \frac{T_s}{2}}+
\frac{\e^{\im (\omega-\nu\omega_s)\frac{T_s}{2}}}{2 \im (\omega-\nu\omega_s) \frac{T_s}{2}}\right)
=
\sum_{\nu=-\infty}^{+\infty} X[\nu\,\omega_s] \cdot
\mathrm{sinc}\left((\omega-\nu\omega_s)\frac{T_s}{2}\right).
\end{align}
Wenn wir mit $T_s=\frac{2\pi}{\omega_s}$ den sinc noch umschreiben
\begin{align}
\label{eq:SamplingFreqSincInterp}
X(\im\omega) = \sum_{\nu=-\infty}^{+\infty} X[\nu\,\omega_s] \cdot
\mathrm{sinc}\left(\pi\cdot\frac{\omega-\nu\omega_s}{\omega_s}\right),
\end{align}
dann erkennen wir eine \textbf{verblüffende Ähnlichkeit mit der Sinc-Interpolation
im Zeitbereich} \eq{eq:EF235EE3D8:ZeitSincInterpolation}.
%
Wir können mutmaßen (es ist tatsächlich so), dass wir es hier mit einem
Abtast- und Rekonstruktionsproblem zu tun haben und gerade die Rekonstruktionsformel
neu erfunden haben, über die sich die Fourierreihe $X[\nu\,\omega_s]$
und die Fouriertransformation $X(\im\omega)$
verknüpfen lassen: Wir tasten Spektren ab und rekonstruieren diese.

Es ist nun sinnvoll, wenn wir uns nochmal Übung 1 hervorholen, speziell
die Aufgaben 1.1 und 1.2. Die beiden Grafiken der Zeitsignale und die
Ergebnis-Formeln der Spektren sind unten abgebildet, angepasst an unsere
jetzige Notation mit $\omega_s=\frac{2\pi}{T_s}$.
%
\begin{center}
\begin{tikzpicture}[domain=0:2]
\def\T{0.4}
%
\begin{scope}[shift={(0,0)}]
\draw[->] (-3,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,0) -- (0,1.5) node[above] {$\tilde{x}(t)$};
\foreach \pos in {-2,...,2} {
\draw[-, C1, ultra thick] (\pos-\T,0) -- (\pos-\T,1) -- (\pos+\T,1) -- (\pos+\T,0) -- (\pos+1-\T,0);
};
\draw[-, C1, ultra thick] (-\T,0) node[below] {$\frac{-T_h}{2}$};
\draw[-, C1, ultra thick] (+\T,0) node[below] {$\frac{+T_h}{2}$};
\draw[-, C1, ultra thick] (1,0) node[below] {$T_s$};
\draw[-, C1, ultra thick] (2,0) node[below] {$2 T_s$};
\draw[-, C1, ultra thick] (-2-\T,1) node[left] {$A$};
\draw[-, C7, thin] (0.5,0) -- (0.5,1.1) node[above] {$\frac{T_\mathrm{s}}{2}$};
\draw[-, C7, thin] (-0.5,0) -- (-0.5,1.1) node[above] {$\frac{-T_\mathrm{s}}{2}$};
\draw[-, black, ultra thick] (3.5,-1.1) node[left]
{Glg. (1.12): $X[\nu\,\omega_s] = A T_h \cdot \mathrm{sinc}(\omega_s \nu \frac{T_h}{2})$}; %hard coded ref!!!
\end{scope}
%
\begin{scope}[shift={(8,0)}]
\draw[->] (-3,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,0) -- (0,1.5) node[above] {${x}(t)$};
\foreach \pos in {-0,...,0} {
\draw[-, C0, ultra thick] (\pos-\T-2,0) -- (\pos-\T,0) -- (\pos-\T,1) -- (\pos+\T,1) -- (\pos+\T,0) -- (\pos+1-\T+2,0);
};
\draw[-, C0, ultra thick] (-\T,0) node[below] {$\frac{-T_h}{2}$};
\draw[-, C0, ultra thick] (+\T,0) node[below] {$\frac{+T_h}{2}$};
\draw[-, C0, ultra thick] (1,0) node[below] {$T_s$};
\draw[-, C0, ultra thick] (2,0) node[below] {$2 T_s$};
\draw[-, C0, ultra thick] (0-\T,1) node[left] {$A$};
\draw[-, C7, thin] (0.5,0) -- (0.5,1.1) node[above] {$\frac{T_\mathrm{s}}{2}$};
\draw[-, C7, thin] (-0.5,0) -- (-0.5,1.1) node[above] {$\frac{-T_\mathrm{s}}{2}$};
\draw[-, black, ultra thick] (3.5,-1.1) node[left]
{Glg. (1.22): $X(\im \omega) = A T_h \cdot \mathrm{sinc}(\omega \frac{T_h}{2})$}; %hard coded ref!!!
\end{scope}
\end{tikzpicture}
\end{center}
%
Spielen wir die Abtastung eines Spektrums nun mal mit den beiden Grafiken
in Gedanken durch (wir rechnen es gleich im Detail aus):
\begin{itemize}
  \item es gibt ein zeitlich begrenztes Signal $x(t)$ (blau)
  und dazu gehört ein nicht bandbegrenztes, kontinuierliches Spektrum
  (Fouriertransformation), wir wissen, dass es ein sinc-förmiges Spektrum ist (Abb. 1.6)
  \item dieses Spektrum wird nun abgetastet, es entsteht ein sogenanntes
  Linienspektrum, vgl. Abb. 1.1 blaue Punkte
  \item Abtastung ist Multiplikation mit Dirac Impulskamm, im anderen Bereich
  Faltung mit Dirac Impulskamm:
  hier also im Zeitbereich periodische Wiederholungen
  des zeitlich begrenzten Signals, es entsteht ein periodisches Zeitsignal
  $\tilde{x}(t)$ (orange Abb. oben, vgl. Aufgabe 1.1)
  \item periodische Zeitsignale haben ein Linienspektrum (komplexe Fourierreihe)
  \item Bei der Rekonstruktion wird mittels der oben gefundenen Sinc-Interpolation
  \eq{eq:SamplingFreqSincInterp}
  aus diesem Linienspektrum wieder ein kontinuierliches Spektrum, im besten
  Fall (d.h. perfekter Rekonstruktion) erhalten wir das originale Spektrum zurück
  \item im Zeitbereich bedeutet dies äquivalent, dass alle periodischen
  Wiederholungen weggeschnitten werden und wieder nur das zeitlich begrenzte,
  originale Signal übrig bleibt.
\end{itemize}
Die Rekonstruktion gelingt dann fehlerfrei, wenn der zeitlich begrenzte
Signalausschnitt nicht über $\pm \frac{T_s}{2}$ hinausragt, also für die Skizze
$\frac{T_h}{2}<\frac{T_s}{2}$. Dann (und nur dann)
beinhaltet das Linienspektrum der Fourierreihe \textbf{alle} Information,
um das Spektrum der Fouriertransformation
des zeitlich begrenzten Signalausschnitts beschreiben zu können. Dafür gibt es
nur einen einzig möglichen Verlauf, der mittels der Sinc-Interpolationsformel
definiert ist. Diese Erkenntnis ist verpackt im Abtasttheorem für
zeitlich begrenzte Signale um den Nullpunkt $t=0$.

Ähnlich wie in der vorhergehenden Aufgabe, kann man in der Sinc-Interpolationsformel
wieder nicht sofort sehen, dass perfekt rekonstruiert werden kann, was in dem anderen
Bereich (hier jetzt der Zeitbereich) schnell und übersichtlich offenbart wird.

\newpage
\subsection{Abtastung und Rekonstruktion eines Spektrums: Sinc}
\label{sec:45C76AFB33}
\begin{Ziel}
Mit einem einfachen Beispiel wollen wir die Abtastung/Rekonstruktion von Spektren
mal durchspielen und dabei die gewonnene Erkenntnisse aus der
Vorbetrachtung vertiefen.
Diesmal wird der Dirac Impuls Kamm im Frequenzbereich multipliziert und daraus
folgt eine Faltung mit dem Dirac Impuls Kamm im Zeitbereich.
Im Frequenzbereich wird mit dem Rekonstruktionsspektrum gefaltet, daher
im Zeitbereich mit einem Rekonstruktionszeitfenster multipliziert.
Im Frequenzbereich bekommen wir die Sinc-Interpolationsformel, der wir
mit bloßem Auge nicht ansehen, dass sie in dem gewählten Beispiel perfekt
rekonstruiert. Im Zeitbereich ist das mit einfachen Skizzen sofort ersichtlich.
\end{Ziel}
\textbf{Aufgabe} {\tiny 45C76AFB33}:
Für das dargestellte Abtast- und Rekonstruktionsmodell von Spektren
\begin{center}
\begin{tikzpicture}[align=center,node distance=0.5cm and 0.5cm]
\tikzstyle{block} = [draw, rectangle, minimum height=3em, minimum width=3em]
\begin{scope}
\node (input) {$\displaystyle x(t)$};
\node [draw, circle, right=of input, minimum size=7.5mm] (op1) {$\ast_t$};
\node [above=of op1] (sop1) {$s(t)$};
\node [draw, circle, right=of op1, minimum size=7.5mm, xshift=0.5cm] (op2) {$\cdot$};
\node [above=of op2] (sop2) {$h_\mathrm{r}(t)$};
\node [block, right=of op2] (mult) {$1$};
\node [right=of mult] (output) {$x_\mathrm{r}(t)$};
\draw [->] (input) -- (op1);
\draw [->] (op1) node[below, xshift=0.9cm, yshift=0cm] {$x_\mathrm{s}(t)$} -- (op2);
\draw [->] (op2) -- (mult);
\draw [->] (mult) -- (output);
\draw [->] (sop1) -- (op1);
\draw [->] (sop2) -- (op2);
\node [right=of output, xshift=-0.4cm, yshift=0.5cm] (fourier) {$\fourier$};
\end{scope}
%
\begin{scope}[shift={(8,0)}]
\node (input) {$\displaystyle X(\im\omega)$};
\node [draw, circle, right=of input, minimum size=7.5mm] (op1) {$\cdot$};
\node [above=of op1] (sop1) {$S(\im\omega)$};
\node [draw, circle, right=of op1, minimum size=7.5mm, xshift=0.5cm] (op2) {$\ast_\omega$};
\node [above=of op2] (sop2) {$H_\mathrm{r}(\im\omega)$};
\node [block, right=of op2] (mult) {$\frac{1}{2\pi}$};
\node [right=of mult] (output) {$X_\mathrm{r}(\im\omega)$};
\draw [->] (input) -- (op1);
\draw [->] (op1) node[below, xshift=0.9cm, yshift=0cm] {$X_\mathrm{s}(\im\omega)$} -- (op2);
\draw [->] (op2) -- (mult);
\draw [->] (mult) -- (output);
\draw [->] (sop1) -- (op1);
\draw [->] (sop2) -- (op2);
\end{scope}
\end{tikzpicture}
\end{center}
soll für
\begin{align}
X(\im\omega) = \frac{3}{2}\mathrm{sinc}(\frac{\omega}{6})\qquad
%
S(\im\omega)=\frac{1}{\omega_s}\Sha(\frac{\omega}{\omega_s})\qquad
%
h_r(t) = \frac{2\pi}{T_s}\mathrm{rect}(\frac{t}{T_s})
\end{align}
die Abtastung von $X(\im\omega)$ und die Rekonstruktion zu $X_\mathrm{r}(\im\omega)$
mit $\omega_s = 3 \pi$ berechnet und skizziert werden.

\begin{itemize}
  \item Berechnen und skizzieren Sie alle Signale, d.h. $x(t)$, $s(t)$, $x_\mathrm{s}(t)$, $h_\mathrm{r}(t)$ und $x_\mathrm{r}(t)$
  \item Berechnen und skizzieren Sie alle Spektren, d.h.  $X(\im\omega)$, $S(\im\omega)$, $X_\mathrm{s}(\im\omega)$, $H_\mathrm{r}(\im\omega)$ und $X_\mathrm{r}(\im\omega)$
  \item Ist die Rekonstruktion des Spektrums erfolgreich?
\end{itemize}

\begin{Werkzeug}
Siehe Aufgabe \ref{sec:EF235EE3D8}.
$$\omega_s = \frac{2\pi}{T_s}$$
\end{Werkzeug}
\begin{Ansatz}
Siehe Aufgabe \ref{sec:EF235EE3D8}, in Gedanken müssen wir hier Faltung und
Multiplikation drehen. Das kann am Anfang für Verwirrung sorgen, wenn wir das
aber mal durchgespielt haben, werden wir mit einem
universellen Blick auf die Dinge belohnt.
\end{Ansatz}
\begin{ExCalc}
$$T_s = \frac{2\pi}{\omega_s} = \frac{2}{3}$$
\textbf{Eingang, Signal und Spektrum}:
\begin{align}
x(t) = \frac{9}{2} \mathrm{rect}(3 t)
\quad\fourier\quad
X(\im\omega) = \frac{3}{2}\mathrm{sinc}(\frac{\omega}{6})
\end{align}
allgemeiner mit $A = \frac{9}{2}$ und $T_h=\frac{1}{3}$:
\begin{align}
x(t) = A \mathrm{rect}(\frac{t}{T_h})
\quad\fourier\quad
X(\im\omega) = A T_h\mathrm{sinc}(\frac{\omega T_h}{2})
\end{align}
%
\textbf{Abtastung, Signal und Spektrum}:
Fundament für eine sinnvolle Bearbeitung solcher Abtastaufgaben ist zunächst die
Dirac Impuls Kamm Dualität fehlerfrei niederzuschreiben
\begin{align}
\frac{1}{T_\mathrm{s}} {\Sha}(\frac{t}{T_\mathrm{s}}) \quad\fourier\quad
{\Sha}(\frac{\omega T_\mathrm{s}}{2 \pi}) =
\Sha(\frac{\omega}{\omega_\mathrm{s}})\\
\sum_{m=-\infty}^{+\infty} \delta(t-m T_\mathrm{s}) \quad\fourier\quad
\omega_s \sum_{\nu=-\infty}^{+\infty} \delta(\omega-\nu \omega_s).
\end{align}
%
Der Dirac Impuls Kamm im Frequenzbereich aus der Aufgabenstellung ist nun noch
(intentional für resultierendes Dirac Gewicht 1) gewichtet mit $\frac{1}{\omega_s}$,
was wir beidseitig einführen (Linearitätseigenschaft)
\begin{align}
s(t) = \frac{1}{\omega_s}\cdot\frac{1}{T_\mathrm{s}} {\Sha}(\frac{t}{T_\mathrm{s}}) &\quad\fourier\quad
S(\im\omega) = \frac{1}{\omega_s} {\Sha}(\frac{\omega T_\mathrm{s}}{2 \pi}) =
\frac{1}{\omega_s}\Sha(\frac{\omega}{\omega_\mathrm{s}})\\
s(t) = \frac{1}{\omega_s} \sum_{m=-\infty}^{+\infty} \delta(t-m T_\mathrm{s}) &\quad\fourier\quad
S(\im\omega) = \sum_{\nu=-\infty}^{+\infty} \delta(\omega-\nu \omega_s)
\end{align}
%
Für das \textbf{Rekonstruktionszeitfenster} können wir direkt aus der Formelsammlung
\begin{align}
h_r(t) = \frac{2\pi}{T_s}\mathrm{rect}(\frac{t}{T_s})
\quad\fourier\quad
H_r(\im\omega) = 2\pi \mathrm{sinc}(\frac{\omega T_s}{2})
\end{align}
ableiten...auch eine sehr bekannte Korrespondenz.
%
\end{ExCalc}
\begin{Loesung}
%
Die Abtastung/Rekonstruktion des Spektrums ist mit \textbf{Lösung im Zeitbereich}
vergleichsweise einfach einzusehen, vor allem mit der begleitenden Grafik unten.
Wir sehen, dass in diesem Fall perfekte Rekonstruktion möglich ist, also
$x_\mathrm{r}(t) \equiv x(t)$.

\noindent Faltung mit Dirac Impulskamm
\begin{align}
x_\mathrm{s}(t) = x(t) \ast_t s(t) = \int\limits_{-\infty}^{+\infty} x(-\tau+t) \cdot s(\tau) \fsd\tau
= \int\limits_{-\infty}^{+\infty} A \mathrm{rect}(\frac{1}{T_h}[-\tau + t]) \cdot \frac{1}{\omega_s} \sum_{m=-\infty}^{+\infty} \delta(\tau-m T_\mathrm{s}) \fsd\tau
\end{align}
Reihenfolge Integral und Summe
\begin{align}
x_\mathrm{s}(t) = \frac{A}{\omega_s} \sum_{m=-\infty}^{+\infty} \int\limits_{-\infty}^{+\infty} \mathrm{rect}(\frac{1}{T_h}[-\tau + t]) \delta(\tau-m T_\mathrm{s}) \fsd\tau
\end{align}
Austasteigenschaft Dirac
\begin{align}
x_\mathrm{s}(t)
= \frac{A}{\omega_s} \sum_{m=-\infty}^{+\infty} \mathrm{rect}(\frac{1}{T_h}[-m T_\mathrm{s} + t])
= \frac{A}{\omega_s} \sum_{m=-\infty}^{+\infty} \mathrm{rect}(\frac{1}{T_h}[t - m T_\mathrm{s}])
\end{align}
Das ergibt also um $T_s$ verschobene Rechteckpulse.

\noindent Rekonstruktion
\begin{align}
x_\mathrm{r}(t) = h_\mathrm{r}(t) \cdot x_\mathrm{s}(t) =
\left(\frac{2\pi}{T_s}\mathrm{rect}(\frac{t}{T_s})\right) \cdot
\left(\frac{A}{\omega_s} \sum_{m=-\infty}^{+\infty} \mathrm{rect}(\frac{1}{T_h}[t - m T_\mathrm{s}]))\right)
\end{align}
Falls $T_h < T_s$ bzw. $\frac{T_h}{2} < \frac{T_s}{2}$
(dies ist im Zahlenbeispiel erfüllt),
bleibt von der Summe über $m$ nur die Rechteckfunktion bei $m=0$ übrig.
Alle anderen $m$-Beiträge macht die erste Rect-Funktion zu Null.
%
Weil $\frac{2\pi}{T_s \omega_s} = \frac{2\pi}{2\pi} = 1$ verbleibt also
\begin{align}
x_\mathrm{r}(t) = A \mathrm{rect}(\frac{t}{T_h}) \equiv x(t)
\end{align}
in allgemeiner Schreibweise aber unter Berücksichtigung unseres Zahlenbeispiels.
Ohne Zahlen sieht man aber schöner, was die Variablen während der Rechnung machen.

%
\begin{center}
\begin{tikzpicture}[domain=0:2]
\def\T{0.1667}
%
\begin{scope}[shift={(0,0)}]
\draw[->] (-3,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,0) -- (0,1.5) node[above] {$x(t)$};
\foreach \pos in {-0,...,0} {
\draw[-, C0, ultra thick] (\pos-\T-2,0) -- (\pos-\T,0) -- (\pos-\T,1) -- (\pos+\T,1) -- (\pos+\T,0) -- (\pos+1-\T+2,0);
};
\draw[-, C0, ultra thick] (-\T,0) node[below] {$\frac{-1}{6}$};
\draw[-, C0, ultra thick] (+\T,0) node[below] {$\frac{1}{6}$};
\draw[-, C0, ultra thick] (0.667,0) node[below] {$\frac{2}{3}$};
\draw[-, C0, ultra thick] (2*0.667,0) node[below] {$\frac{4}{3}$};
\draw[-, C0, ultra thick] (-\T,1) node[left] {$\frac{9}{2}$};
\end{scope}
%
\begin{scope}[shift={(7,0)}]
\draw[->] (-3,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,0) -- (0,1.5) node[above] {$s(t)$};
\foreach \pos in {-2,...,2} {
\draw[->, black, ultra thick] (\pos*2/3,0) -- (\pos*2/3,1);
};
\draw[-, C0, ultra thick] (-\T,0) node[below] {$\frac{-1}{6}$};
\draw[-, C0, ultra thick] (+\T,0) node[below] {$\frac{1}{6}$};
\draw[-, black, ultra thick] (0.667,0) node[below] {$\frac{2}{3}$};
\draw[-, black, ultra thick] (1.334,0) node[below] {$\frac{4}{3}$};
\draw[-, black, ultra thick] (-2*2/3-\T,1) node[left] {$(\frac{1}{3\pi})$};
\end{scope}
%
\begin{scope}[shift={(0,-3)}]
\draw[->] (-3,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,0) -- (0,1.5) node[above] {$x_\mathrm{s}(t) = x(t)\ast_t s(t)$};
\foreach \pos in {-2,...,2} {
\draw[-, C1, ultra thick] (\pos*2/3-\T,0) -- (\pos*2/3-\T,1) -- (\pos*2/3+\T,1) -- (\pos*2/3+\T,0) -- (\pos*2/3+1*2/3-\T,0);
};
\draw[-, C1, ultra thick] (-\T,0) node[below] {$\frac{-1}{6}$};
\draw[-, C1, ultra thick] (+\T,0) node[below] {$\frac{1}{6}$};
\draw[-, C1, ultra thick] (1*2/3,0) node[below] {$\frac{2}{3}$};
\draw[-, C1, ultra thick] (2*2/3,0) node[below] {$\frac{4}{3}$};
\draw[-, C1, ultra thick] (-2*2/3-\T,1) node[left] {$\frac{9}{2} \cdot \frac{1}{3\pi}$};
\end{scope}
%
\begin{scope}[shift={(7,-3)}]
\draw[->] (-3,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,0) -- (0,1.5) node[above] {$h_\mathrm{r}(t)$};
\draw[-, C2, ultra thick] (-3,0) -- (-1/3,0) -- (-1/3,1) -- (+1/3,1) -- (+1/3,0) -- (3,0);
\draw[-, C2, ultra thick] (-1/3,0) node[below] {$\frac{-1}{3}$};
\draw[-, C2, ultra thick] (+1/3,0) node[below] {$\frac{1}{3}$};
\draw[-, C2, ultra thick] (2/3,0) node[below] {$\frac{2}{3}$};
\draw[-, C2, ultra thick] (4/3,0) node[below] {$\frac{4}{3}$};
\draw[-, C2, ultra thick] (-1/2,1) node[left] {$\frac{2\pi}{\nicefrac{2}{3}}$};
\end{scope}
%
\begin{scope}[shift={(3.5,-6)}]
\draw[->] (-3,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,0) -- (0,1.5) node[above] {$x_\mathrm{r}(t) = x_\mathrm{s}(t) \cdot h_\mathrm{r}(t)$};
\foreach \pos in {-0,...,0} {
\draw[densely dashed, C3, ultra thick] (\pos-\T-2,0) -- (\pos-\T,0) -- (\pos-\T,1) -- (\pos+\T,1) -- (\pos+\T,0) -- (\pos+1-\T+2,0);
};
\draw[-, C3, ultra thick] (-\T,0) node[below] {$\frac{-1}{6}$};
\draw[-, C3, ultra thick] (+\T,0) node[below] {$\frac{1}{6}$};
\draw[-, C3, ultra thick] (1*2/3,0) node[below] {$\frac{2}{3}$};
\draw[-, C3, ultra thick] (2*2/3,0) node[below] {$\frac{4}{3}$};
\draw[-, C3, ultra thick] (-\T,1) node[left] {$\frac{9}{2}$};
\end{scope}
%
\end{tikzpicture}
\end{center}
%
%
%

Die Abtastung eines Spektrums und dessen Rekonstruktion ist mit
\textbf{Lösung im Frequenzbereich} deutlich frickeliger.
Es ist im Grunde aber die gleiche Rechnung wie in der vorangegangenen Aufgabe.

Abtastung eines Spektrums ist Multiplikation mit Dirac Impulskamm im Frequenzbereich:
\begin{align}
X_s(\im\omega)
&= X(\im\omega) \cdot S(\im\omega)\\
&= A T_h\mathrm{sinc}(\frac{\omega T_h}{2}) \cdot \sum_{\nu=-\infty}^{+\infty} \delta(\omega-\nu \omega_s)
\end{align}
Das schreit nach Multiplikationseigenschaft beim Dirac
\begin{align}
X_s(\im\omega)
&= A T_h \sum_{\nu=-\infty}^{+\infty} \mathrm{sinc}(\frac{\omega T_h}{2}) \delta(\omega-\nu \omega_s)\\
&= A T_h \sum_{\nu=-\infty}^{+\infty} \mathrm{sinc}(\frac{\nu \omega_s T_h}{2}) \delta(\omega-\nu \omega_s)
\end{align}
und ergibt offenbar ein Linienspektrum, dargestellt als verschobene Dirac Impulse (bei Vielfachen von $\omega_s$)
und mit den Gewichten $A T_h \mathrm{sinc}(\frac{\nu \omega_s T_h}{2})$. Diese Gewichte
entsprechen den Fourierreihenkoeffizienten aus Aufgabe 1.1, siehe Glg.~(1.12).

Nun folgt die Rekonstruktion. Wir müssen wieder das Faltungsintegral explizit aufschreiben (als
Frequenzhilfsvariable $\xi$ für das Faltungsintegral, also da wo wir sonst $\tau$ nehmen)
und geschickt umformen zur Sinc-Interpolation, diesmal im Frequenzbereich.
%
Also, Ansatz
\begin{align}
X_r(\im\omega)
=& \frac{1}{2\pi} X_s(\im\omega) \ast_\omega H_r(\im\omega)\\
=& \frac{1}{2\pi} \left(A T_h \sum_{\nu=-\infty}^{+\infty} \mathrm{sinc}(\frac{\nu \omega_s T_h}{2}) \delta(\omega-\nu \omega_s)\right)
\ast_\omega \left(2\pi \mathrm{sinc}(\frac{\omega T_s}{2})\right)
\end{align}
%
Faltungsintegral im Frequenzbereich allgemein ($H_r(\omega)$ spiegeln und über
die Frequenzachse schieben scheint eleganter)
\begin{align}
X_r(\omega) = \frac{1}{2\pi}\int\limits_{\xi=-\infty}^{+\infty} X_s(\xi) \cdot H_r(-\xi + \omega) \fsd\xi
\end{align}
ausformuliert
\begin{align}
X_r(\im\omega)
=& \frac{1}{2\pi} \int\limits_{\xi=-\infty}^{+\infty}
\left(A T_h \sum_{\nu=-\infty}^{+\infty} \mathrm{sinc}(\frac{\nu \omega_s T_h}{2}) \delta(\xi-\nu \omega_s)\right)
\left(2\pi \mathrm{sinc}(\frac{(-\xi + \omega) T_s}{2})\right)
\fsd\xi
\end{align}
Die $2\pi$ kürzen sich raus, das war intentional so gewollt, damit wir amplitudengetreu rekonstruieren können.
\begin{align}
X_r(\im\omega)
=& A T_h \int\limits_{\xi=-\infty}^{+\infty}
\left(\sum_{\nu=-\infty}^{+\infty} \mathrm{sinc}(\frac{\nu \omega_s T_h}{2}) \delta(\xi-\nu \omega_s)\right)
\left(\mathrm{sinc}(\frac{(-\xi + \omega) T_s}{2})\right)
\fsd\xi
\end{align}
Reihenfolge Integral und Summe
\begin{align}
X_r(\im\omega)
=& A T_h \sum_{\nu=-\infty}^{+\infty} \mathrm{sinc}(\frac{\nu \omega_s T_h}{2})
\int\limits_{\xi=-\infty}^{+\infty}
 \delta(\xi-\nu \omega_s)
\mathrm{sinc}(\frac{(-\xi + \omega) T_s}{2})
\fsd\xi
\end{align}
Austasteigenschaft Dirac
\begin{align}
X_r(\im\omega)
=& A T_h \sum_{\nu=-\infty}^{+\infty} \mathrm{sinc}(\frac{\nu \omega_s T_h}{2})
\mathrm{sinc}(\frac{(-\nu \omega_s + \omega) T_s}{2})
\end{align}
Im Argument der zweiten Sinc-Funktion noch mit $\pi$ erweitern bringt uns
\begin{align}
X_r(\im\omega)
=& \sum_{\nu=-\infty}^{+\infty} \underbrace{A T_h \mathrm{sinc}\left(\nu \omega_s \frac{T_h}{2}\right)}_{\text{Koeff Fourier Reihe}}
\mathrm{sinc}\left(\pi \frac{\omega -\nu \omega_s}{\omega_s}\right)
\equiv A T_h \mathrm{sinc}\left(\omega \frac{T_h}{2}\right) = X(\im\omega)
\end{align}
und damit zu \eqref{eq:SamplingFreqSincInterp}. Die Gleichheit $X_r(\im\omega)
\equiv X(\im\omega)$ gilt nur, wenn $T_h < T_s$, das ist in unserem Fall erfüllt.
Der mathematisch strenge Beweis zu dieser Formel wurde erstmal von Kotelnikov 1933 geführt, der
heute als Urheber des Abtasttheorems gilt.

Koeffizienten der Fourierreihe (die das periodisierte Signal $x(t)$ beschreiben, vgl. Aufgabe 1.1, Glg.~(1.12))
werden genutzt um zwischen den Stützfrequenzen
$\mu \omega_s$ für beliebige Frequenzen $\omega$ das Spektrum zu interpolieren.
Der Interpolator ist die in der Formel hintere Sinc Funktion in der $\omega$ und
$\mu \omega_s$ als Terme im Argument auftauchen (müssen, wenn man eine Interpolation bauen will).

Wenn das Abtasttheorem für den Bereich $\omega$ eingehalten wird---wir wissen aus
vorheriger Rechnung, dass es für unser Zahlenbeispiel so ist---
kann aus den Fourreihekoeffizienten der periodisierten Zeitfunktion
das eindeutige Spektrum der Fouriertransformation vom einmaligen Rechteckimpuls $x(t)$
interpoliert (rekonstruiert werden). Genau das haben wir in der Vorbetrachtung und
jetzt am speziellen Beispiel gemacht.

Es ist wichtig sich klarzumachen, dass die Interpolationsformel immer gilt,
der Sinc Interpolator weiss ja nichts davon, dass/ob ein Abtasttheorem eingehalten wird.
Die Information korrekter Abtastung kann also nur in den Fourierreihenkoeffizienten stecken.

Wir sehen der Sinc-Interpolationsformel die perfekte Rekonstruktion wieder nicht an,
in der mit Computer errechneten Grafik \fig{fig:SpectrumSampling_Th_Ts1_2_45C76AFB33},
können wir das gut herauslesen, auch wenn dort nur über endliche Anzahl der
wichtigsten $\nu$ summiert wurde.

In grau sind die einzelnen $\mathrm{sinc}(\pi\cdot\frac{\omega-\nu 3 \pi}{3\pi})$
gewichtet mit ihrem zugehörigen Abtastwert dagestellt.
Diese Sinc-Funktionen haben jeweils ihr absolutes Maximum bei $\nu 3 \pi$ (durch
Verschiebung entlang der Frequenzachse). Durch ihre spezielle Frequenzskalierung
besitzen sie Nullstellen für alle anderen $\nu$. Deswegen
berücksichtigt $\mathrm{sinc}(\pi\cdot\frac{\omega-\nu 3 \pi}{3\pi})$
exakt nur den Abtastwert bei $\nu 3 \pi$. Das ist die Grundidee der Rekonstruktion
mit unendlich langer Sinc-Funktion. Die Überlagerung (dessen Ergebnis wir eben nur schwer
in der Summen-Formel sehen, früher wurde mühsam mit tabelliertem Sinc per Hand summiert)
aller Sinc-Funktionen liefert dann die kontinuierliche Funktion,
hier das Spektrum der Fourier Transformation.



%
In \fig{fig:SpectrumSampling_Th_TsXX45C76AFB33} sind zwei weitere Beispiele
dargestellt, für die $T_h$ variiert wurde.
In \fig{fig:SpectrumSampling_Th_Ts4_3_45C76AFB33} sehen wir den Fall der
Unterabtastung des Spektrums, im Zeitbereich überlappen sich jetzt die
Rechteckimpulse (das malen wir uns am besten in Ruhe mal auf).
Genau deswegen, kann keine fehlerfreie Rekonstruktion gelingen. Die Sinc-Interpolation
interpoliert zwar fleißig (sie weiß ja nichts von einer Unterabtastung), aber aufgrund
der zur Verfügung stehenden (zu wenigen) Abtastwerte eben nicht zum originalen Spektrum.
\end{Loesung}


\begin{figure}
\centering
\includegraphics[width=0.75\textwidth]{../sampling/SpectrumSampling_Th_Ts1_2_45C76AFB33.pdf}
\caption{Aufgabe \ref{sec:45C76AFB33}. Frequenzbereich. \texttt{IdealSamplingReconstruction\_45C76AFB33.ipynb}}
\label{fig:SpectrumSampling_Th_Ts1_2_45C76AFB33}
\end{figure}



\begin{figure*}[h]
\centering
\begin{subfigure}{0.75\textwidth}
\includegraphics[width=\textwidth]{../sampling/SpectrumSampling_Th_Ts3_4_45C76AFB33.pdf}
\caption{Rekonstruktion perfekt, weil $\frac{T_h}{2}<\frac{T_s}{2}$.}
\label{fig:SpectrumSampling_Th_Ts3_4_45C76AFB33}
\end{subfigure}

\begin{subfigure}{0.75\textwidth}
\includegraphics[width=\textwidth]{../sampling/SpectrumSampling_Th_Ts4_3_45C76AFB33.pdf}
\caption{Rekonstruktion (gestrichelt) nicht perfekt, Unterabtastung, weil $\frac{T_h}{2}>\frac{T_s}{2}$.}
\label{fig:SpectrumSampling_Th_Ts4_3_45C76AFB33}
\end{subfigure}
% \begin{subfigure}{0.49\textwidth}
% \includegraphics[width=\textwidth]{../sampling/SpectrumSampling_Th_Ts1_1_45C76AFB33.pdf}
% \caption{Kritische Abtastung, d.h. $\frac{T_h}{2}=\frac{T_s}{2}$ erzeugt ein
% Gleichanteil im Zeitbereich, wo nur ein Fourierkoeffizient $\mu=0$ zur Beschreibung
% nötig ist.}
% \label{fig:SpectrumSampling_Th_Ts1_1_45C76AFB33}
% \end{subfigure}
\caption{Spektrenabtastung- und rekonstruktion. \texttt{IdealSamplingReconstruction\_45C76AFB33.ipynb}}
\label{fig:SpectrumSampling_Th_TsXX45C76AFB33}
\end{figure*}
